var T=Object.defineProperty,P=Object.defineProperties;var q=Object.getOwnPropertyDescriptors;var N=Object.getOwnPropertySymbols;var F=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable;var w=(c,s,a)=>s in c?T(c,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):c[s]=a,n=(c,s)=>{for(var a in s||(s={}))F.call(s,a)&&w(c,a,s[a]);if(N)for(var a of N(s))S.call(s,a)&&w(c,a,s[a]);return c},d=(c,s)=>P(c,q(s));import{P as C,u as k,j as e,R as A,o as E,l as L,m as I,p as B,L as M,q as R}from"./index-D5k3K9s4.js";import{b as m,c as $,u as O}from"./vendor-DZBautpX.js";import{P as z}from"./Pagination-r9zcarWf.js";function D({className:c,filterToggle:s,updateUrlParams:a,type:f=3}){const{filters:t,updateFilters:x}=m.useContext(C),{user:i}=k(),p=r=>{x(d(n({},t),{min:r[0],max:r[1],page:1})),a(d(n({},t),{min:r[0],max:r[1],page:1}))},g=r=>{const o=r.target.value;x(d(n({},t),{productType:o,page:1})),a(d(n({},t),{productType:o,page:1}))},b=r=>{const o=r.target.value;x(d(n({},t),{tag:o,page:1})),a(d(n({},t),{tag:o,page:1}))},[j,y]=m.useState([]);return m.useEffect(()=>{(async()=>{try{const o=await E.getTags();y(o),console.log(o)}catch(o){console.error("Erreur lors de la récupération des catégories",o)}})()},[]),e.jsxs("div",{className:`filter-widget w-full fixed lg:relative left-0 top-0 h-screen z-10 lg:h-auto overflow-y-scroll lg:overflow-y-auto bg-white px-[30px] pt-[40px] ${c||""} ${s?"block":"hidden lg:block"}`,children:[e.jsxs("div",{className:"filter-subject-item pb-10 border-b border-qgray-border",children:[e.jsx("div",{className:"subject-title mb-[20px]",children:e.jsx("h1",{className:"text-black text-base font-500",children:"Type de produits"})}),e.jsxs("div",{className:"flex flex-col gap-3 text-sm text-qgray",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",value:"All",name:"productType",checked:t.productType==="All",onChange:g}),"Tous les produits"]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",value:"promo",name:"productType",checked:t.productType==="promo",onChange:g}),"Produits en promo"]}),i&&e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",value:"credit",name:"productType",checked:t.productType==="credit",onChange:g}),"Produits à crédit"]})]})]}),e.jsxs("div",{className:"filter-subject-item pb-10 border-b border-qgray-border mt-10",children:[e.jsx("div",{className:"subject-title mb-[20px]",children:e.jsx("h1",{className:"text-black text-base font-500",children:"Filtrer par tags"})}),e.jsx("div",{className:"text-sm text-qgray",children:e.jsxs("select",{className:"w-full border border-qgray-border px-3 py-2 rounded",value:t.tag||"",onChange:b,children:[e.jsx("option",{value:"",children:"Tous les tags"}),j.map(r=>e.jsx("option",{value:r.slug||r.name,children:r.name},r.id))]})})]}),e.jsxs("div",{className:"filter-subject-item pb-10 border-b border-qgray-border mt-10",children:[e.jsx("div",{className:"subject-title mb-[30px]",children:e.jsx("h1",{className:"text-black text-base font-500",children:"Échelle des prix"})}),e.jsx("div",{className:"price-range mb-5",children:e.jsx(A,{value:[t.min,t.max],onInput:p,min:4e3,max:5e6})}),e.jsxs("p",{className:"text-xs text-qblack font-400",children:["Prix (FCFA): ",t.min," - ",t.max]})]})]})}function J(){const{currentProducts:c,totalProducts:s,isLoadingProduct:a,fetchProducts:f,updateFilters:t,resetFilters:x,filters:i}=m.useContext(C),p=$(),g=O();m.useEffect(()=>{x();const l=new URLSearchParams(p.search),u={page:Number.parseInt(l.get("page"))||1,category:l.get("category")||"All",search:l.get("search")||"",min:Number.parseInt(l.get("min"))||1e3,max:Number.parseInt(l.get("max"))||5e6,limit:9,productType:l.get("productType")||"All",tag:l.get("tag")||"All"};t(u),window.scrollTo({top:0,left:100,behavior:"smooth"})},[p.pathname,p.search,x,t]),m.useEffect(()=>{f()},[f]);const b=(i.page-1)*i.limit+1,j=Math.min(i.page*i.limit,s),y=l=>{o(d(n({},i),{page:l})),window.scrollTo({top:0,left:100,behavior:"smooth"})},r=l=>{o({category:l||"All",page:1}),window.scrollTo({top:0,left:100,behavior:"smooth"})},o=m.useCallback(l=>{const u=new URLSearchParams(p.search);Object.entries(l).forEach(([v,h])=>{h!=null&&h!==""?u.set(v,h.toString()):u.delete(v)}),g({search:u.toString()},{replace:!0})},[p.search,g]);return e.jsxs(e.Fragment,{children:[e.jsx(L,{title:"CCBM Shop | Boutique",description:"Découvrez les meilleures offres sur CCBM Shop, votre destination privilégiée pour l'électroménager de qualité.",keywords:"électroménager, boutique en ligne d'électroménager, CCBM Shop, ccbme, appareils électroménagers à prix réduits"}),e.jsx(I,{children:e.jsx("div",{className:"products-page-wrapper w-full",children:e.jsxs("div",{className:"container-x mx-auto",children:[e.jsx(B,{}),e.jsxs("div",{className:"w-full lg:flex lg:space-x-[30px]",children:[e.jsx("div",{className:"lg:w-[270px]",children:e.jsx(D,{handleCategoryChange:r,updateUrlParams:o})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"products-sorting w-full bg-white flex flex-col md:flex-row justify-between p-[30px] mb-[40px]",children:e.jsxs("p",{className:"font-400 text-[13px]",children:[e.jsx("span",{className:"text-qgray",children:"Affichage"})," ",s>0?`${b}–${j} sur ${s} résultats`:"0 résultat"]})}),a?e.jsxs("div",{className:"flex justify-center items-center",children:[e.jsx(M,{className:"animate-spin"})," Chargement"]}):c.length===0?e.jsx("div",{className:"flex justify-center items-center",children:"Pas de produits disponible pour le moment"}):e.jsx("div",{className:"grid xl:grid-cols-3 grid-cols-2 gap-[30px]",children:c.map(l=>e.jsx(R,{datas:l},l.id))}),e.jsx(z,{currentPage:i.page,totalPages:Math.ceil(s/i.limit),onPageChange:y})]})]})]})})})]})}export{J as default};

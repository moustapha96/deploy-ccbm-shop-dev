var k=Object.defineProperty,A=Object.defineProperties;var S=Object.getOwnPropertyDescriptors;var v=Object.getOwnPropertySymbols;var T=Object.prototype.hasOwnProperty,q=Object.prototype.propertyIsEnumerable;var w=(t,s,r)=>s in t?k(t,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[s]=r,f=(t,s)=>{for(var r in s||(s={}))T.call(s,r)&&w(t,r,s[r]);if(v)for(var r of v(s))q.call(s,r)&&w(t,r,s[r]);return t},b=(t,s)=>A(t,S(s));import{b as m,j as e,I as P,J as E,e as F,f as M,u as L,k as $}from"./react-vendor-oXU13CxVON7vKjIB.js";import{c as C,g as B,S as R,L as I,B as O,h as z}from"./index-DxAeoNi_vcMUlDbs.js";import"./vendor-CztfEaG7C0izJ0f1.js";import"./ui-libs-DW48STyta0ayNJBW.js";import"./redux-BZdFRlKmMnL7MBoD.js";function U({className:t,filterToggle:s,updateUrlParams:r}){var p;const{filters:i,updateFilters:o}=m.useContext(C),[a,d]=m.useState([]);m.useEffect(()=>{(async()=>{try{const n=await B.getTags();d(Array.isArray(n)?n:[])}catch(n){console.error("Erreur lors de la récupération des tags",n),d([])}})()},[]);const x=c=>{const[n,h]=c,N=b(f({},i),{min:n,max:h,page:1});o(N),r(N)},j=c=>{const n=c.target.value,h=b(f({},i),{tag:n,page:1});o(h),r(h)};return e.jsxs("div",{className:`filter-widget w-full fixed lg:relative left-0 top-0 h-screen z-10 lg:h-auto overflow-y-scroll lg:overflow-y-auto bg-white px-[30px] pt-[40px] ${t||""} ${s?"block":"hidden lg:block"}`,children:[e.jsxs("div",{className:"filter-subject-item pb-10 border-b border-qgray-border mt-10",children:[e.jsx("div",{className:"subject-title mb-[20px]",children:e.jsx("h1",{className:"text-black text-base font-500",children:"Filtrer par tags"})}),e.jsx("div",{className:"text-sm text-qgray",children:e.jsxs("select",{className:"w-full border border-qgray-border px-3 py-2 rounded",value:(p=i.tag)!=null?p:"All",onChange:j,children:[e.jsx("option",{value:"All",children:"Tous les tags"}),a.map(c=>e.jsx("option",{value:c.slug||c.name,children:c.name},c.id))]})})]}),e.jsxs("div",{className:"filter-subject-item pb-10 border-b border-qgray-border mt-10",children:[e.jsx("div",{className:"subject-title mb-[30px]",children:e.jsx("h1",{className:"text-black text-base font-500",children:"Échelle des prix"})}),e.jsx("div",{className:"price-range mb-5",children:e.jsx(P,{value:[i.min,i.max],onInput:x,min:1e3,max:5e6})}),e.jsxs("p",{className:"text-xs text-qblack font-400",children:["Prix (FCFA): ",i.min," - ",i.max]})]})]})}const D=({currentPage:t,totalPages:s,onPageChange:r})=>{const i=()=>{const a=[];for(let d=Math.max(2,t-2);d<=Math.min(s-1,t+2);d++)a.push(d);return t-2>2&&a.unshift("..."),t+2<s-1&&a.push("..."),a.unshift(1),s!==1&&a.push(s),a};return e.jsx("nav",{className:"flex justify-center items-center mt-8 px-4","aria-label":"Pagination",children:e.jsxs("ul",{className:"flex flex-wrap justify-center items-center space-x-1 md:space-x-2",children:[e.jsx("li",{children:e.jsx("button",{onClick:()=>r(Math.max(1,t-1)),disabled:t===1,className:"p-2 rounded-full bg-gray-200 text-gray-700 hover:bg-qyellow disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Previous page",children:e.jsx(E,{className:"w-5 h-5"})})}),i().map((o,a)=>e.jsx("li",{children:typeof o=="number"?e.jsx("button",{onClick:()=>r(o),className:`hidden sm:block px-3 py-2 rounded ${t===o?"bg-bleu-logo text-white":"bg-gray-200 text-gray-700 hover:bg-qyellow"}`,"aria-current":t===o?"page":void 0,children:o}):e.jsx("span",{className:"hidden sm:block px-3 py-2",children:o})},a)),e.jsx("li",{className:"sm:hidden",children:e.jsxs("span",{className:"px-3 py-2 text-gray-700",children:[t," / ",s]})}),e.jsx("li",{children:e.jsx("button",{onClick:()=>r(Math.min(s,t+1)),disabled:t===s,className:"p-2 rounded-full bg-gray-200 text-gray-700 hover:bg-qyellow disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Next page",children:e.jsx(F,{className:"w-5 h-5"})})})]})})};function X(){const{currentProductsPromo:t,totalProductsPromo:s,isLoadingProductPromo:r,fetchProdcutsPromo:i,updateFilters:o,filters:a,resetFilters:d}=m.useContext(C),x=M(),j=L();m.useEffect(()=>{d();const l=new URLSearchParams(x.search),g={page:Number(l.get("page"))||1,category:l.get("category")||"All",search:l.get("search")||"",min:Number(l.get("min"))||1e3,max:Number(l.get("max"))||5e6,limit:Number(l.get("limit"))||9,productType:l.get("productType")||"All",tag:l.get("tag")||"All"};o(g),window.scrollTo({top:0,left:0,behavior:"smooth"})},[x.search,x.pathname]),m.useEffect(()=>{i()},[i,a]);const p=m.useCallback(l=>{const g=new URLSearchParams(x.search);Object.entries(l).forEach(([y,u])=>{u==null||u===""||u==="All"?g.delete(y):g.set(y,String(u))}),j({search:g.toString()},{replace:!0})},[x.search,j]),c=l=>{p(b(f({},a),{page:l})),window.scrollTo({top:0,left:0,behavior:"smooth"})},n=l=>{p(b(f({},a),{category:l||"All",page:1})),window.scrollTo({top:0,left:0,behavior:"smooth"})},h=s>0?(a.page-1)*a.limit+1:0,N=Math.min(a.page*a.limit,s);return e.jsxs(e.Fragment,{children:[e.jsx(R,{title:"CCBM Shop | En Promo",description:"Découvrez les meilleures offres promotionnelles sur CCBM Shop, votre destination privilégiée pour l'électroménager de qualité à prix réduits.",keywords:"électroménager, promotions, offres spéciales, CCBM Shop, ccbme, appareils électroménagers à prix réduits"}),e.jsx(I,{children:e.jsx("div",{className:"products-page-wrapper w-full",children:e.jsxs("div",{className:"container-x mx-auto",children:[e.jsx(O,{}),e.jsxs("div",{className:"w-full lg:flex lg:space-x-[30px]",children:[e.jsx("div",{className:"lg:w-[270px]",children:e.jsx(U,{updateUrlParams:p,handleCategoryChange:n})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"products-sorting w-full bg-white flex flex-col md:flex-row justify-between p-[30px] mb-[40px]",children:e.jsxs("p",{className:"font-400 text-[13px]",children:[e.jsx("span",{className:"text-qgray",children:"Affichage"})," ",s>0?`${h}–${N} sur ${s} résultats`:"0 résultat"]})}),r?e.jsxs("div",{className:"flex justify-center items-center",children:[e.jsx($,{className:"animate-spin"})," Chargement"]}):t.length===0?e.jsx("div",{className:"flex justify-center items-center",children:"Aucun produit en promotion trouvé"}):e.jsx("div",{className:"grid xl:grid-cols-3 grid-cols-2 gap-[30px]",children:t.map(l=>e.jsx(z,{datas:l},l.id))}),e.jsx(D,{currentPage:a.page,totalPages:Math.ceil(s/a.limit),onPageChange:c})]})]})]})})})]})}export{X as default};

var T=Object.defineProperty,k=Object.defineProperties;var q=Object.getOwnPropertyDescriptors;var v=Object.getOwnPropertySymbols;var F=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable;var w=(t,s,l)=>s in t?T(t,s,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[s]=l,d=(t,s)=>{for(var l in s||(s={}))F.call(s,l)&&w(t,l,s[l]);if(v)for(var l of v(s))S.call(s,l)&&w(t,l,s[l]);return t},p=(t,s)=>k(t,q(s));import{P as C,u as A,j as e,R as M,o as E,h as L,i as I,l as R,m as $,p as B,L as P,q as O}from"./index-CX-qx_4j.js";import{b as m,c as z,u as D}from"./vendor-DZBautpX.js";function H({className:t,filterToggle:s,updateUrlParams:l,type:u=3}){const{filters:a,updateFilters:c}=m.useContext(C),{user:n}=A(),x=r=>{c(p(d({},a),{min:r[0],max:r[1],page:1})),l(p(d({},a),{min:r[0],max:r[1],page:1}))},h=r=>{const o=r.target.value;c(p(d({},a),{productType:o,page:1})),l(p(d({},a),{productType:o,page:1}))},f=r=>{const o=r.target.value;c(p(d({},a),{tag:o,page:1})),l(p(d({},a),{tag:o,page:1}))},[j,y]=m.useState([]);return m.useEffect(()=>{(async()=>{try{const o=await E.getTags();y(o),console.log(o)}catch(o){console.error("Erreur lors de la récupération des catégories",o)}})()},[]),e.jsxs("div",{className:`filter-widget w-full fixed lg:relative left-0 top-0 h-screen z-10 lg:h-auto overflow-y-scroll lg:overflow-y-auto bg-white px-[30px] pt-[40px] ${t||""} ${s?"block":"hidden lg:block"}`,children:[e.jsxs("div",{className:"filter-subject-item pb-10 border-b border-qgray-border",children:[e.jsx("div",{className:"subject-title mb-[20px]",children:e.jsx("h1",{className:"text-black text-base font-500",children:"Type de produits"})}),e.jsxs("div",{className:"flex flex-col gap-3 text-sm text-qgray",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",value:"All",name:"productType",checked:a.productType==="All",onChange:h}),"Tous les produits"]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",value:"promo",name:"productType",checked:a.productType==="promo",onChange:h}),"Produits en promo"]}),n&&e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",value:"credit",name:"productType",checked:a.productType==="credit",onChange:h}),"Produits à crédit"]})]})]}),e.jsxs("div",{className:"filter-subject-item pb-10 border-b border-qgray-border mt-10",children:[e.jsx("div",{className:"subject-title mb-[20px]",children:e.jsx("h1",{className:"text-black text-base font-500",children:"Filtrer par tags"})}),e.jsx("div",{className:"text-sm text-qgray",children:e.jsxs("select",{className:"w-full border border-qgray-border px-3 py-2 rounded",value:a.tag||"",onChange:f,children:[e.jsx("option",{value:"",children:"Tous les tags"}),j.map(r=>e.jsx("option",{value:r.slug||r.name,children:r.name},r.id))]})})]}),e.jsxs("div",{className:"filter-subject-item pb-10 border-b border-qgray-border mt-10",children:[e.jsx("div",{className:"subject-title mb-[30px]",children:e.jsx("h1",{className:"text-black text-base font-500",children:"Échelle des prix"})}),e.jsx("div",{className:"price-range mb-5",children:e.jsx(M,{value:[a.min,a.max],onInput:x,min:4e3,max:5e6})}),e.jsxs("p",{className:"text-xs text-qblack font-400",children:["Prix (FCFA): ",a.min," - ",a.max]})]})]})}const U=({currentPage:t,totalPages:s,onPageChange:l})=>{const u=()=>{const c=[];for(let n=Math.max(2,t-2);n<=Math.min(s-1,t+2);n++)c.push(n);return t-2>2&&c.unshift("..."),t+2<s-1&&c.push("..."),c.unshift(1),s!==1&&c.push(s),c};return e.jsx("nav",{className:"flex justify-center items-center mt-8 px-4","aria-label":"Pagination",children:e.jsxs("ul",{className:"flex flex-wrap justify-center items-center space-x-1 md:space-x-2",children:[e.jsx("li",{children:e.jsx("button",{onClick:()=>l(Math.max(1,t-1)),disabled:t===1,className:"p-2 rounded-full bg-gray-200 text-gray-700 hover:bg-qyellow disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Previous page",children:e.jsx(L,{className:"w-5 h-5"})})}),u().map((a,c)=>e.jsx("li",{children:typeof a=="number"?e.jsx("button",{onClick:()=>l(a),className:`hidden sm:block px-3 py-2 rounded ${t===a?"bg-bleu-logo text-white":"bg-gray-200 text-gray-700 hover:bg-qyellow"}`,"aria-current":t===a?"page":void 0,children:a}):e.jsx("span",{className:"hidden sm:block px-3 py-2",children:a})},c)),e.jsx("li",{className:"sm:hidden",children:e.jsxs("span",{className:"px-3 py-2 text-gray-700",children:[t," / ",s]})}),e.jsx("li",{children:e.jsx("button",{onClick:()=>l(Math.min(s,t+1)),disabled:t===s,className:"p-2 rounded-full bg-gray-200 text-gray-700 hover:bg-qyellow disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Next page",children:e.jsx(I,{className:"w-5 h-5"})})})]})})};function K(){const{currentProducts:t,totalProducts:s,isLoadingProduct:l,fetchProducts:u,updateFilters:a,resetFilters:c,filters:n}=m.useContext(C),x=z(),h=D();m.useEffect(()=>{c();const i=new URLSearchParams(x.search),g={page:Number.parseInt(i.get("page"))||1,category:i.get("category")||"All",search:i.get("search")||"",min:Number.parseInt(i.get("min"))||1e3,max:Number.parseInt(i.get("max"))||5e6,limit:9,productType:i.get("productType")||"All",tag:i.get("tag")||"All"};a(g),window.scrollTo({top:0,left:100,behavior:"smooth"})},[x.pathname,x.search,c,a]),m.useEffect(()=>{u()},[u]);const f=(n.page-1)*n.limit+1,j=Math.min(n.page*n.limit,s),y=i=>{o(p(d({},n),{page:i})),window.scrollTo({top:0,left:100,behavior:"smooth"})},r=i=>{o({category:i||"All",page:1}),window.scrollTo({top:0,left:100,behavior:"smooth"})},o=m.useCallback(i=>{const g=new URLSearchParams(x.search);Object.entries(i).forEach(([N,b])=>{b!=null&&b!==""?g.set(N,b.toString()):g.delete(N)}),h({search:g.toString()},{replace:!0})},[x.search,h]);return e.jsxs(e.Fragment,{children:[e.jsx(R,{title:"CCBM Shop | Boutique",description:"Découvrez les meilleures offres sur CCBM Shop, votre destination privilégiée pour l'électroménager de qualité.",keywords:"électroménager, boutique en ligne d'électroménager, CCBM Shop, ccbme, appareils électroménagers à prix réduits"}),e.jsx($,{children:e.jsx("div",{className:"products-page-wrapper w-full",children:e.jsxs("div",{className:"container-x mx-auto",children:[e.jsx(B,{}),e.jsxs("div",{className:"w-full lg:flex lg:space-x-[30px]",children:[e.jsx("div",{className:"lg:w-[270px]",children:e.jsx(H,{handleCategoryChange:r,updateUrlParams:o})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"products-sorting w-full bg-white flex flex-col md:flex-row justify-between p-[30px] mb-[40px]",children:e.jsxs("p",{className:"font-400 text-[13px]",children:[e.jsx("span",{className:"text-qgray",children:"Affichage"})," ",s>0?`${f}–${j} sur ${s} résultats`:"0 résultat"]})}),l?e.jsxs("div",{className:"flex justify-center items-center",children:[e.jsx(P,{className:"animate-spin"})," Chargement"]}):t.length===0?e.jsx("div",{className:"flex justify-center items-center",children:"Pas de produits disponible pour le moment"}):e.jsx("div",{className:"grid xl:grid-cols-3 grid-cols-2 gap-[30px]",children:t.map(i=>e.jsx(O,{datas:i},i.id))}),e.jsx(U,{currentPage:n.page,totalPages:Math.ceil(s/n.limit),onPageChange:y})]})]})]})})})]})}export{K as default};

var T=Object.defineProperty,P=Object.defineProperties;var S=Object.getOwnPropertyDescriptors;var N=Object.getOwnPropertySymbols;var q=Object.prototype.hasOwnProperty,F=Object.prototype.propertyIsEnumerable;var w=(o,t,a)=>t in o?T(o,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):o[t]=a,n=(o,t)=>{for(var a in t||(t={}))q.call(t,a)&&w(o,a,t[a]);if(N)for(var a of N(t))F.call(t,a)&&w(o,a,t[a]);return o},d=(o,t)=>P(o,S(t));import{b as m,j as e,G as k,L as A}from"./react-CJBSR92-u_nCHxWM.js";import{P as C,u as E,g as L,S as B,L as I,B as M,h as $}from"./index-7aT0jyaVKf-5uYaT.js";import{P as R}from"./Pagination-ByhR6VjUQBi1gKSU.js";import{a as O,u as z}from"./react-router-DM7lm-eIKbi5VnqZ.js";import"./vendor-DqtG7wAGu1JuSsNW.js";import"./react-dom-DgVs7Ap73AfOoX-q.js";import"./ui-libs-DW48STyta0ayNJBW.js";import"./redux-4EhM0GaGlm-MPJuT.js";function D({className:o,filterToggle:t,updateUrlParams:a,type:f=3}){const{filters:s,updateFilters:x}=m.useContext(C),{user:i}=E(),p=r=>{x(d(n({},s),{min:r[0],max:r[1],page:1})),a(d(n({},s),{min:r[0],max:r[1],page:1}))},g=r=>{const c=r.target.value;x(d(n({},s),{productType:c,page:1})),a(d(n({},s),{productType:c,page:1}))},b=r=>{const c=r.target.value;x(d(n({},s),{tag:c,page:1})),a(d(n({},s),{tag:c,page:1}))},[j,y]=m.useState([]);return m.useEffect(()=>{(async()=>{try{const c=await L.getTags();y(c),console.log(c)}catch(c){console.error("Erreur lors de la récupération des catégories",c)}})()},[]),e.jsxs("div",{className:`filter-widget w-full fixed lg:relative left-0 top-0 h-screen z-10 lg:h-auto overflow-y-scroll lg:overflow-y-auto bg-white px-[30px] pt-[40px] ${o||""} ${t?"block":"hidden lg:block"}`,children:[e.jsxs("div",{className:"filter-subject-item pb-10 border-b border-qgray-border",children:[e.jsx("div",{className:"subject-title mb-[20px]",children:e.jsx("h1",{className:"text-black text-base font-500",children:"Type de produits"})}),e.jsxs("div",{className:"flex flex-col gap-3 text-sm text-qgray",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",value:"All",name:"productType",checked:s.productType==="All",onChange:g}),"Tous les produits"]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",value:"promo",name:"productType",checked:s.productType==="promo",onChange:g}),"Produits en promo"]}),i&&e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",value:"credit",name:"productType",checked:s.productType==="credit",onChange:g}),"Produits à crédit"]})]})]}),e.jsxs("div",{className:"filter-subject-item pb-10 border-b border-qgray-border mt-10",children:[e.jsx("div",{className:"subject-title mb-[20px]",children:e.jsx("h1",{className:"text-black text-base font-500",children:"Filtrer par tags"})}),e.jsx("div",{className:"text-sm text-qgray",children:e.jsxs("select",{className:"w-full border border-qgray-border px-3 py-2 rounded",value:s.tag||"",onChange:b,children:[e.jsx("option",{value:"",children:"Tous les tags"}),j.map(r=>e.jsx("option",{value:r.slug||r.name,children:r.name},r.id))]})})]}),e.jsxs("div",{className:"filter-subject-item pb-10 border-b border-qgray-border mt-10",children:[e.jsx("div",{className:"subject-title mb-[30px]",children:e.jsx("h1",{className:"text-black text-base font-500",children:"Échelle des prix"})}),e.jsx("div",{className:"price-range mb-5",children:e.jsx(k,{value:[s.min,s.max],onInput:p,min:4e3,max:5e6})}),e.jsxs("p",{className:"text-xs text-qblack font-400",children:["Prix (FCFA): ",s.min," - ",s.max]})]})]})}function Y(){const{currentProducts:o,totalProducts:t,isLoadingProduct:a,fetchProducts:f,updateFilters:s,resetFilters:x,filters:i}=m.useContext(C),p=O(),g=z();m.useEffect(()=>{x();const l=new URLSearchParams(p.search),u={page:Number.parseInt(l.get("page"))||1,category:l.get("category")||"All",search:l.get("search")||"",min:Number.parseInt(l.get("min"))||1e3,max:Number.parseInt(l.get("max"))||5e6,limit:9,productType:l.get("productType")||"All",tag:l.get("tag")||"All"};s(u),window.scrollTo({top:0,left:100,behavior:"smooth"})},[p.pathname,p.search,x,s]),m.useEffect(()=>{f()},[f]);const b=(i.page-1)*i.limit+1,j=Math.min(i.page*i.limit,t),y=l=>{c(d(n({},i),{page:l})),window.scrollTo({top:0,left:100,behavior:"smooth"})},r=l=>{c({category:l||"All",page:1}),window.scrollTo({top:0,left:100,behavior:"smooth"})},c=m.useCallback(l=>{const u=new URLSearchParams(p.search);Object.entries(l).forEach(([v,h])=>{h!=null&&h!==""?u.set(v,h.toString()):u.delete(v)}),g({search:u.toString()},{replace:!0})},[p.search,g]);return e.jsxs(e.Fragment,{children:[e.jsx(B,{title:"CCBM Shop | Boutique",description:"Découvrez les meilleures offres sur CCBM Shop, votre destination privilégiée pour l'électroménager de qualité.",keywords:"électroménager, boutique en ligne d'électroménager, CCBM Shop, ccbme, appareils électroménagers à prix réduits"}),e.jsx(I,{children:e.jsx("div",{className:"products-page-wrapper w-full",children:e.jsxs("div",{className:"container-x mx-auto",children:[e.jsx(M,{}),e.jsxs("div",{className:"w-full lg:flex lg:space-x-[30px]",children:[e.jsx("div",{className:"lg:w-[270px]",children:e.jsx(D,{handleCategoryChange:r,updateUrlParams:c})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"products-sorting w-full bg-white flex flex-col md:flex-row justify-between p-[30px] mb-[40px]",children:e.jsxs("p",{className:"font-400 text-[13px]",children:[e.jsx("span",{className:"text-qgray",children:"Affichage"})," ",t>0?`${b}–${j} sur ${t} résultats`:"0 résultat"]})}),a?e.jsxs("div",{className:"flex justify-center items-center",children:[e.jsx(A,{className:"animate-spin"})," Chargement"]}):o.length===0?e.jsx("div",{className:"flex justify-center items-center",children:"Pas de produits disponible pour le moment"}):e.jsx("div",{className:"grid xl:grid-cols-3 grid-cols-2 gap-[30px]",children:o.map(l=>e.jsx($,{datas:l},l.id))}),e.jsx(R,{currentPage:i.page,totalPages:Math.ceil(t/i.limit),onPageChange:y})]})]})]})})})]})}export{Y as default};

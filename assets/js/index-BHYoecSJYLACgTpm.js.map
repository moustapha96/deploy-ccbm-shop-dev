{"version":3,"file":"index-BHYoecSJYLACgTpm.js","sources":["../../../orbit-city-final-dev/src/components/PaymentState/index.jsx"],"sourcesContent":["/* eslint-disable react/prop-types */\r\n/* eslint-disable no-unused-vars */\r\n/* eslint-disable react/prop-types */\r\n\r\n\"use client\"\r\n\r\nimport { useEffect, useState, useCallback } from \"react\"\r\nimport { Link, useLocation, useNavigate } from \"react-router-dom\"\r\nimport { toast } from \"react-toastify\"\r\nimport { Loader } from \"lucide-react\"\r\nimport { Button } from \"flowbite-react\"\r\n\r\nimport BreadcrumbCom from \"../BreadcrumbCom\"\r\nimport PageTitle from \"../Helpers/PageTitle\"\r\nimport Layout from \"../Partials/Layout\"\r\nimport { useAuthContext } from \"../../contexts/useAuthContext\"\r\nimport PaiementService from \"../../services/paimentService\"\r\nimport formatPrice from \"../../utils/formatPrice\"\r\n\r\n// Constants\r\nconst PAYMENT_STATUS = {\r\n  COMPLETED: \"completed\",\r\n  PENDING: \"pending\",\r\n  CANCELLED: \"cancelled\",\r\n}\r\n\r\nconst ORDER_TYPES = {\r\n  ORDER: \"order\",\r\n  PREORDER: \"preorder\",\r\n  CREDITORDER: \"creditorder\",\r\n}\r\n\r\nconst ROUTES = {\r\n  [ORDER_TYPES.ORDER]: (id) => `/commandes/${id}/détails`,\r\n  [ORDER_TYPES.PREORDER]: (id) => `/pre-commandes/${id}/détails`,\r\n  [ORDER_TYPES.CREDITORDER]: (id) => `/credit-commandes/${id}/détails`,\r\n}\r\nexport default function PaymentStatePage({ cart = true }) {\r\n  const { user } = useAuthContext()\r\n  const navigate = useNavigate()\r\n  const location = useLocation()\r\n\r\n  // Consolidated state\r\n  const [state, setState] = useState({\r\n    paymentData: null,\r\n    isLoading: false,\r\n    token: null,\r\n    error: null,\r\n  })\r\n\r\n  // Extract token from URL\r\n  const getTokenFromUrl = useCallback(() => {\r\n    const searchParams = new URLSearchParams(location.search)\r\n    return searchParams.get(\"token\")\r\n  }, [location.search])\r\n\r\n  // Navigation helper\r\n  const navigateToOrder = useCallback(\r\n    (orderType, orderId) => {\r\n      const routeBuilder = ROUTES[orderType]\r\n      if (routeBuilder) {\r\n        navigate(routeBuilder(orderId))\r\n      } else {\r\n        console.error(`Unknown order type: ${orderType}`)\r\n        navigate(\"/profile\")\r\n      }\r\n    },\r\n    [navigate],\r\n  )\r\n\r\n  // Toast notifications\r\n  const showToast = useCallback((type, message) => {\r\n    toast[type](message, {\r\n      position: \"top-right\",\r\n      autoClose: 5000,\r\n    })\r\n  }, [])\r\n\r\n  // Handle payment status\r\n  const handlePaymentStatus = useCallback(\r\n    async (paymentData) => {\r\n      const { status, order_type, order_id } = paymentData\r\n\r\n      switch (status) {\r\n        case PAYMENT_STATUS.COMPLETED:\r\n          navigateToOrder(order_type, order_id)\r\n          break\r\n        case PAYMENT_STATUS.PENDING:\r\n          showToast(\"warning\", \"Le paiement est en attente\")\r\n          break\r\n        case PAYMENT_STATUS.CANCELLED:\r\n          showToast(\"error\", \"Le paiement a été annulé\")\r\n          break\r\n        default:\r\n          showToast(\"warning\", \"Statut de paiement inconnu\")\r\n      }\r\n    },\r\n    [navigateToOrder, showToast],\r\n  )\r\n\r\n  // Update payment details\r\n  const updatePaymentDetails = useCallback(\r\n    async (token, paymentData) => {\r\n      const { receipt_url, customer, status } = paymentData\r\n      try {\r\n        const response = await PaiementService.putPaymentDetailByToken(\r\n          token,\r\n          receipt_url,\r\n          customer.name,\r\n          customer.email,\r\n          customer.phone,\r\n          status,\r\n        )\r\n        console.log(response)\r\n        if (response && response.type_sale) {\r\n          navigateToOrder(response.type_sale, response.id)\r\n        }\r\n        navigateToOrder(response.type_sale, response.id)\r\n      } catch (error) {\r\n        console.log(error)\r\n        showToast(\"warning\", (error && error.response && error.response.data && error.response.data.message) ? error.response.data.message : \"Erreur lors de la mise à jour du paiement\")\r\n      }\r\n    },\r\n    [navigateToOrder, showToast],\r\n  )\r\n\r\n  // Confirm payment\r\n  const confirmPayment = useCallback(\r\n    async (token) => {\r\n      setState((prev) => ({ ...prev, isLoading: true, error: null }))\r\n      try {\r\n        const paymentData = await PaiementService.confirmInvoice(token)\r\n        setState((prev) => ({ ...prev, paymentData }))\r\n        if (paymentData.response_code === \"00\" && paymentData.status === PAYMENT_STATUS.COMPLETED) {\r\n\r\n          const { receipt_url, customer, status } = paymentData\r\n          console.log(paymentData.invoice)\r\n          if (paymentData.status !== PAYMENT_STATUS.COMPLETED) {\r\n            showToast(\"warning\", \"Le paiement n'est pas encore validé\")\r\n          }\r\n          else if (paymentData.status === PAYMENT_STATUS.COMPLETED) {\r\n            showToast(\"success\", \"Le paiement est validé\")\r\n          }\r\n          await updatePaymentDetails(token, paymentData)\r\n        } else if (paymentData.status === PAYMENT_STATUS.CANCELLED) {\r\n          showToast(\"error\", \"Le paiement a été annulé\")\r\n          await PaiementService.putPaymentDetailByToken(token)\r\n        } else if (paymentData.status === PAYMENT_STATUS.PENDING) {\r\n          showToast(\"warning\", \"Le paiement est en attente\")\r\n        }\r\n      } catch (error) {\r\n        console.error(\"Error confirming payment:\", error)\r\n        setState((prev) => ({ ...prev, error: \"Erreur lors de la confirmation du paiement\" }))\r\n        showToast(\"error\", \"Erreur lors de la confirmation du paiement\")\r\n      } finally {\r\n        setState((prev) => ({ ...prev, isLoading: false }))\r\n      }\r\n    },\r\n    [updatePaymentDetails, showToast],\r\n  )\r\n\r\n  // Check payment status\r\n  const checkPaymentStatus = useCallback(\r\n    async (token) => {\r\n      try {\r\n        const response = await PaiementService.getPaymentDetailsByToken(token)\r\n\r\n        if (response && response.payment_state && response.token_status) {\r\n          await handlePaymentStatus({\r\n            ...response,\r\n            status: response.payment_state,\r\n            order_type: response.order_type,\r\n            order_id: response.order_id,\r\n          })\r\n        }\r\n      } catch (error) {\r\n        console.error(\"Error checking payment status:\", error)\r\n      }\r\n    },\r\n    [handlePaymentStatus],\r\n  )\r\n\r\n  // Handle invoice opening\r\n  const handleOpenInvoice = useCallback(() => {\r\n    if (state.paymentData && state.paymentData.receipt_url) {\r\n      window.open(state.paymentData.receipt_url, \"_blank\", \"noopener,noreferrer\")\r\n    }\r\n  }, [state.paymentData && state.paymentData.receipt_url])\r\n\r\n  // Manual verification\r\n  const handleManualVerification = useCallback(async () => {\r\n    if (state.token) {\r\n      await confirmPayment(state.token)\r\n    }\r\n  }, [state.token, confirmPayment])\r\n\r\n  // Main effect for handling token and payment confirmation\r\n  useEffect(() => {\r\n    const token = getTokenFromUrl()\r\n    if (!token) {\r\n      setState((prev) => ({ ...prev, token: null }))\r\n      return\r\n    }\r\n    setState((prev) => ({ ...prev, token }))\r\n    // Check payment status first\r\n    checkPaymentStatus(token)\r\n    // Confirm payment after delay\r\n    const timeoutId = setTimeout(() => {\r\n      confirmPayment(token)\r\n    }, 1000)\r\n\r\n    return () => clearTimeout(timeoutId)\r\n  }, [getTokenFromUrl, checkPaymentStatus, confirmPayment])\r\n\r\n  // Breadcrumb configuration\r\n  const breadcrumbPaths = [\r\n    { name: \"Accueil\", path: \"/\" },\r\n    { name: \"Tableau de bord\", path: \"/profile\" },\r\n    { name: \"Validation Paiement\", path: `/payment-state?token=${state.token}` },\r\n  ]\r\n\r\n  return (\r\n    <Layout childrenClasses={cart ? \"pt-0 pb-0\" : \"\"}>\r\n      {cart ? (\r\n        <div className=\"cart-page-wrapper w-full bg-white pb-[60px]\">\r\n          <div className=\"w-full\">\r\n            <PageTitle title=\"Statut Paiement\" breadcrumb={breadcrumbPaths} />\r\n          </div>\r\n\r\n          {state.isLoading && <LoadingSpinner />}\r\n\r\n          {state.paymentData && <PaymentDetails data={state.paymentData} onOpenInvoice={handleOpenInvoice} />}\r\n\r\n          {!state.token && <InvalidTokenSection onVerify={handleManualVerification} />}\r\n        </div>\r\n      ) : (\r\n        <div className=\"cart-page-wrapper w-full\">\r\n          <div className=\"container-x mx-auto\">\r\n            <BreadcrumbCom paths={breadcrumbPaths} />\r\n          </div>\r\n        </div>\r\n      )}\r\n    </Layout>\r\n  )\r\n}\r\n\r\n// Loading component\r\nfunction LoadingSpinner() {\r\n  return (\r\n    <div className=\"flex justify-center items-center w-full h-64\">\r\n      <Loader size={50} className=\"animate-spin text-blue-500\" />\r\n    </div>\r\n  )\r\n}\r\n\r\n\r\nfunction PaymentDetails({ data, onOpenInvoice }) {\r\n  return (\r\n    <div className=\"w-full mt-[23px]\">\r\n      <div className=\"container-x mx-auto\">\r\n        <div className=\"checkout-main-content w-full\">\r\n          <div className=\"container-x mx-auto\">\r\n            <div className=\"w-full lg:flex lg:space-x-[30px]\">\r\n              <div className=\"flex-1\">\r\n                <h1 className=\"sm:text-2xl text-xl text-qblack font-medium mb-5\">Récapitulatif paiement</h1>\r\n                <div className=\"w-full px-10 py-[30px] border border-[#EDEDED] rounded-lg\">\r\n                  <PaymentDetailsHeader />\r\n                  <PaymentDetailsList data={data} onOpenInvoice={onOpenInvoice} />\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\n// Payment details header\r\nfunction PaymentDetailsHeader() {\r\n  return (\r\n    <div className=\"sub-total mb-6\">\r\n      <div className=\"flex justify-between mb-5\">\r\n        <p className=\"text-[13px] font-medium text-qblack uppercase\">Détails Paiement</p>\r\n      </div>\r\n      <div className=\"w-full h-[1px] bg-[#EDEDED]\"></div>\r\n    </div>\r\n  )\r\n}\r\n\r\n\r\nfunction PaymentDetailsList({ data, onOpenInvoice }) {\r\n  const details = [\r\n    // eslint-disable-next-line react/prop-types\r\n    { label: \"Prénom & Nom\", value: data.customer.name },\r\n    { label: \"Téléphone\", value: data.customer.phone },\r\n    { label: \"Email\", value: data.customer.email },\r\n    { label: \"Montant Payé\", value: formatPrice(data.invoice.total_amount) },\r\n  ]\r\n\r\n  return (\r\n    <div className=\"product-list w-full mb-[30px]\">\r\n      <ul className=\"flex flex-col space-y-5\">\r\n        {details.map((detail, index) => (\r\n          <PaymentDetailItem key={index} label={detail.label} value={detail.value} />\r\n        ))}\r\n        <li>\r\n          <div className=\"flex justify-between items-center\">\r\n            <div>\r\n              <h4 className=\"text-[15px] text-qblack mb-2.5\">Facture</h4>\r\n            </div>\r\n            <div>\r\n              <button\r\n                className=\"text-[15px] text-blue-600 font-medium underline hover:text-blue-800 transition-colors\"\r\n                onClick={onOpenInvoice}\r\n              >\r\n                Ouvrir la facture\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </li>\r\n      </ul>\r\n      <div className=\"w-full h-[1px] bg-[#EDEDED] mt-6\"></div>\r\n    </div>\r\n  )\r\n}\r\n\r\n\r\n\r\nfunction PaymentDetailItem({ label, value }) {\r\n  return (\r\n    <li>\r\n      <div className=\"flex justify-between items-center\">\r\n        <div>\r\n          <h4 className=\"text-[15px] text-qblack mb-2.5\">{label}</h4>\r\n        </div>\r\n        <div>\r\n          <span className=\"text-[15px] text-qblack font-medium\">{value}</span>\r\n        </div>\r\n      </div>\r\n    </li>\r\n  )\r\n}\r\n\r\n\r\n\r\nfunction InvalidTokenSection({ onVerify }) {\r\n  return (\r\n    <div className=\"checkout-main-content w-full\">\r\n      <div className=\"container-x mx-auto\">\r\n        <div className=\"w-full sm:mb-10 mb-5\">\r\n          <div className=\"sm:flex sm:space-x-[18px]\">\r\n            <div className=\"flex-1 w-full mb-5 space-y-4\">\r\n              <div className=\"w-full h-[70px] bg-red-50 border border-red-200 text-red-800 flex justify-center items-center rounded-lg\">\r\n                <span className=\"text-[15px] font-medium\">Token Non Valide</span>\r\n              </div>\r\n\r\n              <Link to=\"/boutique\" className=\"block\">\r\n                <Button className=\"w-full rounded-lg px-5 py-2.5 font-medium text-xl hover:bg-blue-600 transition-colors\">\r\n                  Retour à la boutique\r\n                </Button>\r\n              </Link>\r\n\r\n              <Button\r\n                color=\"yellow\"\r\n                onClick={onVerify}\r\n                className=\"w-full rounded-lg px-5 py-2.5 font-medium text-xl hover:bg-yellow-500 transition-colors\"\r\n              >\r\n                Vérifier le paiement\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// \"use client\"\r\n\r\n// import { useCallback } from \"react\"\r\n// import { Link, useLocation, useNavigate } from \"react-router-dom\"\r\n// import { Loader } from \"lucide-react\"\r\n// import { Button } from \"flowbite-react\"\r\n\r\n// import BreadcrumbCom from \"../BreadcrumbCom\"\r\n// import PageTitle from \"../Helpers/PageTitle\"\r\n// import Layout from \"../Partials/Layout\"\r\n// import { usePaymentStatus } from \"./payment-status-handler\"\r\n// import formatPrice from \"../../utils/formatPrice\"\r\n\r\n// export default function PaymentStatePage({ cart = true }) {\r\n//   const location = useLocation()\r\n\r\n//   // Extract token from URL\r\n//   const getTokenFromUrl = useCallback(() => {\r\n//     const searchParams = new URLSearchParams(location.search)\r\n//     return searchParams.get(\"token\")\r\n//   }, [location.search])\r\n\r\n//   const token = getTokenFromUrl()\r\n//   const { isLoading, paymentData, error } = usePaymentStatus(token)\r\n\r\n//   // Handle invoice opening\r\n//   const handleOpenInvoice = useCallback(() => {\r\n//     if (paymentData?.receipt_url) {\r\n//       window.open(paymentData.receipt_url, \"_blank\", \"noopener,noreferrer\")\r\n//     }\r\n//   }, [paymentData?.receipt_url])\r\n\r\n//   // Breadcrumb configuration\r\n//   const breadcrumbPaths = [\r\n//     { name: \"Accueil\", path: \"/\" },\r\n//     { name: \"Tableau de bord\", path: \"/profile\" },\r\n//     { name: \"Validation Paiement\", path: `/payment-state?token=${token}` },\r\n//   ]\r\n\r\n//   return (\r\n//     <Layout childrenClasses={cart ? \"pt-0 pb-0\" : \"\"}>\r\n//       {cart ? (\r\n//         <div className=\"cart-page-wrapper w-full bg-white pb-[60px]\">\r\n//           <div className=\"w-full\">\r\n//             <PageTitle title=\"Statut Paiement\" breadcrumb={breadcrumbPaths} />\r\n//           </div>\r\n\r\n//           {isLoading && <LoadingSpinner />}\r\n\r\n//           {paymentData && <PaymentDetails data={paymentData} onOpenInvoice={handleOpenInvoice} />}\r\n\r\n//           {!token && <InvalidTokenSection />}\r\n\r\n//           {error && (\r\n//             <div className=\"flex justify-center items-center w-full h-64\">\r\n//               <div className=\"text-red-500 text-center\">\r\n//                 <p className=\"text-xl font-bold\">Une erreur est survenue</p>\r\n//                 <p className=\"mt-2\">{error}</p>\r\n//               </div>\r\n//             </div>\r\n//           )}\r\n//         </div>\r\n//       ) : (\r\n//         <div className=\"cart-page-wrapper w-full\">\r\n//           <div className=\"container-x mx-auto\">\r\n//             <BreadcrumbCom paths={breadcrumbPaths} />\r\n//           </div>\r\n//         </div>\r\n//       )}\r\n//     </Layout>\r\n//   )\r\n// }\r\n\r\n// // Loading component\r\n// function LoadingSpinner() {\r\n//   return (\r\n//     <div className=\"flex justify-center items-center w-full h-64\">\r\n//       <Loader size={50} className=\"animate-spin text-blue-500\" />\r\n//     </div>\r\n//   )\r\n// }\r\n\r\n// function PaymentDetails({ data, onOpenInvoice }) {\r\n//   return (\r\n//     <div className=\"w-full mt-[23px]\">\r\n//       <div className=\"container-x mx-auto\">\r\n//         <div className=\"checkout-main-content w-full\">\r\n//           <div className=\"container-x mx-auto\">\r\n//             <div className=\"w-full lg:flex lg:space-x-[30px]\">\r\n//               <div className=\"flex-1\">\r\n//                 <h1 className=\"sm:text-2xl text-xl text-qblack font-medium mb-5\">Récapitulatif paiement</h1>\r\n//                 <div className=\"w-full px-10 py-[30px] border border-[#EDEDED] rounded-lg\">\r\n//                   <PaymentDetailsHeader />\r\n//                   <PaymentDetailsList data={data} onOpenInvoice={onOpenInvoice} />\r\n//                 </div>\r\n//               </div>\r\n//             </div>\r\n//           </div>\r\n//         </div>\r\n//       </div>\r\n//     </div>\r\n//   )\r\n// }\r\n\r\n// // Payment details header\r\n// function PaymentDetailsHeader() {\r\n//   return (\r\n//     <div className=\"sub-total mb-6\">\r\n//       <div className=\"flex justify-between mb-5\">\r\n//         <p className=\"text-[13px] font-medium text-qblack uppercase\">Détails Paiement</p>\r\n//       </div>\r\n//       <div className=\"w-full h-[1px] bg-[#EDEDED]\"></div>\r\n//     </div>\r\n//   )\r\n// }\r\n\r\n// function PaymentDetailsList({ data, onOpenInvoice }) {\r\n//   const details = [\r\n//     { label: \"Prénom & Nom\", value: data.customer.name },\r\n//     { label: \"Téléphone\", value: data.customer.phone },\r\n//     { label: \"Email\", value: data.customer.email },\r\n//     { label: \"Montant Payé\", value: formatPrice(data.invoice.total_amount) },\r\n//     {\r\n//       label: \"Statut\",\r\n//       value:\r\n//         data.status === \"completed\" ? (\r\n//           <span className=\"text-green-500\">Complété</span>\r\n//         ) : data.status === \"pending\" ? (\r\n//           <span className=\"text-yellow-500\">En attente</span>\r\n//         ) : (\r\n//           <span className=\"text-red-500\">Annulé</span>\r\n//         ),\r\n//     },\r\n//   ]\r\n\r\n//   return (\r\n//     <div className=\"product-list w-full mb-[30px]\">\r\n//       <ul className=\"flex flex-col space-y-5\">\r\n//         {details.map((detail, index) => (\r\n//           <PaymentDetailItem key={index} label={detail.label} value={detail.value} />\r\n//         ))}\r\n//         <li>\r\n//           <div className=\"flex justify-between items-center\">\r\n//             <div>\r\n//               <h4 className=\"text-[15px] text-qblack mb-2.5\">Facture</h4>\r\n//             </div>\r\n//             <div>\r\n//               <button\r\n//                 className=\"text-[15px] text-blue-600 font-medium underline hover:text-blue-800 transition-colors\"\r\n//                 onClick={onOpenInvoice}\r\n//               >\r\n//                 Ouvrir la facture\r\n//               </button>\r\n//             </div>\r\n//           </div>\r\n//         </li>\r\n//       </ul>\r\n//       <div className=\"w-full h-[1px] bg-[#EDEDED] mt-6\"></div>\r\n//     </div>\r\n//   )\r\n// }\r\n\r\n// function PaymentDetailItem({ label, value }) {\r\n//   return (\r\n//     <li>\r\n//       <div className=\"flex justify-between items-center\">\r\n//         <div>\r\n//           <h4 className=\"text-[15px] text-qblack mb-2.5\">{label}</h4>\r\n//         </div>\r\n//         <div>\r\n//           <span className=\"text-[15px] text-qblack font-medium\">{value}</span>\r\n//         </div>\r\n//       </div>\r\n//     </li>\r\n//   )\r\n// }\r\n\r\n// function InvalidTokenSection() {\r\n//   const navigate = useNavigate()\r\n\r\n//   return (\r\n//     <div className=\"checkout-main-content w-full\">\r\n//       <div className=\"container-x mx-auto\">\r\n//         <div className=\"w-full sm:mb-10 mb-5\">\r\n//           <div className=\"sm:flex sm:space-x-[18px]\">\r\n//             <div className=\"flex-1 w-full mb-5 space-y-4\">\r\n//               <div className=\"w-full h-[70px] bg-red-50 border border-red-200 text-red-800 flex justify-center items-center rounded-lg\">\r\n//                 <span className=\"text-[15px] font-medium\">Token Non Valide</span>\r\n//               </div>\r\n\r\n//               <Link to=\"/boutique\" className=\"block\">\r\n//                 <Button className=\"w-full rounded-lg px-5 py-2.5 font-medium text-xl hover:bg-blue-600 transition-colors\">\r\n//                   Retour à la boutique\r\n//                 </Button>\r\n//               </Link>\r\n\r\n//               <Button\r\n//                 color=\"yellow\"\r\n//                 onClick={() => navigate(\"/profile\")}\r\n//                 className=\"w-full rounded-lg px-5 py-2.5 font-medium text-xl hover:bg-yellow-500 transition-colors\"\r\n//               >\r\n//                 Voir mes commandes\r\n//               </Button>\r\n//             </div>\r\n//           </div>\r\n//         </div>\r\n//       </div>\r\n//     </div>\r\n//   )\r\n// }\r\n"],"names":["PAYMENT_STATUS","ORDER_TYPES","ROUTES","id","PaymentStatePage","cart","user","useAuthContext","navigate","useNavigate","location","useLocation","state","setState","useState","getTokenFromUrl","useCallback","navigateToOrder","orderType","orderId","routeBuilder","showToast","type","message","toast","handlePaymentStatus","paymentData","status","order_type","order_id","updatePaymentDetails","token","receipt_url","customer","response","PaiementService","error","confirmPayment","prev","__spreadProps","__spreadValues","checkPaymentStatus","handleOpenInvoice","handleManualVerification","useEffect","timeoutId","breadcrumbPaths","jsx","Layout","jsxs","PageTitle","LoadingSpinner","PaymentDetails","InvalidTokenSection","BreadcrumbCom","Loader","data","onOpenInvoice","PaymentDetailsHeader","PaymentDetailsList","details","formatPrice","detail","index","PaymentDetailItem","label","value","onVerify","Link","Button"],"mappings":"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"}
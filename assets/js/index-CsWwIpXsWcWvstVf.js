var me=Object.defineProperty,pe=Object.defineProperties;var xe=Object.getOwnPropertyDescriptors;var ee=Object.getOwnPropertySymbols;var ue=Object.prototype.hasOwnProperty,he=Object.prototype.propertyIsEnumerable;var te=(i,o,d)=>o in i?me(i,o,{enumerable:!0,configurable:!0,writable:!0,value:d}):i[o]=d,p=(i,o)=>{for(var d in o||(o={}))ue.call(o,d)&&te(i,d,o[d]);if(ee)for(var d of ee(o))he.call(o,d)&&te(i,d,o[d]);return i},x=(i,o)=>pe(i,xe(o));import{b as l,j as e,a4 as ye,a5 as be,T as fe,B as se,l as ae,x as y}from"./react-CJBSR92-u_nCHxWM.js";import{u as je,L as ge}from"./react-router-DM7lm-eIKbi5VnqZ.js";import{C as Z,f as E,u as Ne,S as _e,L as ve,B as we,l as Ce}from"./index-7aT0jyaVKf-5uYaT.js";import{B as Se}from"./BannerPub-D7nUYU1rOOAK_MVf.js";import{c as R}from"./creditCommandeService-CfBVVIIePLciAbJZ.js";import{g as ke}from"./entrepriseFunctionService-V07Ti_3VBY_jBfe5.js";import"./vendor-DqtG7wAGu1JuSsNW.js";import"./react-dom-DgVs7Ap73AfOoX-q.js";import"./ui-libs-DW48STyta0ayNJBW.js";import"./redux-4EhM0GaGlm-MPJuT.js";function De({produit:i}){const{updateCreditOrder:o}=l.useContext(Z),d=g=>{g.preventDefault(),o(i,i.quantity+1)},M=g=>{console.log("produit.quantity"),console.log(i.quantity),g.preventDefault(),i.quantity>1&&o(i,i.quantity-1)};return e.jsx("div",{className:"w-[120px] h-[40px] px-[26px] flex items-center border border-qgray-border",children:e.jsxs("div",{className:"flex justify-between items-center w-full",children:[e.jsx("button",{onClick:M,type:"button",className:"text-base text-qgray",children:e.jsx(ye,{})}),e.jsx("span",{className:"text-qblack",children:i.quantity?i.quantity:0}),e.jsx("button",{onClick:d,type:"button",className:"text-base text-qgray",children:e.jsx(be,{})})]})})}function Ee({className:i}){const{creditOrder:o,clearCreditOrder:d,removeFromCreditOrder:M}=l.useContext(Z);console.log(o);const g=(s,j)=>{s.preventDefault(),M(j)};return e.jsxs("div",{className:`w-full ${i||""}`,children:[e.jsx("div",{className:"relative w-full overflow-x-auto border border-[#EDEDED]",children:e.jsx("table",{className:"w-full text-sm text-left text-gray-500 dark:text-gray-400",children:e.jsxs("tbody",{children:[e.jsxs("tr",{className:"text-[13px] font-medium text-black bg-[#F6F6F6] whitespace-nowrap px-2 border-b default-border-bottom uppercase",children:[e.jsx("td",{className:"py-4 pl-10 block whitespace-nowrap min-w-[300px]",children:"product"}),e.jsx("td",{className:"py-4 whitespace-nowrap text-center",children:"Prix"}),e.jsx("td",{className:"py-4 whitespace-nowrap  text-center",children:"Quantité"}),e.jsx("td",{className:"py-4 whitespace-nowrap  text-center",children:"total"}),e.jsx("td",{className:"py-4 whitespace-nowrap text-right w-[114px]"})]}),o&&o.map((s,j)=>e.jsxs("tr",{className:"bg-white border-b hover:bg-gray-50",children:[e.jsx("td",{className:"pl-10  py-4  w-[380px]",children:e.jsxs("div",{className:"flex space-x-6 items-center",children:[e.jsx("div",{className:"w-[80px] h-[80px] overflow-hidden flex justify-center items-center border border-[#EDEDED]",children:e.jsx("img",{src:`${s.image_256?"data:image/png;base64,"+s.image_256:"https://readymadeui.com/images/coffee1.webp"}`,alt:"product",className:"w-full h-full object-contain"})}),e.jsx("div",{className:"flex-1 flex flex-col",children:e.jsx("p",{className:"font-medium text-[15px] text-qblack",children:s.name})})]})}),e.jsx("td",{className:"text-center py-4 px-2",children:e.jsx("div",{className:"flex space-x-1 items-center justify-center",children:e.jsxs("span",{className:"text-[15px] font-normal",children:[" ",E(s.creditorder_price)]})})}),e.jsx("td",{className:" py-4",children:e.jsx("div",{className:"flex justify-center items-center",children:e.jsx(De,{produit:s})})}),e.jsx("td",{className:"text-right py-4",children:e.jsx("div",{className:"flex space-x-1 items-center justify-center",children:e.jsxs("span",{className:"text-[15px] font-normal",children:[" ",E(s.creditorder_price*s.quantity)]})})}),e.jsx("td",{className:"text-right py-4",children:e.jsx("div",{className:"flex space-x-1 items-center justify-center",children:e.jsx("button",{onClick:u=>g(u,s),className:"duration-200 hover:scale-150",children:e.jsx(fe,{className:"hover:text-red-500"})})})})]},j))]})})}),e.jsx("div",{className:" mt-3 transition-all duration-300 ease-in-out bg-gray-200 text-[15px]  rounded-lg font-medium text-black  text-center py-2",children:"Livraison gratuite sur Dakar"})]})}function Oe({cartt:i=!0}){const o=je(),{creditOrder:d,getCreditOrderTotal:M,clearCreditOrder:g}=l.useContext(Z),{user:s,parent:j}=Ne();console.log(s),console.log("user");const[u,H]=l.useState("direct"),J=u==="finance",[A,re]=l.useState(50),[$,ne]=l.useState(4),le=[30,40,50,60,70,80,90,100],[q,ie]=l.useState([]),[w,Q]=l.useState(!1),[I,U]=l.useState(""),[P,B]=l.useState(""),[f,O]=l.useState(""),C=l.useMemo(()=>u==="finance"?q.filter(t=>t.type_partner==="banque"):q.filter(t=>t.type_partner!=="banque"),[q,u]),N=l.useMemo(()=>q.filter(t=>t.type_partner==="banque"),[q]),[r,h]=l.useState({nom:s&&s.nom||"",prenom:s&&s.prenom||"",dateNaissance:s&&s.date_naissance||"",lieuNaissance:s&&s.lieu_naissance||"",telephone:s&&(s.telephone||s.partner_phone||s.phone||s.whatsapp_number)||"",email:s&&s.email||"",cniNumber:s&&s.cni_number||"",profession:s&&s.profession||"",rib:s&&s.rib||"",adresse:s&&s.adresse||"",adresseEmployeur:s&&(s.adresse_employeur||s.employer_partner_adresse)||"",employeur:s&&(s.employer_name||s.employer_partner_name)||"",institution_partner_id:s&&s.institution_partner_id||"",institution_id:s&&s.institution_partner_id||"",employer_partner_id:s&&s.employer_partner_id||"",employer_partner_name:s&&s.employer_partner_name||"",employer_partner_email:s&&s.employer_partner_email||"",employer_partner_phone:s&&s.employer_partner_phone||"",employer_partner_adresse:s&&s.employer_partner_adresse||"",salary_monthly:s&&s.salary_monthly||"",kyc_id_number:s&&s.kyc_id_number||"",notes:"",kyc_id_type:"",kyc_id_expiry:"",whatsapp_number:s&&s.whatsapp_number||"",preferred_contact_channel:"",job_title:s&&s.function||""}),[F,oe]=l.useState({salarySlips:[],bankStatements:[]}),[S,L]=l.useState(!1),z=l.useRef(null),m=M()||0,W=l.useMemo(()=>{const a=m/1.18;return m-a},[m]),G=l.useMemo(()=>{if(u!=="direct")return[];if(!m)return[];const t=Math.min(100,Math.max(30,A||30)),a=Math.min(5,Math.max(1,$||1));if(t===100||a===1)return[{label:"Paiement unique",amount:m,dueAt:new Date}];const n=m*t/100,b=Math.max(0,m-n),c=a-1,k=b/c,D=Math.round(k*100)/100,_=[];_.push({label:`Acompte (${t}%)`,amount:Math.round(n*100)/100,dueAt:new Date});let v=0;for(let T=1;T<=c;T++){const V=new Date;V.setMonth(V.getMonth()+T);const Y=T<c?D:Math.round((b-v)*100)/100;v=Math.round((v+Y)*100)/100,_.push({label:`Mensualité ${T}/${c}`,amount:Y,dueAt:V})}return _},[u,m,A,$]);l.useEffect(()=>{(async()=>{Q(!0),U("");try{const a=await ke();console.log(a);const n=Array.isArray(a)?a:a&&a.data||[];ie(n)}catch(a){U("Impossible de charger la liste des entreprises.")}finally{Q(!1)}})()},[]),l.useEffect(()=>{B(""),O("")},[u]),l.useEffect(()=>{s!=null&&s.parent_id&&C&&C.length&&!P&&C.find(a=>String(a.id)===String(s.parent_id))&&B(String(s.parent_id))},[s==null?void 0:s.parent_id,C,P]),l.useEffect(()=>{s!=null&&s.institution_partner_id&&N&&N.length&&!f&&N.find(a=>String(a.id)===String(s.institution_partner_id))&&O(String(s.institution_partner_id))},[s==null?void 0:s.institution_partner_id,N,f]),l.useEffect(()=>{s&&h(t=>x(p({},t),{nom:t.nom||s.nom||"",prenom:t.prenom||s.prenom||"",dateNaissance:t.dateNaissance||s.date_naissance||"",lieuNaissance:t.lieuNaissance||s.lieu_naissance||"",telephone:t.telephone||s.telephone||s.partner_phone||s.phone||s.whatsapp_number||"",email:t.email||s.email||"",cniNumber:t.cniNumber||s.cni_number||"",profession:t.profession||s.profession||"",rib:t.rib||s.rib||"",adresse:t.adresse||s.adresse||"",adresseEmployeur:t.adresseEmployeur||s.adresse_employeur||s.employer_partner_adresse||"",employeur:t.employeur||s.employer_name||s.employer_partner_name||"",institution_partner_id:t.institution_partner_id||s.institution_partner_id||"",institution_id:t.institution_id||s.institution_partner_id||"",employer_partner_id:t.employer_partner_id||s.employer_partner_id||"",employer_partner_name:t.employer_partner_name||s.employer_partner_name||"",employer_partner_email:t.employer_partner_email||s.employer_partner_email||"",employer_partner_phone:t.employer_partner_phone||s.employer_partner_phone||"",employer_partner_adresse:t.employer_partner_adresse||s.employer_partner_adresse||"",job_title:t.job_title||s.function||"",whatsapp_number:t.whatsapp_number||s.whatsapp_number||""}))},[s]);const K=(t,a)=>{const n=Array.from(t||[]),b=n.filter(c=>c.type==="application/pdf");n.length!==b.length&&y.warning("Seuls les fichiers PDF sont acceptés.",{position:"top-center",autoClose:3e3}),oe(c=>x(p({},c),{[a]:b.slice(0,3)}))},X=()=>s?d&&d.length?u==="direct"&&!P?(y.dismiss(),y.error("Veuillez sélectionner votre entreprise.",{position:"top-center",autoClose:5e3}),z.current&&z.current.focus(),!1):!0:(y.dismiss(),y.error("Veuillez ajouter au moins un article dans votre panier",{position:"top-center",autoClose:5e3}),!1):(y.dismiss(),y.warning("Merci de vous connecter",{position:"top-center",autoClose:5e3}),o("/login"),!1),ce=async()=>{if(X()){L(!0);try{const t=Math.min(100,Math.max(30,A)),a=t===100?1:Math.min(5,Math.max(1,$)),n={partner_id:s.id,parent_id:j&&j.id,company_id:parseInt(P),type_sale:"creditorder",type_credit:"direct",payment_mode:"online",state:"draft",commitment_date:new Date,acomptePercentage:t,nombreMois:a,order_lines:d.map(c=>({id:c.id,quantity:c.quantity,list_price:c.creditorder_price||c.list_price})),echeancier_prevu:G.map(c=>({label:c.label,amount:c.amount,dueAt:c.dueAt}))};console.log(n);const b=await R(n);y.success("Votre commande à crédit direct a été créée avec succès",{position:"top-center",autoClose:5e3}),setTimeout(()=>{o(`/credit-commandes/${b.id}/détails`,{state:{commande:b}})},600),g()}catch(t){y.error(t&&t.response&&t.response.data&&t.response.data.message||"Commande crédit direct non validée",{position:"top-center",autoClose:5e3})}finally{L(!1)}}},de=async()=>{if(!X())return;if(!r.nom||!r.prenom||!r.dateNaissance||!r.lieuNaissance||!r.telephone||!r.email||!r.cniNumber||!r.profession||!r.rib||!r.adresse||!r.adresseEmployeur||!r.employeur||!f){y.error("Veuillez remplir tous les champs obligatoires.",{position:"top-center"});return}if(!/^[A-Z0-9]{23}$/.test(r.rib)){y.error("Le RIB doit contenir exactement 23 caractères (chiffres et lettres).",{position:"top-center"});return}L(!0);const t=N.find(n=>String(n.id)===String(f)),a={partner_id:s.id,parent_id:j==null?void 0:j.id,company_id:f?parseInt(f):null,type_sale:"creditorder",type_credit:"banque",payment_mode:"online",state:"draft",commitment_date:new Date().toISOString(),order_lines:d.map(n=>({id:n.id,quantity:n.quantity,list_price:n.creditorder_price||n.list_price})),bank_dossier:{nom:r.nom,prenom:r.prenom,dateNaissance:r.dateNaissance,lieuNaissance:r.lieuNaissance,telephone:r.telephone,email:r.email,cniNumber:r.cniNumber,profession:r.profession,rib:r.rib,adresse:r.adresse,adresseDomicile:r.adresse,adresseEmployeur:r.adresseEmployeur,employeur:r.employeur.trim(),institution:(t==null?void 0:t.name)||(t==null?void 0:t.raison_sociale)||(t==null?void 0:t.nom)||"",institution_id:f?parseInt(f):null,institution_partner_id:r.institution_partner_id||(f?parseInt(f):null),employer_partner_id:r.employer_partner_id||null,employer_partner_name:r.employer_partner_name||r.employeur||null,employer_partner_email:r.employer_partner_email||null,employer_partner_phone:r.employer_partner_phone||null,employer_partner_adresse:r.employer_partner_adresse||r.adresseEmployeur||null}};console.log(a),console.log(JSON.stringify(a));try{const{salarySlips:n,bankStatements:b}=F,c=n&&n.length||b&&b.length;let k;if(!c)k=await R(a);else{const D=new FormData;D.append("payload",JSON.stringify(a)),(n||[]).forEach((_,v)=>{D.append(`bulletin_salaire_${v+1}`,_)}),(b||[]).forEach((_,v)=>{D.append(`releve_bancaire_${v+1}`,_)}),k=await R(D)}y.success("Votre demande de financement a été soumise pour validation.",{position:"top-center",autoClose:5e3}),setTimeout(()=>{o(`/credit-commandes/${k.id}/détails`,{state:{commande:k}})},600),g()}catch(n){y.error(n&&n.response&&n.response.data&&n.response.data.message||"Soumission financement non effectuée",{position:"top-center",autoClose:5e3})}finally{L(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(_e,{title:"CCBM Shop | Panier crédit",description:"Choisissez le type de crédit (direct ou financement), sélectionnez votre entreprise, configurez votre plan ou remplissez le dossier, puis validez.",keywords:"électroménager, CCBM Shop, crédit, acompte, mensualités, banque, financement"}),e.jsxs(ve,{childrenClasses:i?"pt-0 pb-0":"",children:[i===!1?e.jsx("div",{className:"cart-page-wrapper w-full",children:e.jsx("div",{className:"container-x mx-auto",children:e.jsx(we,{paths:[{name:"Accueil",path:"/"},{name:"Panier crédit",path:"/credit-cart"}]})})}):e.jsxs("div",{className:"cart-page-wrapper w-full bg-white pb-[60px]",children:[e.jsx("div",{className:"w-full",children:e.jsx(Ce,{title:"Panier crédit",breadcrumb:[{name:"Accueil",path:"/"},{name:"Panier crédit",path:"/credit-cart"}]})}),e.jsx("div",{className:"w-full mt-[23px]",children:e.jsxs("div",{className:"container-x mx-auto",children:[e.jsx(Ee,{className:"mb-[30px]"}),e.jsx("div",{className:"w-full sm:flex justify-between",children:e.jsx("div",{className:"flex space-x-2.5 items-center",children:e.jsx(ge,{to:"/boutique",children:e.jsx("div",{className:"w-[220px] h-[50px] bg-[#F6F6F6] flex justify-center items-center",children:e.jsx("span",{className:"text-sm font-semibold",children:"Continuer vos achats"})})})})}),e.jsx("div",{className:`w-full mt-[30px] ${J?"":"flex sm:justify-end"}`,children:e.jsxs("div",{className:`${J?"w-full max-w-none":"sm:w-[420px] w-full"} border border-[#EDEDED] px-[20px] sm:px-[30px] py-[20px] sm:py-[26px] rounded-md`,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm text-gray-700 mb-2",children:"Type de crédit"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsxs("label",{className:"inline-flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"type_credit",value:"direct",checked:u==="direct",onChange:()=>H("direct")}),e.jsx("span",{children:"Crédit direct"})]}),e.jsxs("label",{className:"inline-flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"type_credit",value:"finance",checked:u==="finance",onChange:()=>H("finance")}),e.jsx("span",{children:"Paiement par financement"})]})]})]}),m>0&&u==="direct"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"block text-sm text-gray-700 mb-1",children:["Votre entreprise ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{ref:z,className:"w-full border rounded p-2",value:P,onChange:t=>B(t.target.value),disabled:w,children:[e.jsx("option",{value:"",children:"-- Sélectionnez votre entreprise --"}),C.map(t=>e.jsx("option",{value:t.id,children:t.name||t.raison_sociale||t.nom},t.id))]}),w&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Chargement des entreprises…"}),I&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:I}),C.length===0&&!w&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Aucune entreprise disponible."})]}),e.jsxs("div",{className:"space-y-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Acompte"}),e.jsx("select",{className:"w-full border rounded p-2",value:A,onChange:t=>re(Number(t.target.value)),children:le.map(t=>e.jsxs("option",{value:t,children:[t,"%"]},t))}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Minimum 30%. 100% = paiement en une fois."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Nombre de paiements (mois)"}),e.jsx("select",{className:"w-full border rounded p-2",value:$,onChange:t=>ne(Number(t.target.value)),disabled:A===100,children:[1,2,3,4,5].map(t=>e.jsx("option",{value:t,children:t},t))}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Maximum 5 mensualités."})]})]}),e.jsx("div",{className:"border-t pt-4 space-y-2",children:G.map((t,a)=>e.jsxs("dl",{className:"flex flex-wrap items-center justify-between gap-2",children:[e.jsxs("dt",{className:"text-sm text-gray-500",children:[t.label,t.dueAt&&e.jsxs("span",{className:"ml-2 text-xs text-gray-400",children:["(échéance: ",new Date(t.dueAt).toLocaleDateString(),")"]})]}),e.jsx("dd",{className:"text-sm sm:text-base font-medium text-gray-900",children:E(t.amount)})]},`${t.label}-${a}`))}),e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-[15px] text-gray-600",children:"Sous-total (hors TVA)"}),e.jsx("span",{className:"text-[15px] font-medium",children:E(m-W)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-[15px] text-gray-600",children:"TVA (18%)"}),e.jsx("span",{className:"text-[15px] font-medium",children:E(W)})]}),e.jsxs("div",{className:"flex justify-between border-t pt-2",children:[e.jsx("span",{className:"text-[16px] font-semibold text-gray-800",children:"Total commande (TTC)"}),e.jsx("span",{className:"text-[16px] font-semibold",children:E(m)})]})]}),e.jsx("br",{}),e.jsxs(se,{type:"button",className:"hover:bg-red-500 w-full bg-bleu-logo",onClick:ce,disabled:S||m<=0,children:[S&&e.jsx(ae,{className:"mr-2 h-4 w-4 animate-spin"}),S?"Veuillez patienter...":"Valider le panier (crédit direct)"]})]}),m>0&&u==="finance"&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"mt-6 border-t pt-4 space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Informations personnelles"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Champs requis pour le dossier de financement"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-gray-600 mb-1",children:["Nom ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",className:"w-full border rounded p-2",value:r.nom,onChange:t=>h(a=>x(p({},a),{nom:t.target.value}))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-gray-600 mb-1",children:["Prénom ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",className:"w-full border rounded p-2",value:r.prenom,onChange:t=>h(a=>x(p({},a),{prenom:t.target.value}))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-gray-600 mb-1",children:["Date de naissance ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"date",className:"w-full border rounded p-2",value:r.dateNaissance,onChange:t=>h(a=>x(p({},a),{dateNaissance:t.target.value}))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-gray-600 mb-1",children:["Lieu de naissance ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",className:"w-full border rounded p-2",value:r.lieuNaissance,onChange:t=>h(a=>x(p({},a),{lieuNaissance:t.target.value}))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-gray-600 mb-1",children:["Téléphone ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"tel",className:"w-full border rounded p-2",value:r.telephone,onChange:t=>h(a=>x(p({},a),{telephone:t.target.value}))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-gray-600 mb-1",children:["Email ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"email",className:"w-full border rounded p-2",value:r.email,onChange:t=>h(a=>x(p({},a),{email:t.target.value}))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-gray-600 mb-1",children:["Numéro CNI ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",className:"w-full border rounded p-2",value:r.cniNumber,onChange:t=>h(a=>x(p({},a),{cniNumber:t.target.value}))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-gray-600 mb-1",children:["Adresse domicile ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",className:"w-full border rounded p-2",value:r.adresse,onChange:t=>h(a=>x(p({},a),{adresse:t.target.value}))})]})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Informations employeur"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-gray-600 mb-1",children:["Profession ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",className:"w-full border rounded p-2",value:r.profession,onChange:t=>h(a=>x(p({},a),{profession:t.target.value}))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-gray-600 mb-1",children:["Employeur ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",className:"w-full border rounded p-2",value:r.employeur,onChange:t=>h(a=>x(p({},a),{employeur:t.target.value})),placeholder:"Saisissez le nom de votre employeur"})]}),e.jsxs("div",{className:"lg:col-span-2",children:[e.jsxs("label",{className:"block text-sm text-gray-600 mb-1",children:["Adresse employeur ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",className:"w-full border rounded p-2",value:r.adresseEmployeur,onChange:t=>h(a=>x(p({},a),{adresseEmployeur:t.target.value}))})]})]})]}),e.jsxs("div",{className:"border-t pt-4 space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Informations bancaires & pièces jointes"}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"block text-sm text-gray-700 mb-1",children:["Institution ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{ref:z,className:"w-full border rounded p-2",value:f,onChange:t=>O(t.target.value),disabled:w,children:[e.jsx("option",{value:"",children:"-- Sélectionnez votre institution --"}),N.map(t=>e.jsx("option",{value:t.id,children:t.name||t.raison_sociale||t.nom},t.id))]}),w&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Chargement des institutions…"}),I&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:I}),N.length===0&&!w&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Aucune institution disponible."})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"rib",className:"block text-sm text-gray-600 mb-1",children:["Numéro de compte bancaire ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{id:"rib",type:"text",minLength:10,maxLength:25,className:"w-full border rounded p-2 uppercase",value:r.rib,onChange:t=>{const a=t.target.value.replace(/[^A-Z0-9]/g,"").toUpperCase();h(n=>x(p({},n),{rib:a}))}}),r.rib&&!/^[A-Z0-9]{10,25}$/.test(r.rib)&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:"Le numéro de compte bancaire doit contenir entre 10 et 25 caractères (chiffres et lettres)."})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Bulletins de salaire (PDF) - optionnel"}),e.jsx("input",{type:"file",accept:"application/pdf",multiple:!0,className:"w-full border rounded p-2",onChange:t=>K(t.target.files,"salarySlips")}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"PDF uniquement - max 3 fichiers."}),!!F.salarySlips.length&&e.jsx("ul",{className:"text-xs text-gray-700 list-disc ml-4 mt-1 space-y-1",children:F.salarySlips.map((t,a)=>e.jsx("li",{children:t.name},`${t.name}-${a}`))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Relevés bancaires (PDF) - optionnel"}),e.jsx("input",{type:"file",accept:"application/pdf",multiple:!0,className:"w-full border rounded p-2",onChange:t=>K(t.target.files,"bankStatements")}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"PDF uniquement - max 3 fichiers."}),!!F.bankStatements.length&&e.jsx("ul",{className:"text-xs text-gray-700 list-disc ml-4 mt-1 space-y-1",children:F.bankStatements.map((t,a)=>e.jsx("li",{children:t.name},`${t.name}-${a}`))})]})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Les pièces jointes sont optionnelles. Si vous en ajoutez, elles seront envoyées avec votre demande."})]}),e.jsxs(se,{type:"button",className:"hover:bg-red-500 w-full bg-bleu-logo mt-4",onClick:de,disabled:S||m<=0,children:[S&&e.jsx(ae,{className:"mr-2 h-4 w-4 animate-spin"}),S?"Veuillez patienter...":"Soumettre le dossier (Financement)"]}),e.jsx("p",{className:"text-sm text-gray-600 text-center mt-2",children:"Une fois le dossier envoyé, merci de passer au showroom pour récupérer le formulaire à remplir et signer."})]})}),m<=0&&e.jsx("p",{className:"text-sm text-gray-500",children:"Votre panier est vide. Ajoutez des articles pour configurer votre crédit."})]})})]})})]}),e.jsx(Se,{})]})]})}export{Oe as default};

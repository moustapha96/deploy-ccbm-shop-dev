{"version":3,"file":"wave-orange-payment-service-C4C_1TvlryCMCsUR.js","sources":["../../../orbit-city-final-dev/src/assets/wave-image.png","../../../orbit-city-final-dev/src/assets/om-image.png","../../../orbit-city-final-dev/src/services/Payment/wave-orange-payment-service.jsx"],"sourcesContent":["export default \"__VITE_ASSET__DzRzSpt1__\"","export default \"__VITE_ASSET__DbGpZqAG__\"","\r\n/* eslint-disable react/prop-types */\r\n/* eslint-disable no-unused-vars */\r\n\"use client\";\r\n\r\nimport { useContext, useEffect, useRef, useState } from \"react\";\r\nimport { Button, Modal } from \"flowbite-react\";\r\nimport { CircleX, Loader2, Smartphone, ExternalLink } from \"lucide-react\";\r\nimport { toast } from \"react-toastify\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport PaymentContext from \"../../contexts/PaymentContext\";\r\nimport PaiementService from \"../paimentService\";\r\nimport { trackPurchase } from \"../../utils/tracking\";\r\nimport { useAuthContext } from \"../../contexts/useAuthContext\";\r\nimport formatPrice from \"../../utils/formatPrice\";\r\nimport MobileMoneyService from \"./mobile-money-service\";\r\nimport waveImage from \"../../assets/wave-image.png\";\r\nimport omImage from \"../../assets/om-image.png\";\r\n\r\n// ---------- Utils ----------\r\nconst SN_PREFIXES = [\"70\", \"75\", \"76\", \"77\", \"78\"];\r\nconst normalizeSnPhone = (raw) => {\r\n  if (!raw) return \"\";\r\n  let p = String(raw).replace(/[^\\d]+/g, \"\");\r\n  if (p.startsWith(\"00221\")) p = p.slice(5);\r\n  else if (p.startsWith(\"221\")) p = p.slice(3);\r\n  else if (p.startsWith(\"0\")) p = p.slice(1);\r\n  if (p.length === 9 && SN_PREFIXES.includes(p.slice(0, 2))) return `221${p}`;\r\n  if (p.length === 12 && p.startsWith(\"221\")) return p;\r\n  return p;\r\n};\r\nconst isValidSnMsisdn = (msisdn) => /^221(70|75|76|77|78)\\d{7}$/.test(msisdn);\r\nconst makeReference = (prefix = \"REF\") =>\r\n  `${prefix}-${Date.now()}-${Math.random().toString(36).slice(2, 8).toUpperCase()}`;\r\nconst makeTransactionId = (userId, idOrder, total, name, type) =>\r\n  [userId, idOrder, total, name, type, Date.now()].filter(Boolean).join(\"-\");\r\n\r\nconst isMobile = () =>\r\n  typeof navigator !== \"undefined\" &&\r\n  /Android|iPhone|iPad|iPod|IEMobile|Opera Mini/i.test(navigator.userAgent);\r\n\r\n// ---------- Component ----------\r\nconst WaveOrangePaymentService = ({ handlePay, totalAmount, onClose, order, idOrder }) => {\r\n  // Assainir localStorage (on démarre propre)\r\n  useEffect(() => {\r\n    localStorage.setItem(\"idOrderPayment\", \"\");\r\n    localStorage.setItem(\"montant\", \"\");\r\n    localStorage.setItem(\"tokenOrderPayment\", \"\");\r\n    localStorage.setItem(\"statusOrderPayment\", \"\");\r\n    localStorage.setItem(\"idDataPayment\", \"\");\r\n    localStorage.setItem(\"mm_transaction_id\", \"\");\r\n    localStorage.setItem(\"mm_method\", \"\");\r\n  }, []);\r\n\r\n  const navigate = useNavigate();\r\n  const { setUserPayment, setOrder } = useContext(PaymentContext);\r\n  const { user, token } = useAuthContext();\r\n\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [openModal, setOpenModal] = useState(true);\r\n  const [selectedPaymentMethod, setSelectedPaymentMethod] = useState(\"\"); // \"wave\" | \"orange\"\r\n  const [phoneNumber, setPhoneNumber] = useState(\"\");\r\n  const [paymentInitiated, setPaymentInitiated] = useState(false);\r\n  const [paymentReference, setPaymentReference] = useState(\"\");\r\n  const [transactionId, setTransactionId] = useState(\"\");\r\n  const [polling, setPolling] = useState(false);\r\n\r\n  // Nouveaux états pour l’UX mobile/desktop\r\n  const [qrCodeBase64, setQrCodeBase64] = useState(null); // OM desktop/tablette\r\n  const [deepLinkUrl, setDeepLinkUrl] = useState(null);   // OM mobile\r\n  const [wavePaymentUrl, setWavePaymentUrl] = useState(null); // Wave mobile/desktop\r\n\r\n  const pollRef = useRef(null);\r\n  const pollTimeoutRef = useRef(null);\r\n\r\n  useEffect(() => {\r\n    if (setUserPayment) setUserPayment(user);\r\n    if (setOrder) setOrder(order);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    return () => {\r\n      if (pollRef.current) clearInterval(pollRef.current);\r\n      if (pollTimeoutRef.current) clearTimeout(pollTimeoutRef.current);\r\n    };\r\n  }, []);\r\n\r\n  const validatePhoneNumber = (number) => isValidSnMsisdn(normalizeSnPhone(number));\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n\r\n    if (!selectedPaymentMethod) {\r\n      toast.error(\"Veuillez sélectionner une méthode de paiement\", { position: \"top-center\", autoClose: 3000 });\r\n      return;\r\n    }\r\n    if (!phoneNumber) {\r\n      toast.error(\"Veuillez entrer votre numéro de téléphone\", { position: \"top-center\", autoClose: 3000 });\r\n      return;\r\n    }\r\n    const msisdn = normalizeSnPhone(phoneNumber);\r\n    if (!validatePhoneNumber(msisdn)) {\r\n      toast.error(`Numéro invalide. Utilisez 77/78/76/75/70 au format 221771234567`, {\r\n        position: \"top-center\",\r\n        autoClose: 4000,\r\n      });\r\n      return;\r\n    }\r\n\r\n    setIsLoading(true);\r\n    try {\r\n      // tracking\r\n      trackPurchase(\r\n        idOrder,\r\n        totalAmount,\r\n        ((order && order.order_lines) || []).map((item) => ({\r\n          name: item.product_name,\r\n          price: item.price_unit,\r\n          quantity: item.product_uom_qty,\r\n        }))\r\n      );\r\n\r\n      const customTransactionId = makeTransactionId(\r\n        (user && user.id),\r\n        idOrder,\r\n        Math.ceil(totalAmount),\r\n        (order && order.name),\r\n        (order && order.type_sale)\r\n      );\r\n      const reference = makeReference(selectedPaymentMethod === \"wave\" ? \"WAV\" : \"OM\");\r\n      setPaymentReference(reference);\r\n\r\n      const successUrl =\r\n        selectedPaymentMethod === \"wave\"\r\n          ? `${window.location.origin}/wave-paiement?transaction=${encodeURIComponent(customTransactionId)}`\r\n          : `${window.location.origin}/om-paiement?transaction=${encodeURIComponent(customTransactionId)}`;\r\n\r\n      // INITIATE vers Odoo (aligné sur tes contrôleurs)\r\n      const initRes = await MobileMoneyService.initiatePayment(selectedPaymentMethod, {\r\n        transaction_id: customTransactionId,\r\n        order_id: idOrder,\r\n        partner_id: (user && user.id),\r\n        phoneNumber: msisdn,\r\n        amount: Math.ceil(totalAmount),\r\n        description: `${(order && order.name) || \"Commande\"} - ${idOrder}`,\r\n        reference,\r\n        success_url: successUrl,\r\n      });\r\n\r\n      // Persistance côté front (suivi)\r\n      const payload = {\r\n        transaction_id: customTransactionId,\r\n        amount: Math.ceil(totalAmount),\r\n        order_id: idOrder,\r\n        order_type: (order && order.type_sale),\r\n        order_name: (order && order.name),\r\n        partner_id: (user && user.id),\r\n        payment_token: reference,\r\n        payment_state: \"pending\",\r\n        payment_method: selectedPaymentMethod,\r\n        customer_phone: msisdn,\r\n        provider_status: (initRes && initRes.status) || \"pending\",\r\n      };\r\n\r\n      localStorage.setItem(\"idOrderPayment\", String(idOrder));\r\n      localStorage.setItem(\"montant\", String(Math.ceil(totalAmount)));\r\n      localStorage.setItem(\"tokenOrderPayment\", reference);\r\n      localStorage.setItem(\"statusOrderPayment\", \"pending\");\r\n      localStorage.setItem(\"mm_transaction_id\", customTransactionId);\r\n      localStorage.setItem(\"mm_method\", selectedPaymentMethod);\r\n\r\n      setTransactionId(customTransactionId);\r\n      setPaymentInitiated(true);\r\n\r\n      // === Spécifique méthode & device ===\r\n      const onMobile = isMobile();\r\n\r\n      if (selectedPaymentMethod === \"orange\") {\r\n        // Backend OM peut renvoyer: qr_code_base64 (pour desktop), deep_link_maxit (pour mobile)\r\n        const qr = (initRes && initRes.qr_code_base64);           \r\n        const deep = (initRes && initRes.deep_link_maxit) || (initRes && initRes.deep_link) || (initRes && initRes.short_link);\r\n\r\n        if (onMobile && deep) {\r\n          setDeepLinkUrl(deep);\r\n          // Redirection immédiate vers l’app OM\r\n          window.location.href = deep;\r\n        } else if (qr) {\r\n          // On affiche le QR en base64 (préfixer si nécessaire)\r\n          const dataUrl = qr.startsWith(\"data:image\") ? qr : `data:image/png;base64,${qr}`;\r\n          setQrCodeBase64(dataUrl);\r\n        }\r\n      }\r\n\r\n      if (selectedPaymentMethod === \"wave\") {\r\n        const purl = (initRes && initRes.payment_url) || (initRes && initRes.deep_link) || (initRes && initRes.short_link);\r\n        if (purl) {\r\n          setWavePaymentUrl(purl);\r\n          if (onMobile) {\r\n            // Ouvrir directement l’app Wave\r\n            window.location.href = purl;\r\n          } else {\r\n            // Desktop: ouvrir dans un nouvel onglet\r\n            window.open(purl, \"_blank\", \"noopener,noreferrer\");\r\n          }\r\n        }\r\n      }\r\n\r\n      toast.success(\r\n        `Demande envoyée via ${selectedPaymentMethod === \"wave\" ? \"Wave\" : \"Orange Money\"}. Validez sur votre téléphone.`,\r\n        { position: \"top-center\", autoClose: 5000 }\r\n      );\r\n\r\n      startPolling(customTransactionId, selectedPaymentMethod);\r\n    } catch (err) {\r\n      console.error(err);\r\n      toast.error(`Erreur lors du paiement: ${(err && err.message) || \"échec inconnu\"}`, {\r\n        position: \"top-center\",\r\n        autoClose: 5000,\r\n      });\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const startPolling = (txId, method) => {\r\n    if (pollRef.current) clearInterval(pollRef.current);\r\n    if (pollTimeoutRef.current) clearTimeout(pollTimeoutRef.current);\r\n\r\n    setPolling(true);\r\n    // Ping status toutes les 4s pendant 2 minutes\r\n    pollRef.current = setInterval(async () => {\r\n      try {\r\n        const res = await MobileMoneyService.verifyPayment(method, txId);\r\n        const status = String((res && res.status) || (res && res.transaction && res.transaction.status) || \"\").toLowerCase();\r\n\r\n        if ([\"completed\", \"success\", \"succeeded\"].includes(status)) {\r\n          await handlePaymentSuccess();\r\n        } else if ([\"failed\", \"canceled\", \"cancelled\", \"rejected\", \"expired\"].includes(status)) {\r\n          await handlePaymentFailure((res && res.reason) || `Paiement ${status}`);\r\n        }\r\n      } catch (err) {\r\n        console.warn(\"Polling error:\", (err && err.message));\r\n      }\r\n    }, 4000);\r\n\r\n    // stop après 120s\r\n    pollTimeoutRef.current = setTimeout(() => {\r\n      stopPolling();\r\n      toast.info(\"Toujours en attente de confirmation… Vous pouvez relancer la vérification.\", {\r\n        position: \"top-center\",\r\n      });\r\n    }, 120000);\r\n  };\r\n\r\n  const stopPolling = () => {\r\n    if (pollRef.current) clearInterval(pollRef.current);\r\n    if (pollTimeoutRef.current) clearTimeout(pollTimeoutRef.current);\r\n    pollRef.current = null;\r\n    pollTimeoutRef.current = null;\r\n    setPolling(false);\r\n  };\r\n\r\n  const handlePaymentSuccess = async () => {\r\n    stopPolling();\r\n    try {\r\n      toast.success(\"Paiement confirmé avec succès !\", { position: \"top-center\", autoClose: 3000 });\r\n\r\n      if ((order && order.type_sale) === \"preorder\") {\r\n        navigate(`/pre-commandes/${idOrder}/détails`);\r\n      } else if ((order && order.type_sale) === \"creditorder\") {\r\n        navigate(`/credit-commandes/${idOrder}/détails`);\r\n      } else {\r\n        navigate(`/commandes/${idOrder}/détails`);\r\n      }\r\n      setOpenModal(false);\r\n    } catch (err) {\r\n      console.error(err);\r\n      toast.error(\"Paiement reçu mais échec de mise à jour locale.\", { position: \"top-center\" });\r\n    }\r\n  };\r\n\r\n  const handlePaymentFailure = async (reason) => {\r\n    stopPolling();\r\n    toast.error(`Paiement échoué: ${reason || \"Refusé par l'opérateur\"}`, {\r\n      position: \"top-center\",\r\n      autoClose: 5000,\r\n    });\r\n  };\r\n\r\n  const handleVerifyPayment = async () => {\r\n    const txId = transactionId || localStorage.getItem(\"mm_transaction_id\");\r\n    const method = selectedPaymentMethod || localStorage.getItem(\"mm_method\");\r\n    if (!txId || !method) return;\r\n\r\n    setIsLoading(true);\r\n    try {\r\n      const res = await MobileMoneyService.verifyPayment(method, txId);\r\n      const status = String((res && res.status) || (res && res.transaction && res.transaction.status) || \"\").toLowerCase();\r\n\r\n      if ([\"completed\", \"success\", \"succeeded\"].includes(status)) {\r\n        await handlePaymentSuccess();\r\n      } else if ([\"failed\", \"canceled\", \"cancelled\", \"rejected\", \"expired\"].includes(status)) {\r\n        await handlePaymentFailure((res && res.reason) || `Paiement ${status}`);\r\n      } else {\r\n        toast.warning(\"Toujours en attente de validation sur votre téléphone.\", {\r\n          position: \"top-center\",\r\n          autoClose: 4000,\r\n        });\r\n      }\r\n    } catch (err) {\r\n      toast.error(`Erreur lors de la vérification: ${(err && err.message) || \"inconnue\"}`, {\r\n        position: \"top-center\",\r\n        autoClose: 5000,\r\n      });\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleCancel = () => {\r\n    stopPolling();\r\n    setOpenModal(false);\r\n    if (onClose) onClose();\r\n  };\r\n\r\n  return (\r\n    <Modal size=\"xl\" className=\"h-auto\" show={openModal} popup onClose={onClose}>\r\n      <Modal.Header />\r\n      <Modal.Body>\r\n        <div className=\"fixed inset-0 p-4 flex flex-wrap justify-center items-center w-full h-full z-[1000] before:fixed before:inset-0 before:w-full before:h-full before:bg-[rgba(0,0,0,0.5)] overflow-auto font-[sans-serif]\">\r\n          <div className=\"w-full max-w-lg bg-white shadow-lg rounded-lg p-8 relative\">\r\n            <div className=\"flex items-start border-b border-gray-300 pb-4\">\r\n              <div className=\"flex-1\">\r\n                <h3 className=\"text-gray-800 text-xl font-bold\">\r\n                  Paiement{\" \"}\r\n                  {(order && order.type_sale) === \"order\"\r\n                    ? \"Commande\"\r\n                    : (order && order.type_sale) === \"preorder\"\r\n                    ? \"Pré-Commande\"\r\n                    : \"Commande à crédit\"}\r\n                </h3>\r\n                <p className=\"text-gray-600 text-sm mt-1\">Résumé détaillé de votre commande.</p>\r\n              </div>\r\n              <p>\r\n                <CircleX onClick={handleCancel} className=\"cursor-pointer hover:text-red-500 hover:scale-150 duration-300\" />\r\n              </p>\r\n            </div>\r\n\r\n            {order && (\r\n              <>\r\n                <div className=\"my-8\">\r\n                  <table className=\"w-full\">\r\n                    <thead>\r\n                      <tr>\r\n                        <th className=\"text-left text-gray-800 text-sm py-2\">Nom de la commande :</th>\r\n                        <th className=\"text-right text-gray-800 text-sm py-2\">{order.name}</th>\r\n                      </tr>\r\n                    </thead>\r\n                  </table>\r\n\r\n                  <table className=\"w-full\">\r\n                    <thead>\r\n                      <tr>\r\n                        <th className=\"text-left text-gray-800 text-sm py-2\">Nom produit</th>\r\n                        <th className=\"text-right text-gray-800 text-sm py-2\">Prix total</th>\r\n                      </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                      {(order.order_lines || []).map((article, idx) => (\r\n                        <tr key={idx}>\r\n                          <td className=\"text-left text-gray-800 text-sm py-2\">\r\n                            {article.product_name} ({article.product_uom_qty})\r\n                          </td>\r\n                          <td className=\"text-right text-gray-800 text-sm py-2 font-medium\">\r\n                            {formatPrice(article.price_total)}\r\n                          </td>\r\n                        </tr>\r\n                      ))}\r\n                    </tbody>\r\n                  </table>\r\n\r\n                  <table className=\"w-full\">\r\n                    <thead>\r\n                      <tr>\r\n                        <th className=\"text-left text-gray-800 text-sm py-2\">Total Commande (FCFA) :</th>\r\n                        <th className=\"text-right text-gray-800 text-sm py-2\">\r\n                          {formatPrice(Math.ceil(order.amount_total))}\r\n                        </th>\r\n                      </tr>\r\n                      <tr>\r\n                        <th className=\"text-left text-gray-800 text-sm py-2\">Montant à payer (FCFA) :</th>\r\n                        <th className=\"text-right text-gray-800 text-sm py-2\">\r\n                          {formatPrice(Math.ceil(totalAmount))}\r\n                        </th>\r\n                      </tr>\r\n                    </thead>\r\n                  </table>\r\n\r\n                  {/* Choix méthode */}\r\n                  {!paymentInitiated ? (\r\n                    <>\r\n                      <div className=\"mt-6 mb-4\">\r\n                        <h4 className=\"text-gray-800 font-medium mb-3\">Choisissez votre méthode de paiement</h4>\r\n                        <div className=\"flex space-x-4\">\r\n                          <div\r\n                            className={`flex-1 border rounded-lg p-4 cursor-pointer transition-all ${\r\n                              selectedPaymentMethod === \"wave\"\r\n                                ? \"border-blue-500 bg-blue-50\"\r\n                                : \"border-gray-300 hover:border-blue-300\"\r\n                            }`}\r\n                            onClick={() => setSelectedPaymentMethod(\"wave\")}\r\n                          >\r\n                            <div className=\"flex items-center justify-center mb-2\">\r\n                             <img src={waveImage}  width={100} alt=\"\" />\r\n                            </div>\r\n                          </div>\r\n\r\n                          <div\r\n                            className={`flex-1 border rounded-lg p-4 cursor-pointer transition-all ${\r\n                              selectedPaymentMethod === \"orange\"\r\n                                ? \"border-orange-500 bg-orange-50\"\r\n                                : \"border-gray-300 hover:border-orange-300\"\r\n                            }`}\r\n                            onClick={() => setSelectedPaymentMethod(\"orange\")}\r\n                          >\r\n                            <div className=\"flex items-center justify-center mb-2\">\r\n                             <img src={omImage}  width={100} alt=\"\" />\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n\r\n                      {selectedPaymentMethod && (\r\n                        <div className=\"mt-4 mb-6\">\r\n                          <label htmlFor=\"phone\" className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                            Numéro {selectedPaymentMethod === \"wave\" ? \"Wave\" : \"Orange Money\"}\r\n                          </label>\r\n                          <input\r\n                            type=\"tel\"\r\n                            id=\"phone\"\r\n                            value={phoneNumber}\r\n                            onChange={(e) => setPhoneNumber(e.target.value)}\r\n                            placeholder=\"77 123 45 67\"\r\n                            className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                          />\r\n                          <p className=\"text-xs text-gray-500 mt-1\">\r\n                            Utilisez un numéro sénégalais (ex: 221771234567). 77/78/76/75/70 acceptés.\r\n                          </p>\r\n                        </div>\r\n                      )}\r\n\r\n                      <div className=\"flex max-sm:flex-col items-center gap-4 mt-8\">\r\n                        <Button\r\n                          onClick={handleSubmit}\r\n                          disabled={isLoading || !selectedPaymentMethod || !phoneNumber}\r\n                          pill\r\n                          className=\"rounded-lg px-5 !bg-[#487a43]  py-2.5 font-medium w-full hover:bg-red-500 hover:text-white text-xl\"\r\n                        >\r\n                          {isLoading ? (\r\n                            <>\r\n                              <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\r\n                              <p>Traitement en cours...</p>\r\n                            </>\r\n                          ) : (\r\n                            \"Payer maintenant\"\r\n                          )}\r\n                        </Button>\r\n                      </div>\r\n                    </>\r\n                  ) : (\r\n                    <div className=\"mt-6 space-y-6\">\r\n                      {/* Info statut */}\r\n                      <div className=\"bg-yellow-50 border border-yellow-200 rounded-lg p-4\">\r\n                        <h4 className=\"text-yellow-800 font-medium mb-2\">Paiement en attente</h4>\r\n                        <p className=\"text-yellow-700 text-sm\">\r\n                          Vérifiez votre téléphone et confirmez le paiement.\r\n                        </p>\r\n                        <p className=\"text-yellow-700 text-sm mt-2\">\r\n                          Référence: <span className=\"font-medium\">{paymentReference}</span>\r\n                        </p>\r\n                      </div>\r\n\r\n                      {/* OM: QR code (desktop/tablette) + bouton deep link (fallback) */}\r\n                      {selectedPaymentMethod === \"orange\" && (\r\n                        <>\r\n                          {qrCodeBase64 && (\r\n                            <div className=\"flex flex-col items-center\">\r\n                              <img\r\n                                src={qrCodeBase64}\r\n                                alt=\"QR Orange Money\"\r\n                                className=\"w-60 h-60 object-contain border rounded-lg\"\r\n                              />\r\n                              <p className=\"text-xs text-gray-500 mt-2 text-center\">\r\n                                Scannez ce QR dans l’app Orange Money pour finaliser.\r\n                              </p>\r\n                            </div>\r\n                          )}\r\n                          {deepLinkUrl && (\r\n                            <Button\r\n                              onClick={() => (window.location.href = deepLinkUrl)}\r\n                              pill\r\n                              className=\"rounded-lg px-5 py-2.5 font-medium w-full bg-orange-600 hover:bg-orange-700 text-white\"\r\n                            >\r\n                              Ouvrir Orange Money <ExternalLink className=\"ml-2 inline h-4 w-4\" />\r\n                            </Button>\r\n                          )}\r\n                        </>\r\n                      )}\r\n\r\n                      {/* Wave: bouton pour rouvrir l’app/lien si besoin */}\r\n                      {selectedPaymentMethod === \"wave\" && wavePaymentUrl && (\r\n                        <Button\r\n                          onClick={() => (window.location.href = wavePaymentUrl)}\r\n                          pill\r\n                          className=\"rounded-lg px-5 py-2.5 font-medium w-full bg-blue-600 hover:bg-blue-700 text-white\"\r\n                        >\r\n                          Ouvrir Wave <ExternalLink className=\"ml-2 inline h-4 w-4\" />\r\n                        </Button>\r\n                      )}\r\n\r\n                      <div className=\"flex max-sm:flex-col items-center gap-4\">\r\n                        <Button\r\n                          onClick={handleVerifyPayment}\r\n                          disabled={isLoading || polling}\r\n                          pill\r\n                          className=\"rounded-lg px-5 py-2.5 font-medium w-full bg-green-600 hover:bg-green-700 text-white text-xl\"\r\n                        >\r\n                          {isLoading ? (\r\n                            <>\r\n                              <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\r\n                              <p>Vérification...</p>\r\n                            </>\r\n                          ) : polling ? (\r\n                            \"Vérification automatique en cours…\"\r\n                          ) : (\r\n                            \"Vérifier le paiement\"\r\n                          )}\r\n                        </Button>\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </Modal.Body>\r\n    </Modal>\r\n  );\r\n};\r\n\r\nexport default WaveOrangePaymentService;\r\n"],"names":["waveImage","omImage","SN_PREFIXES","normalizeSnPhone","raw","p","isValidSnMsisdn","msisdn","makeReference","prefix","makeTransactionId","userId","idOrder","total","name","type","isMobile","WaveOrangePaymentService","handlePay","totalAmount","onClose","order","useEffect","navigate","useNavigate","setUserPayment","setOrder","useContext","PaymentContext","user","token","useAuthContext","isLoading","setIsLoading","useState","openModal","setOpenModal","selectedPaymentMethod","setSelectedPaymentMethod","phoneNumber","setPhoneNumber","paymentInitiated","setPaymentInitiated","paymentReference","setPaymentReference","transactionId","setTransactionId","polling","setPolling","qrCodeBase64","setQrCodeBase64","deepLinkUrl","setDeepLinkUrl","wavePaymentUrl","setWavePaymentUrl","pollRef","useRef","pollTimeoutRef","validatePhoneNumber","number","handleSubmit","e","toast","trackPurchase","item","customTransactionId","reference","successUrl","initRes","MobileMoneyService","payload","onMobile","qr","deep","dataUrl","purl","startPolling","err","txId","method","res","status","handlePaymentSuccess","handlePaymentFailure","stopPolling","reason","handleVerifyPayment","handleCancel","jsxs","Modal","jsx","CircleX","Fragment","article","idx","formatPrice","Button","ExternalLink","Loader2"],"mappings":"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"}
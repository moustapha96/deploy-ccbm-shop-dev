import{j as e,P as v}from"./index-11e104e4.js";import{r as p,h as w,u as C}from"./vendor-04b9cdeb.js";import{B as P}from"./BreadcrumbCom-ee0c1c4b.js";import{P as S}from"./ProductCardStyleOne-a8cced1a.js";import{C as k,d as M,L}from"./Layout-9753cd17.js";import{d as q}from"./index-3cf74a0c.js";import{S as E}from"./SEOHeader-1741e749.js";import{C as F}from"./chevron-left-c4946a3b.js";import"./eye-cb69b36c.js";function $({volume:a,volumeHandler:r,className:n,filterToggle:d,handleCategoryChange:l,type:s=3}){const i=a.min<5e3?5e3:a.min,o=a.max>5e6?5e6:a.max;return e.jsx("div",{className:`filter-widget w-full fixed lg:relative left-0 top-0 h-screen z-10 lg:h-auto overflow-y-scroll lg:overflow-y-auto bg-white px-[30px] pt-[40px] ${n||""} ${d?"block":"hidden lg:block"}`,children:e.jsxs("div",{className:"filter-subject-item pb-10 border-b border-qgray-border mt-10",children:[e.jsx("div",{className:"subject-title mb-[30px]",children:e.jsx("h1",{className:"text-black text-base font-500",children:"Échelle des prix"})}),e.jsx("div",{className:"price-range mb-5",children:e.jsx(q,{value:[i,o],onInput:r,min:5e3,max:5e6})}),e.jsxs("p",{className:"text-xs text-qblack font-400",children:["Prix (FCFA): ",i," - ",o]})]})})}const I=({currentPage:a,totalPages:r,onPageChange:n})=>{const d=()=>{const s=[];for(let i=Math.max(2,a-2);i<=Math.min(r-1,a+2);i++)s.push(i);return a-2>2&&s.unshift("..."),a+2<r-1&&s.push("..."),s.unshift(1),r!==1&&s.push(r),s};return e.jsx("nav",{className:"flex justify-center items-center mt-8 px-4","aria-label":"Pagination",children:e.jsxs("ul",{className:"flex flex-wrap justify-center items-center space-x-1 md:space-x-2",children:[e.jsx("li",{children:e.jsx("button",{onClick:()=>n(Math.max(1,a-1)),disabled:a===1,className:"p-2 rounded-full bg-gray-200 text-gray-700 hover:bg-qyellow disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Previous page",children:e.jsx(F,{className:"w-5 h-5"})})}),d().map((l,s)=>e.jsx("li",{children:typeof l=="number"?e.jsx("button",{onClick:()=>n(l),className:`hidden sm:block px-3 py-2 rounded ${a===l?"bg-bleu-logo text-white":"bg-gray-200 text-gray-700 hover:bg-qyellow"}`,"aria-current":a===l?"page":void 0,children:l}):e.jsx("span",{className:"hidden sm:block px-3 py-2",children:l})},s)),e.jsx("li",{className:"sm:hidden",children:e.jsxs("span",{className:"px-3 py-2 text-gray-700",children:[a," / ",r]})}),e.jsx("li",{children:e.jsx("button",{onClick:()=>n(Math.min(r,a+1)),disabled:a===r,className:"p-2 rounded-full bg-gray-200 text-gray-700 hover:bg-qyellow disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Next page",children:e.jsx(k,{className:"w-5 h-5"})})})]})})},A=I;function _(){const{currentProductsPromo:a,totalProductsPromo:r,isLoadingProductPromo:n,fetchProdcutsPromo:d,updateFilters:l,filters:s,resetFilters:i}=p.useContext(v),o=w(),h=C();p.useEffect(()=>{i();const t=new URLSearchParams(o.search),c={page:Number.parseInt(t.get("page"))||1,category:t.get("category")||"All",search:t.get("search")||"",min:Number.parseInt(t.get("min"))||5e3,max:Number.parseInt(t.get("max"))||5e6,limit:9};l(c),console.log(s),window.scrollTo({top:0,left:100,behavior:"smooth"})},[o.search,o.pathname,i,l]),p.useEffect(()=>{d()},[d]);const g=t=>{m({...s,min:t[0],max:t[1],page:1})},f=t=>{m({...s,page:t})},j=t=>{const c=t.target.value;m({...s,search:c,page:1})},b=t=>{m({category:t||"All",page:1})},m=p.useCallback(t=>{const c=new URLSearchParams(o.search);Object.entries(t).forEach(([u,x])=>{x!=null&&x!==""?c.set(u,x.toString()):c.delete(u)}),h({search:c.toString()},{replace:!0})},[o.search,h]),y=(s.page-1)*s.limit+1,N=Math.min(s.page*s.limit,r);return e.jsxs(e.Fragment,{children:[e.jsx(E,{title:"CCBM Shop | En Promo",description:"Découvrez les meilleures offres promotionnelles sur CCBM Shop, votre destination privilégiée pour l'électroménager de qualité à prix réduits.",keywords:"électroménager, promotions, offres spéciales, CCBM Shop, ccbme, appareils électroménagers à prix réduits"}),e.jsx(M,{children:e.jsx("div",{className:"products-page-wrapper w-full",children:e.jsxs("div",{className:"container-x mx-auto",children:[e.jsx(P,{}),e.jsxs("div",{className:"w-full lg:flex lg:space-x-[30px]",children:[e.jsx("div",{className:"lg:w-[270px]",children:e.jsx($,{volume:[s.min,s.max],volumeHandler:g,handleCategoryChange:b})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"products-sorting w-full bg-white flex flex-col md:flex-row justify-between p-[30px] mb-[40px]",children:[e.jsxs("p",{className:"font-400 text-[13px]",children:[e.jsx("span",{className:"text-qgray",children:"Affichage"})," ",r>0?`${y}–${N} sur ${r} résultats`:"0 résultat"]}),e.jsx("input",{type:"search",placeholder:"Rechercher des produits en promo",value:s.search,onChange:j,className:"px-3 py-2 border border-gray-300 rounded-md"})]}),n?e.jsxs("div",{className:"flex justify-center items-center",children:[e.jsx(L,{className:"animate-spin"})," Chargement"]}):a.length===0?e.jsx("div",{className:"flex justify-center items-center",children:"Aucun produit en promotion trouvé"}):e.jsx("div",{className:"grid xl:grid-cols-3 sm:grid-cols-2 grid-cols-1 gap-[30px]",children:a.map(t=>e.jsx(S,{datas:t},t.id))}),e.jsx(A,{currentPage:s.page,totalPages:Math.ceil(r/s.limit),onPageChange:f})]})]})]})})})]})}export{_ as default};

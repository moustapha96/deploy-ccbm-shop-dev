import{u as k,j as e,i as F,k as D,y as q,L as p,f as a,z as E,T as M,t as S,l as C,A as T,B as L}from"./index.fafced5c.js";import{j as z,u as A,r}from"./vendor.af94f9e3.js";import{f}from"./date-format.d160e78b.js";import{P as B}from"./precommandeService.f227feb9.js";function G(){const{id:c}=z(),{user:h}=k();A();const[t,j]=r.useState(null),[m,d]=r.useState(!1),[y,R]=r.useState(0),[N,I]=r.useState(null),[v,o]=r.useState(!1),[n,g]=r.useState(0),[x,u]=r.useState(""),[b,_]=r.useState(!1);console.log(c),r.useEffect(()=>{let s=!0;return(async()=>{d(!0);try{const i=await B.getPreCommandeById(h.id,c);s&&(j(i),console.log(i))}catch(i){console.error("Erreur lors de la récupération des modèles",i)}finally{d(!1)}})(),()=>{s=!1}},[]),r.useEffect(()=>{if(t){const s=t.first_payment_state&&n<1e3||!t.first_payment_state&&n<t.first_payment_amount||m;_(s)}},[t,n,m]);const w=async(s,l)=>{s.preventDefault(),l<1e3?L.warning("Le Montant doit être strictement supérieur à 1000 F CFA",{position:"top-center",autoClose:5e3}):o(!0),console.log(l,t.id)},P=async()=>{console.log(y,N)};return e.jsxs(e.Fragment,{children:[e.jsx(F,{title:"CCBM Shop | Détails Précommande",description:"Découvrez les meilleures offres sur CCBM Shop, votre destination privilégiée pour l'électroménager de qualité. Explorez nos produits allant des réfrigérateurs aux téléviseurs intelligents, et profitez de promotions exclusives !",keywords:"électroménager, boutique en ligne d'électroménager, CCBM Shop, ccbme, appareils électroménagers à prix réduits, smart TV, réfrigérateurs modernes, climatiseurs efficaces, promotions électroménager"}),e.jsx(D,{childrenClasses:"pt-0 pb-0",children:e.jsxs("div",{className:"checkout-page-wrapper w-full bg-white pb-[60px]",children:[e.jsx("div",{className:"w-full mb-5",children:e.jsx(q,{title:"Détails Pré Commande",breadcrumb:[{name:"Accueil",path:"/"},{name:"Précommandes",path:"/profile#preorder"},{name:"Détails Précommande "}]})}),m&&e.jsx("div",{className:"flex justify-center items-center w-full h-full",children:e.jsx(p,{size:60,className:"animate-spin"})}),t&&e.jsx("div",{className:"checkout-main-content w-full",children:e.jsxs("div",{className:"container-x mx-auto",children:[e.jsxs("div",{className:"w-full sm:mb-10 mb-5",children:[e.jsxs("div",{className:"sm:flex sm:space-x-[18px] s",children:[e.jsx("div",{className:"sm:w-1/3 w-full mb-5 h-[70px]",children:e.jsx("div",{className:"w-full h-full bg-[#F6F6F6] text-qblack flex justify-center items-center",children:e.jsxs("span",{className:"text-[15px] font-medium",children:["N°Précommande ",e.jsx("span",{children:t.name})]})})}),e.jsx("div",{className:" sm:w-1/3  flex-1 h-[70px]",children:e.jsx("div",{className:"w-full h-full bg-[#F6F6F6] text-qblack flex justify-center items-center",children:e.jsxs("span",{className:"text-[15px] font-medium",children:["Paiement :"," ",t.advance_payment_status==="not_paid"&&e.jsx("span",{className:"text-red-500",children:"Non Payé"}),t.advance_payment_status==="paid"&&e.jsx("span",{className:"text-green-500",children:" Payé "}),t.advance_payment_status==="partial"&&e.jsxs("span",{className:"text-yellow-500",children:[" ","Partiellement Payé"]})]})})}),e.jsx("div",{className:"sm:w-1/3 flex-1 h-[70px]",children:e.jsx("div",{className:"w-full h-full bg-[#F6F6F6] text-qblack flex justify-center items-center",children:e.jsxs("span",{className:"text-[15px] font-medium",children:["Statut :"," ",t.state=="sale"&&e.jsx("span",{className:"text-green-500",children:" Validée "}),t.state=="to_delivered"&&e.jsx("span",{className:"text-yellow-500",children:" En cours de livraison "}),t.state=="delivered"&&e.jsx("span",{className:"text-green-600",children:" Livrée "}),t.state!="delivered"&&t.state!="sale"&&t.state!="to_delivered"&&e.jsx("span",{className:"text-gray-500",children:" Non validé "})]})})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:space-x-[18px] space-y-5 sm:space-y-0 mb-5",children:[e.jsx("div",{className:"w-full sm:w-1/2 h-auto sm:h-[70px]",children:e.jsxs("div",{className:"w-full h-full bg-[#F6F6F6] text-qblack flex flex-col sm:flex-row justify-center items-center p-3 sm:p-0",children:[e.jsx("strong",{children:" Date Précommande "}),e.jsx("div",{className:"flex flex-col sm:flex-row items-center mt-2 sm:mt-0 sm:ml-2",children:e.jsx("span",{className:"mt-1 sm:mt-0 sm:ml-2 capitalize",children:f(t.date_order)})})]})}),e.jsx("div",{className:"w-full sm:w-1/2 h-auto sm:h-[70px]",children:e.jsxs("div",{className:"w-full h-full bg-[#F6F6F6] text-qblack flex flex-col sm:flex-row justify-center items-center p-3 sm:p-0",children:[e.jsx("strong",{children:"Date de livraison"}),e.jsx("div",{className:"flex flex-col sm:flex-row items-center mt-2 sm:mt-0 sm:ml-2",children:e.jsx("span",{className:"mt-1 sm:mt-0 sm:ml-2 capitalize",children:f(t.commitment_date)})})]})})]}),e.jsxs("div",{className:"sm:flex sm:space-x-[18px] s",children:[e.jsx("div",{className:"sm:w-1/2 w-full mb-5 h-[70px]",children:e.jsxs("div",{className:"w-full h-full bg-[#F6F6F6] text-qblack flex flex-col sm:flex-row justify-center items-center p-3 sm:p-0",children:[e.jsx("strong",{children:"  Total Payé   "}),e.jsx("div",{className:"flex flex-col sm:flex-row items-center mt-2 sm:mt-0 sm:ml-2",children:e.jsx("span",{className:"mt-1 sm:mt-0 sm:ml-2 capitalize",children:a(t.amount_total-t.amount_residual)})})]})}),e.jsx("div",{className:"flex-1 h-[70px]",children:e.jsxs("div",{className:"w-full h-full bg-[#F6F6F6] text-qblack flex flex-col sm:flex-row justify-center items-center p-3 sm:p-0",children:[e.jsx("strong",{children:"     Total Restant   "}),e.jsx("div",{className:"flex flex-col sm:flex-row items-center mt-2 sm:mt-0 sm:ml-2",children:e.jsx("span",{className:"mt-1 sm:mt-0 sm:ml-2 capitalize",children:a(t.amount_residual)})})]})})]})]}),e.jsxs("div",{className:"w-full max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl text-qblack font-medium mb-5 text-center",children:"Récapitulatif de la commande"}),e.jsxs("div",{className:"w-full p-4 sm:p-6 border border-[#EDEDED] rounded-lg shadow-sm",children:[e.jsxs("div",{className:"sub-total mb-6",children:[e.jsxs("div",{className:" flex justify-between mb-5",children:[e.jsx("p",{className:"text-[13px] font-medium text-qblack uppercase",children:"Produit"}),e.jsx("p",{className:"text-[13px] font-medium text-qblack uppercase",children:"total"})]}),e.jsx("div",{className:"w-full h-[1px] bg-[#EDEDED]"})]}),e.jsx("div",{className:"product-list w-full mb-[30px]",children:e.jsx("ul",{className:"flex flex-col space-y-5",children:t.order_lines.map((s,l)=>e.jsx(e.Fragment,{children:e.jsx("li",{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"text-[15px] text-qblack mb-2.5",children:[s.product_name,e.jsxs("sup",{className:"text-[13px] text-qgray ml-2 mt-2",children:["x ",s.product_uom_qty]})]}),e.jsx("p",{className:"text-[13px] text-qgray",children:s.description})]}),e.jsx("div",{children:e.jsx("span",{className:"text-[15px] text-qblack font-medium",children:a(s.price_total)})})]})},l)}))})}),e.jsx("div",{className:"w-full h-[1px] bg-[#EDEDED]"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"border-t pt-4 space-y-2",children:[{label:"Montant Total",value:a(t.amount_total)},{label:"Premier Tranche",value:a(t.first_payment_amount),date:t.first_payment_date,state:t.first_payment_state},{label:"Deuxieme Tranche",value:a(t.second_payment_amount),date:t.second_payment_date,state:t.second_payment_state},{label:"Troisieme Tranche",value:a(t.third_payment_amount),date:t.third_payment_date,state:t.third_payment_state}].map((s,l)=>e.jsxs("dl",{className:"flex flex-wrap items-center justify-between gap-2",children:[e.jsx("dt",{className:"text-sm text-gray-500",children:s.label}),s.date&&e.jsx("dd",{className:`text-xs sm:text-sm font-medium ${s.state?"text-green-500":"text-red-500"}`,children:s.date}),e.jsx("dd",{className:`text-sm sm:text-base font-medium ${s.state?"text-green-500":s.date?"text-red-500":"text-gray-900"}`,children:s.value})]},l))}),e.jsxs("dl",{className:"flex items-center justify-between gap-4 border-t border-gray-200 pt-2 dark:border-gray-700",children:[e.jsx("dt",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Total à payer"}),e.jsx("dd",{className:"text-lg font-bold text-gray-900 dark:text-white",children:a(t.amount_total)})]}),t.amount_residual>=0&&e.jsxs("dl",{className:"flex items-center justify-between gap-4 border-t border-gray-200 pt-2 dark:border-gray-700",children:[e.jsx("dt",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Total Payé"}),e.jsx("dd",{className:"text-lg font-bold text-green-500 dark:text-white",children:a(t.amount_total-t.amount_residual)})]}),t.amount_residual>=0&&e.jsxs("dl",{className:"flex items-center justify-between gap-4 border-t border-gray-200 pt-2 dark:border-gray-700",children:[e.jsx("dt",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Total Restant"}),e.jsx("dd",{className:"text-lg font-bold text-gray-900 dark:text-white",children:a(t.amount_residual)})]})]}),e.jsxs("div",{className:"w-full",children:[(t.advance_payment_status==="not_paid"||t.advance_payment_status==="partial")&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"input-item mb-5",children:[e.jsx("div",{className:"mb-2 inline-block",children:e.jsx(E,{htmlFor:"montant",value:"Montant à payer"})}),e.jsx(M,{id:"montant",placeholder:"1000",label:"Montant*",name:"montantAPayer",type:"number",value:n,max:t.amount_residual,min:t.first_payment_state?1e3:t.first_payment_amount,onChange:s=>{const l=s.target.value;l<=t.amount_residual&&g(l),!t.first_payment_state&&l<t.first_payment_amount?u(`Le montant entré doit être supérieur ou égal à la première tranche de ${a(t.first_payment_amount)}.`):u("")},required:!0,className:"invalid:border-red-500 invalid:text-red-600 focus:invalid:border-red-500 focus:invalid:ring-red-500"}),x&&e.jsx("p",{className:"text-red-600",children:x})]}),t&&e.jsx(e.Fragment,{children:t.state!=="sale"&&t.state!=="draft"?e.jsx("div",{className:"flex justify-center items-center mt-2",children:e.jsx("span",{className:"text-lg font-medium text-red-500 dark:text-white",children:"La précommande est annulée, vous ne pouvez pas passer à la caisse."})}):e.jsxs(S,{type:"submit",onClick:s=>w(s,n),className:"rounded-lg px-5 py-2.5 font-medium w-full hover:bg-red-500 hover:text-white text-xl",disabled:b,children:[m&&e.jsx(C,{className:"mr-2 h-4 w-4 animate-spin"}),"Passer à la caisse (",a(n),")"]})}),v&&t&&e.jsx(T,{handlePay:P,totalAmount:n,onClose:()=>o(!1),order:t,idOrder:t.id})]}),t.advance_payment_status==="paid"&&e.jsx("div",{className:"flex justify-center items-center mt-2",children:e.jsx("span",{className:"text-lg font-medium text-green-500 dark:text-white",children:"Votre paiement est déjà réglé"})})]})]})]})]})}),!t&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex justify-center items-center ",children:[e.jsx(p,{className:"animate-spin"})," Précommande non trouvée"]})})]})})]})}export{G as default};

import{c as q,u as E,j as e,L as m,i as D,k as M,y as S,f as r,t as z,l as B,W as T,B as d,D as N,F as A}from"./index.fafced5c.js";import{j as L,r as n,u as O}from"./vendor.af94f9e3.js";import{g as R}from"./creditCommandeService.b0ede145.js";import{f as x}from"./date-format.d160e78b.js";import{T as V}from"./truck.1401c318.js";/**
 * @license lucide-react v0.400.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=q("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);function J(){const{id:o}=L(),{user:p}=E(),[s,g]=n.useState(null),[c,y]=n.useState(!0),[a,v]=n.useState(0),[b,i]=n.useState(!1),[h,u]=n.useState(""),[w,_]=n.useState(!1),C=O();n.useEffect(()=>{(async()=>{try{const l=await R(p.id,o);console.log(l),g(l)}catch{C("/boutique"),d.error("Impossible de charger les détails de la commande")}finally{y(!1)}})()},[o,p.id]),n.useEffect(()=>{if(s){const t=s.advance_payment_status==="not_paid"&&a<s.payment_lines[0].amount||s.advance_payment_status==="partial"&&a<100||a>s.amount_residual||c;_(t)}},[s,a,c]);const F=async t=>{t.preventDefault(),a<100?d.warning("Le Montant doit être strictement supérieur à 100 F CFA",{position:"top-center",autoClose:5e3}):i(!0)},f=t=>{switch(t==null?void 0:t.toLowerCase()){case"pending":return"En cours de validation";case"validated":return"Validé";case"rejected":return"Rejeté";default:return"En cours"}},j=t=>{switch(t==null?void 0:t.toLowerCase()){case"pending":return e.jsx(N,{className:"w-5 h-5 text-yellow-500"});case"validated":return e.jsx(A,{className:"w-5 h-5 text-green-500"});case"rejected":return e.jsx(N,{className:"w-5 h-5 text-red-500"});default:return e.jsx(V,{className:"w-5 h-5 text-blue-500"})}},k=t=>t.state?e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Payé"}):t.paid_amount>0?e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:"Partiel"}):e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:"En attente"}),P=()=>{if(a<1e3){d.warning("Le montant doit être supérieur à 1000 F CFA");return}i(!0)};return c?e.jsxs("div",{className:"flex justify-center items-center h-screen",children:[e.jsx(m,{className:"animate-spin w-8 h-8"}),e.jsx("span",{className:"ml-2",children:"Chargement..."})]}):s?e.jsxs(e.Fragment,{children:[e.jsx(D,{title:"CCBM Shop | Détails Commande à Crédit",description:"Découvrez les meilleures offres sur CCBM Shop, votre destination privilégiée pour l'électroménager de qualité. Explorez nos produits allant des réfrigérateurs aux téléviseurs intelligents, et profitez de promotions exclusives !",keywords:"électroménager, boutique en ligne d'électroménager, CCBM Shop, ccbme, appareils électroménagers à prix réduits, smart TV, réfrigérateurs modernes, climatiseurs efficaces, promotions électroménager"}),e.jsx(M,{childrenClasses:"pt-0 pb-0",children:e.jsxs("div",{className:"checkout-page-wrapper w-full bg-white pb-[60px]",children:[e.jsx("div",{className:"w-full mb-5",children:e.jsx(S,{title:"Détails Commande à Crédit",breadcrumb:[{name:"Accueil",path:"/"},{name:"Commande à Crédits",path:"/profile#commandes-a-credit"},{name:"Détails Commande à crédit"}]})}),c&&e.jsx("div",{className:"flex justify-center items-center w-full h-full",children:e.jsx(m,{className:"animate-spin"})}),s&&e.jsx("div",{className:"checkout-main-content w-full",children:e.jsxs("div",{className:"container-x mx-auto",children:[e.jsxs("div",{className:"w-full sm:mb-10 mb-5",children:[e.jsxs("div",{className:"sm:flex sm:space-x-[18px] s",children:[e.jsx("div",{className:"sm:w-1/3 w-full mb-5 h-[70px]",children:e.jsx("div",{className:"w-full h-full bg-[#F6F6F6] text-qblack flex justify-center items-center",children:e.jsxs("span",{className:"text-[15px] font-medium",children:["N°Commande à Crédit ",e.jsx("span",{children:s.name})]})})}),e.jsx("div",{className:"sm:w-1/3 flex-1 h-[70px]",children:e.jsx("div",{className:"w-full h-full bg-[#F6F6F6] text-qblack flex justify-center items-center",children:e.jsxs("span",{className:"text-[15px] font-medium",children:["Paiement :"," ",s.advance_payment_status==="not_paid"&&e.jsx("span",{className:"text-red-500",children:"Non Payé"}),s.advance_payment_status==="paid"&&e.jsx("span",{className:"text-green-500",children:" Payé "}),s.advance_payment_status==="partial"&&e.jsx("span",{className:"text-yellow-500",children:"Partiellement Payé"})]})})}),e.jsx("div",{className:"sm:w-1/3 flex-1 h-[70px]",children:e.jsxs("div",{className:"w-full h-full bg-[#F6F6F6] text-qblack flex flex-col sm:flex-row justify-center items-center p-3 sm:p-0",children:[e.jsx("strong",{children:" Statut : "}),e.jsx("div",{className:"flex flex-col sm:flex-row items-center mt-2 sm:mt-0 sm:ml-2",children:e.jsxs("span",{className:"mt-1 sm:mt-0 sm:ml-2 capitalize",children:[s.state==="sale"&&e.jsx("span",{className:"text-green-500",children:"Validé"}),s.state==="draft"&&e.jsx("span",{className:"text-yellow-500",children:"En cours de traitement"}),s.state==="cancel"&&e.jsx("span",{className:"text-red-500",children:"Annulée"}),s.state==="delivered"&&e.jsx("span",{className:"text-green-600",children:"Livrée"}),s.state==="to_delivered"&&e.jsx("span",{className:"text-yellow-500",children:"En cours de livraison"}),s.state==="validation"&&e.jsx("span",{className:"text-yellow-500",children:"En cours de validation"})]})})]})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:space-x-[18px] space-y-5 sm:space-y-0 mb-5",children:[e.jsx("div",{className:"w-full sm:w-1/2 h-auto sm:h-[70px]",children:e.jsxs("div",{className:"w-full h-full bg-[#F6F6F6] text-qblack flex flex-col sm:flex-row justify-center items-center p-3 sm:p-0",children:[e.jsx("strong",{children:"Validation RH"}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center mt-2 sm:mt-0 sm:ml-2",children:[e.jsx("span",{className:"hidden sm:inline-block",children:j(s.validation_rh_state)}),e.jsx("span",{className:"mt-1 sm:mt-0 sm:ml-2 capitalize",children:f(s.validation_rh_state)})]})]})}),e.jsx("div",{className:"w-full sm:w-1/2 h-auto sm:h-[70px]",children:e.jsxs("div",{className:"w-full h-full bg-[#F6F6F6] text-qblack flex flex-col sm:flex-row justify-center items-center p-3 sm:p-0",children:[e.jsx("strong",{children:"Approbation CCBM"}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center mt-2 sm:mt-0 sm:ml-2",children:[e.jsx("span",{className:"hidden sm:inline-block",children:j(s.validation_admin_state)}),e.jsx("span",{className:"mt-1 sm:mt-0 sm:ml-2 capitalize",children:f(s.validation_admin_state)})]})]})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:space-x-[18px] space-y-5 sm:space-y-0 mb-5",children:[e.jsx("div",{className:"w-full sm:w-1/2 h-auto sm:h-[70px]",children:e.jsxs("div",{className:"w-full h-full bg-[#F6F6F6] text-qblack flex flex-col sm:flex-row justify-center items-center p-3 sm:p-0",children:[e.jsx("strong",{children:" Date commande "}),e.jsx("div",{className:"flex flex-col sm:flex-row items-center mt-2 sm:mt-0 sm:ml-2",children:e.jsx("span",{className:"mt-1 sm:mt-0 sm:ml-2 capitalize",children:x(s.date_order)})})]})}),e.jsx("div",{className:"w-full sm:w-1/2 h-auto sm:h-[70px]",children:e.jsxs("div",{className:"w-full h-full bg-[#F6F6F6] text-qblack flex flex-col sm:flex-row justify-center items-center p-3 sm:p-0",children:[e.jsx("strong",{children:"Date de livraison"}),e.jsx("div",{className:"flex flex-col sm:flex-row items-center mt-2 sm:mt-0 sm:ml-2",children:e.jsx("span",{className:"mt-1 sm:mt-0 sm:ml-2 capitalize",children:x(s.commitment_date)})})]})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:space-x-[18px] space-y-5 sm:space-y-0 mb-5",children:[e.jsx("div",{className:"w-full sm:w-1/2 h-auto sm:h-[70px]",children:e.jsxs("div",{className:"w-full h-full bg-[#F6F6F6] text-qblack flex flex-col sm:flex-row justify-center items-center p-3 sm:p-0",children:[e.jsx("strong",{children:"Pourcentage de paiement"}),e.jsx("div",{className:"flex flex-col sm:flex-row items-center mt-2 sm:mt-0 sm:ml-2",children:e.jsxs("span",{className:"mt-1 sm:mt-0 sm:ml-2 capitalize",children:[s.credit_month_rate,"%"]})})]})}),e.jsx("div",{className:"w-full sm:w-1/2 h-auto sm:h-[70px]",children:e.jsxs("div",{className:"w-full h-full bg-[#F6F6F6] text-qblack flex flex-col sm:flex-row justify-center items-center p-3 sm:p-0",children:[e.jsx("strong",{children:"Nombre d'Échéances"}),e.jsx("div",{className:"flex flex-col sm:flex-row items-center mt-2 sm:mt-0 sm:ml-2",children:e.jsx("span",{className:"mt-1 sm:mt-0 sm:ml-2 capitalize",children:s.creditorder_month_count})})]})})]}),e.jsxs("div",{className:"sm:flex sm:space-x-[18px] s",children:[e.jsx("div",{className:"sm:w-1/2 w-full mb-5 h-[70px]",children:e.jsxs("div",{className:"w-full h-full bg-[#F6F6F6] text-qblack flex flex-col sm:flex-row justify-center items-center p-3 sm:p-0",children:[e.jsx("strong",{children:" Total Payé  "}),e.jsx("div",{className:"flex flex-col sm:flex-row items-center mt-2 sm:mt-0 sm:ml-2",children:e.jsx("span",{className:"mt-1 sm:mt-0 sm:ml-2 capitalize",children:r(s.amount_total-s.amount_residual)})})]})}),e.jsx("div",{className:"flex-1 h-[70px]",children:e.jsxs("div",{className:"w-full h-full bg-[#F6F6F6] text-qblack flex flex-col sm:flex-row justify-center items-center p-3 sm:p-0",children:[e.jsx("strong",{children:" Total Restant   "}),e.jsx("div",{className:"flex flex-col sm:flex-row items-center mt-2 sm:mt-0 sm:ml-2",children:e.jsx("span",{className:"mt-1 sm:mt-0 sm:ml-2 capitalize",children:r(s.amount_residual)})})]})})]}),s.payment_lines&&s.payment_lines.length>0&&e.jsx("div",{className:"w-full mt-8 mb-8",children:e.jsxs("div",{className:"bg-white border border-[#EDEDED] rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 bg-gray-50 border-b border-[#EDEDED]",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(I,{className:"w-5 h-5 text-gray-600 mr-2"}),e.jsx("h2",{className:"text-xl font-semibold text-qblack",children:"Échéancier de Paiement"})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Détail des échéances de paiement pour cette commande à crédit"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full bg-white",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Échéance"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date d'échéance"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Montant dû"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Taux (%)"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Statut"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:s.payment_lines.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"text-sm font-medium text-gray-900",children:["Échéance ",t.sequence]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900",children:x(t.due_date)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:r(t.amount)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"text-sm text-gray-900",children:[t.rate.toFixed(1),"%"]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:k(t)})]},t.sequence))})]})})]})})]}),e.jsxs("div",{className:"w-full max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl text-qblack font-medium mb-5 text-center",children:"Récapitulatif de la commande"}),e.jsx("div",{className:"w-full p-4 sm:p-6 border border-[#EDEDED] rounded-lg shadow-sm",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center border-b pb-4",children:[e.jsx("p",{className:"text-sm font-medium text-qblack uppercase",children:"Produit"}),e.jsx("p",{className:"text-sm font-medium text-qblack uppercase",children:"Total"})]}),e.jsx("div",{className:"space-y-4",children:s.order_lines&&s.order_lines.map((t,l)=>e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("h4",{className:"text-sm sm:text-base text-qblack mb-1",children:[t.product_name,e.jsxs("sup",{className:"text-xs text-qgray ml-1",children:["x ",t.product_uom_qty]})]}),e.jsx("p",{className:"text-xs sm:text-sm text-qgray",children:t.description})]}),e.jsx("span",{className:"text-sm sm:text-base text-qblack font-medium",children:r(t.price_total)})]},l))}),e.jsxs("div",{className:"border-t pt-4 space-y-2",children:[e.jsxs("dl",{className:"flex items-center justify-between gap-2",children:[e.jsx("dt",{className:"text-base sm:text-lg font-bold text-gray-900",children:"Total à payer"}),e.jsx("dd",{className:"text-base sm:text-lg font-bold text-gray-900",children:r(s.amount_total)})]}),s.amount_residual>=0&&e.jsxs(e.Fragment,{children:[e.jsxs("dl",{className:"flex items-center justify-between gap-2",children:[e.jsx("dt",{className:"text-base sm:text-lg font-bold text-gray-900",children:"Total Payé"}),e.jsx("dd",{className:"text-base sm:text-lg font-bold text-green-500",children:r(s.amount_total-s.amount_residual)})]}),e.jsxs("dl",{className:"flex items-center justify-between gap-2",children:[e.jsx("dt",{className:"text-base sm:text-lg font-bold text-gray-900",children:"Total Restant"}),e.jsx("dd",{className:"text-base sm:text-lg font-bold text-gray-900",children:r(s.amount_residual)})]})]})]}),s.validation_rh_state==="validated"&&s.validation_admin_state==="validated"&&(s.advance_payment_status==="not_paid"||s.advance_payment_status==="partial")&&e.jsxs("div",{className:"mt-6",children:[e.jsx("label",{htmlFor:"montant",className:"block text-sm font-medium text-gray-700 mb-2",children:"Montant à payer"}),e.jsx("input",{id:"montant",type:"number",value:a,onChange:t=>{const l=Number(t.target.value);l<=s.amount_residual&&(v(l),!s.payment_lines[0].state&&l<s.payment_lines[0].amount?u(`Le montant entré doit être supérieur ou égal à la première tranche de ${r(s.payment_lines[0].amount)}.`):u(""))},max:s.amount_residual,min:s.advance_payment_status==="not_paid"?s.amount_total*Number.parseInt(s.credit_month_rate)/100:100,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Entrez le montant à payer"}),h&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:h}),e.jsxs(z,{onClick:F,className:"mt-4 w-full",disabled:w,children:[c&&e.jsx(B,{className:"mr-2 h-4 w-4 animate-spin"}),"Passer à la caisse (",r(a),")"]})]}),s.state=="cancel"&&e.jsx("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsx("p",{className:"text-yellow-800 text-center",children:"La commande a été annulée"})}),(s.validation_rh_state!=="validated"||s.validation_admin_state!=="validated")&&e.jsx("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsx("p",{className:"text-yellow-800 text-center",children:"Merci d'attendre la validation de la commande à crédit par la RH et CCBM"})}),s.validation_rh_state==="rejected"&&s.validation_admin_state==="rejected"&&e.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:e.jsx("p",{className:"text-red-800 text-center font-semibold",children:"La Commande à Crédit n'est pas acceptée"})}),s.advance_payment_status==="paid"&&e.jsx("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:e.jsx("p",{className:"text-green-800 text-center font-semibold",children:"Votre paiement est déjà réglé"})})]})}),b&&s&&e.jsx(T,{handlePay:P,totalAmount:a,onClose:()=>i(!1),order:s,idOrder:s.id})]})]})}),!s&&e.jsxs("div",{className:"flex justify-center items-center",children:[e.jsx(m,{className:"animate-spin"})," Commande à Crédit non trouvée"]})]})})]}):e.jsx("div",{className:"text-center text-red-500 text-xl mt-10",children:"Commande non trouvée"})}export{J as default};

import{C as B,j as e,f as S,O as ie,u as ce,l as oe,m as de,p as me,A as pe,t as X,n as Y,B as p}from"./index-Cu3shM5z.js";import{b as l,u as xe,L as ue}from"./vendor-Bb8_f6lk.js";import{M as he,P as ye}from"./plus-fCvM2tWN.js";import{B as be}from"./BannerPub-AINnY4RO.js";import{c as V}from"./creditCommandeService-dCo51Bxc.js";import{g as fe}from"./entrepriseFunctionService-BHSYulaw.js";import"./truck-D7rI8C26.js";function je({produit:o}){const{updateCreditOrder:h}=l.useContext(B),f=b=>{b.preventDefault(),h(o,o.quantity+1)},D=b=>{console.log("produit.quantity"),console.log(o.quantity),b.preventDefault(),o.quantity>1&&h(o,o.quantity-1)};return e.jsx("div",{className:"w-[120px] h-[40px] px-[26px] flex items-center border border-qgray-border",children:e.jsxs("div",{className:"flex justify-between items-center w-full",children:[e.jsx("button",{onClick:D,type:"button",className:"text-base text-qgray",children:e.jsx(he,{})}),e.jsx("span",{className:"text-qblack",children:o.quantity?o.quantity:0}),e.jsx("button",{onClick:f,type:"button",className:"text-base text-qgray",children:e.jsx(ye,{})})]})})}function ge({className:o}){const{creditOrder:h,clearCreditOrder:f,removeFromCreditOrder:D}=l.useContext(B);console.log(h);const b=(s,y)=>{s.preventDefault(),D(y)};return e.jsxs("div",{className:`w-full ${o||""}`,children:[e.jsx("div",{className:"relative w-full overflow-x-auto border border-[#EDEDED]",children:e.jsx("table",{className:"w-full text-sm text-left text-gray-500 dark:text-gray-400",children:e.jsxs("tbody",{children:[e.jsxs("tr",{className:"text-[13px] font-medium text-black bg-[#F6F6F6] whitespace-nowrap px-2 border-b default-border-bottom uppercase",children:[e.jsx("td",{className:"py-4 pl-10 block whitespace-nowrap min-w-[300px]",children:"product"}),e.jsx("td",{className:"py-4 whitespace-nowrap text-center",children:"Prix"}),e.jsx("td",{className:"py-4 whitespace-nowrap  text-center",children:"Quantité"}),e.jsx("td",{className:"py-4 whitespace-nowrap  text-center",children:"total"}),e.jsx("td",{className:"py-4 whitespace-nowrap text-right w-[114px]"})]}),h&&h.map((s,y)=>e.jsxs("tr",{className:"bg-white border-b hover:bg-gray-50",children:[e.jsx("td",{className:"pl-10  py-4  w-[380px]",children:e.jsxs("div",{className:"flex space-x-6 items-center",children:[e.jsx("div",{className:"w-[80px] h-[80px] overflow-hidden flex justify-center items-center border border-[#EDEDED]",children:e.jsx("img",{src:`${s.image_256?"data:image/png;base64,"+s.image_256:"https://readymadeui.com/images/coffee1.webp"}`,alt:"product",className:"w-full h-full object-contain"})}),e.jsx("div",{className:"flex-1 flex flex-col",children:e.jsx("p",{className:"font-medium text-[15px] text-qblack",children:s.name})})]})}),e.jsx("td",{className:"text-center py-4 px-2",children:e.jsx("div",{className:"flex space-x-1 items-center justify-center",children:e.jsxs("span",{className:"text-[15px] font-normal",children:[" ",S(s.creditorder_price)]})})}),e.jsx("td",{className:" py-4",children:e.jsx("div",{className:"flex justify-center items-center",children:e.jsx(je,{produit:s})})}),e.jsx("td",{className:"text-right py-4",children:e.jsx("div",{className:"flex space-x-1 items-center justify-center",children:e.jsxs("span",{className:"text-[15px] font-normal",children:[" ",S(s.creditorder_price*s.quantity)]})})}),e.jsx("td",{className:"text-right py-4",children:e.jsx("div",{className:"flex space-x-1 items-center justify-center",children:e.jsx("button",{onClick:d=>b(d,s),className:"duration-200 hover:scale-150",children:e.jsx(ie,{className:"hover:text-red-500"})})})})]},y))]})})}),e.jsx("div",{className:" mt-3 transition-all duration-300 ease-in-out bg-gray-200 text-[15px]  rounded-lg font-medium text-black  text-center py-2",children:"Livraison gratuite sur Dakar"})]})}function De({cartt:o=!0}){const h=xe(),{creditOrder:f,getCreditOrderTotal:D,clearCreditOrder:b}=l.useContext(B),{user:s,parent:y}=ce();console.log(s),console.log("user");const[d,R]=l.useState("direct"),Z=d==="finance",[M,ee]=l.useState(50),[F,te]=l.useState(4),se=[30,40,50,60,70,80,90,100],[E,ae]=l.useState([]),[_,H]=l.useState(!1),[$,J]=l.useState(""),[A,L]=l.useState(""),[u,O]=l.useState(""),v=l.useMemo(()=>d==="finance"?E.filter(t=>t.type_partner==="banque"):E.filter(t=>t.type_partner!=="banque"),[E,d]),j=l.useMemo(()=>E.filter(t=>t.type_partner==="banque"),[E]),[r,m]=l.useState({nom:s&&s.nom||"",prenom:s&&s.prenom||"",dateNaissance:s&&s.date_naissance||"",lieuNaissance:s&&s.lieu_naissance||"",telephone:s&&(s.telephone||s.partner_phone||s.phone||s.whatsapp_number)||"",email:s&&s.email||"",cniNumber:s&&s.cni_number||"",profession:s&&s.profession||"",rib:s&&s.rib||"",adresse:s&&s.adresse||"",adresseEmployeur:s&&(s.adresse_employeur||s.employer_partner_adresse)||"",employeur:s&&(s.employer_name||s.employer_partner_name)||"",institution_partner_id:s&&s.institution_partner_id||"",institution_id:s&&s.institution_partner_id||"",employer_partner_id:s&&s.employer_partner_id||"",employer_partner_name:s&&s.employer_partner_name||"",employer_partner_email:s&&s.employer_partner_email||"",employer_partner_phone:s&&s.employer_partner_phone||"",employer_partner_adresse:s&&s.employer_partner_adresse||"",salary_monthly:s&&s.salary_monthly||"",kyc_id_number:s&&s.kyc_id_number||"",notes:"",kyc_id_type:"",kyc_id_expiry:"",whatsapp_number:s&&s.whatsapp_number||"",preferred_contact_channel:"",job_title:s&&s.function||""}),[P,re]=l.useState({salarySlips:[],bankStatements:[]}),[w,T]=l.useState(!1),I=l.useRef(null),c=D()||0,Q=l.useMemo(()=>{const a=c/1.18;return c-a},[c]),U=l.useMemo(()=>{if(d!=="direct")return[];if(!c)return[];const t=Math.min(100,Math.max(30,M||30)),a=Math.min(5,Math.max(1,F||1));if(t===100||a===1)return[{label:"Paiement unique",amount:c,dueAt:new Date}];const n=c*t/100,x=Math.max(0,c-n),i=a-1,C=x/i,k=Math.round(C*100)/100,g=[];g.push({label:`Acompte (${t}%)`,amount:Math.round(n*100)/100,dueAt:new Date});let N=0;for(let q=1;q<=i;q++){const z=new Date;z.setMonth(z.getMonth()+q);const K=q<i?k:Math.round((x-N)*100)/100;N=Math.round((N+K)*100)/100,g.push({label:`Mensualité ${q}/${i}`,amount:K,dueAt:z})}return g},[d,c,M,F]);l.useEffect(()=>{(async()=>{H(!0),J("");try{const a=await fe();console.log(a);const n=Array.isArray(a)?a:a&&a.data||[];ae(n)}catch{J("Impossible de charger la liste des entreprises.")}finally{H(!1)}})()},[]),l.useEffect(()=>{L(""),O("")},[d]),l.useEffect(()=>{s!=null&&s.parent_id&&v&&v.length&&!A&&v.find(a=>String(a.id)===String(s.parent_id))&&L(String(s.parent_id))},[s==null?void 0:s.parent_id,v,A]),l.useEffect(()=>{s!=null&&s.institution_partner_id&&j&&j.length&&!u&&j.find(a=>String(a.id)===String(s.institution_partner_id))&&O(String(s.institution_partner_id))},[s==null?void 0:s.institution_partner_id,j,u]),l.useEffect(()=>{s&&m(t=>({...t,nom:t.nom||s.nom||"",prenom:t.prenom||s.prenom||"",dateNaissance:t.dateNaissance||s.date_naissance||"",lieuNaissance:t.lieuNaissance||s.lieu_naissance||"",telephone:t.telephone||s.telephone||s.partner_phone||s.phone||s.whatsapp_number||"",email:t.email||s.email||"",cniNumber:t.cniNumber||s.cni_number||"",profession:t.profession||s.profession||"",rib:t.rib||s.rib||"",adresse:t.adresse||s.adresse||"",adresseEmployeur:t.adresseEmployeur||s.adresse_employeur||s.employer_partner_adresse||"",employeur:t.employeur||s.employer_name||s.employer_partner_name||"",institution_partner_id:t.institution_partner_id||s.institution_partner_id||"",institution_id:t.institution_id||s.institution_partner_id||"",employer_partner_id:t.employer_partner_id||s.employer_partner_id||"",employer_partner_name:t.employer_partner_name||s.employer_partner_name||"",employer_partner_email:t.employer_partner_email||s.employer_partner_email||"",employer_partner_phone:t.employer_partner_phone||s.employer_partner_phone||"",employer_partner_adresse:t.employer_partner_adresse||s.employer_partner_adresse||"",job_title:t.job_title||s.function||"",whatsapp_number:t.whatsapp_number||s.whatsapp_number||""}))},[s]);const W=(t,a)=>{const n=Array.from(t||[]),x=n.filter(i=>i.type==="application/pdf");n.length!==x.length&&p.warning("Seuls les fichiers PDF sont acceptés.",{position:"top-center",autoClose:3e3}),re(i=>({...i,[a]:x.slice(0,3)}))},G=()=>s?f&&f.length?d==="direct"&&!A?(p.dismiss(),p.error("Veuillez sélectionner votre entreprise.",{position:"top-center",autoClose:5e3}),I.current&&I.current.focus(),!1):!0:(p.dismiss(),p.error("Veuillez ajouter au moins un article dans votre panier",{position:"top-center",autoClose:5e3}),!1):(p.dismiss(),p.warning("Merci de vous connecter",{position:"top-center",autoClose:5e3}),h("/login"),!1),ne=async()=>{if(G()){T(!0);try{const t=Math.min(100,Math.max(30,M)),a=t===100?1:Math.min(5,Math.max(1,F)),n={partner_id:s.id,parent_id:y&&y.id,company_id:parseInt(A),type_sale:"creditorder",type_credit:"direct",payment_mode:"online",state:"draft",commitment_date:new Date,acomptePercentage:t,nombreMois:a,order_lines:f.map(i=>({id:i.id,quantity:i.quantity,list_price:i.creditorder_price||i.list_price})),echeancier_prevu:U.map(i=>({label:i.label,amount:i.amount,dueAt:i.dueAt}))};console.log(n);const x=await V(n);p.success("Votre commande à crédit direct a été créée avec succès",{position:"top-center",autoClose:5e3}),setTimeout(()=>{h(`/credit-commandes/${x.id}/détails`,{state:{commande:x}})},600),b()}catch(t){p.error(t&&t.response&&t.response.data&&t.response.data.message||"Commande crédit direct non validée",{position:"top-center",autoClose:5e3})}finally{T(!1)}}},le=async()=>{if(!G())return;if(!r.nom||!r.prenom||!r.dateNaissance||!r.lieuNaissance||!r.telephone||!r.email||!r.cniNumber||!r.profession||!r.rib||!r.adresse||!r.adresseEmployeur||!r.employeur||!u){p.error("Veuillez remplir tous les champs obligatoires.",{position:"top-center"});return}if(!/^[A-Z0-9]{23}$/.test(r.rib)){p.error("Le RIB doit contenir exactement 23 caractères (chiffres et lettres).",{position:"top-center"});return}T(!0);const t=j.find(n=>String(n.id)===String(u)),a={partner_id:s.id,parent_id:y==null?void 0:y.id,company_id:u?parseInt(u):null,type_sale:"creditorder",type_credit:"banque",payment_mode:"online",state:"draft",commitment_date:new Date().toISOString(),order_lines:f.map(n=>({id:n.id,quantity:n.quantity,list_price:n.creditorder_price||n.list_price})),bank_dossier:{nom:r.nom,prenom:r.prenom,dateNaissance:r.dateNaissance,lieuNaissance:r.lieuNaissance,telephone:r.telephone,email:r.email,cniNumber:r.cniNumber,profession:r.profession,rib:r.rib,adresse:r.adresse,adresseDomicile:r.adresse,adresseEmployeur:r.adresseEmployeur,employeur:r.employeur.trim(),institution:(t==null?void 0:t.name)||(t==null?void 0:t.raison_sociale)||(t==null?void 0:t.nom)||"",institution_id:u?parseInt(u):null,institution_partner_id:r.institution_partner_id||(u?parseInt(u):null),employer_partner_id:r.employer_partner_id||null,employer_partner_name:r.employer_partner_name||r.employeur||null,employer_partner_email:r.employer_partner_email||null,employer_partner_phone:r.employer_partner_phone||null,employer_partner_adresse:r.employer_partner_adresse||r.adresseEmployeur||null}};console.log(a),console.log(JSON.stringify(a));try{const{salarySlips:n,bankStatements:x}=P,i=n&&n.length||x&&x.length;let C;if(!i)C=await V(a);else{const k=new FormData;k.append("payload",JSON.stringify(a)),(n||[]).forEach((g,N)=>{k.append(`bulletin_salaire_${N+1}`,g)}),(x||[]).forEach((g,N)=>{k.append(`releve_bancaire_${N+1}`,g)}),C=await V(k)}p.success("Votre demande de financement a été soumise pour validation.",{position:"top-center",autoClose:5e3}),setTimeout(()=>{h(`/credit-commandes/${C.id}/détails`,{state:{commande:C}})},600),b()}catch(n){p.error(n&&n.response&&n.response.data&&n.response.data.message||"Soumission financement non effectuée",{position:"top-center",autoClose:5e3})}finally{T(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(oe,{title:"CCBM Shop | Panier crédit",description:"Choisissez le type de crédit (direct ou financement), sélectionnez votre entreprise, configurez votre plan ou remplissez le dossier, puis validez.",keywords:"électroménager, CCBM Shop, crédit, acompte, mensualités, banque, financement"}),e.jsxs(de,{childrenClasses:o?"pt-0 pb-0":"",children:[o===!1?e.jsx("div",{className:"cart-page-wrapper w-full",children:e.jsx("div",{className:"container-x mx-auto",children:e.jsx(me,{paths:[{name:"Accueil",path:"/"},{name:"Panier crédit",path:"/credit-cart"}]})})}):e.jsxs("div",{className:"cart-page-wrapper w-full bg-white pb-[60px]",children:[e.jsx("div",{className:"w-full",children:e.jsx(pe,{title:"Panier crédit",breadcrumb:[{name:"Accueil",path:"/"},{name:"Panier crédit",path:"/credit-cart"}]})}),e.jsx("div",{className:"w-full mt-[23px]",children:e.jsxs("div",{className:"container-x mx-auto",children:[e.jsx(ge,{className:"mb-[30px]"}),e.jsx("div",{className:"w-full sm:flex justify-between",children:e.jsx("div",{className:"flex space-x-2.5 items-center",children:e.jsx(ue,{to:"/boutique",children:e.jsx("div",{className:"w-[220px] h-[50px] bg-[#F6F6F6] flex justify-center items-center",children:e.jsx("span",{className:"text-sm font-semibold",children:"Continuer vos achats"})})})})}),e.jsx("div",{className:`w-full mt-[30px] ${Z?"":"flex sm:justify-end"}`,children:e.jsxs("div",{className:`${Z?"w-full max-w-none":"sm:w-[420px] w-full"} border border-[#EDEDED] px-[20px] sm:px-[30px] py-[20px] sm:py-[26px] rounded-md`,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm text-gray-700 mb-2",children:"Type de crédit"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsxs("label",{className:"inline-flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"type_credit",value:"direct",checked:d==="direct",onChange:()=>R("direct")}),e.jsx("span",{children:"Crédit direct"})]}),e.jsxs("label",{className:"inline-flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"type_credit",value:"finance",checked:d==="finance",onChange:()=>R("finance")}),e.jsx("span",{children:"Paiement par financement"})]})]})]}),c>0&&d==="direct"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"block text-sm text-gray-700 mb-1",children:["Votre entreprise ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{ref:I,className:"w-full border rounded p-2",value:A,onChange:t=>L(t.target.value),disabled:_,children:[e.jsx("option",{value:"",children:"-- Sélectionnez votre entreprise --"}),v.map(t=>e.jsx("option",{value:t.id,children:t.name||t.raison_sociale||t.nom},t.id))]}),_&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Chargement des entreprises…"}),$&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:$}),v.length===0&&!_&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Aucune entreprise disponible."})]}),e.jsxs("div",{className:"space-y-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Acompte"}),e.jsx("select",{className:"w-full border rounded p-2",value:M,onChange:t=>ee(Number(t.target.value)),children:se.map(t=>e.jsxs("option",{value:t,children:[t,"%"]},t))}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Minimum 30%. 100% = paiement en une fois."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Nombre de paiements (mois)"}),e.jsx("select",{className:"w-full border rounded p-2",value:F,onChange:t=>te(Number(t.target.value)),disabled:M===100,children:[1,2,3,4,5].map(t=>e.jsx("option",{value:t,children:t},t))}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Maximum 5 mensualités."})]})]}),e.jsx("div",{className:"border-t pt-4 space-y-2",children:U.map((t,a)=>e.jsxs("dl",{className:"flex flex-wrap items-center justify-between gap-2",children:[e.jsxs("dt",{className:"text-sm text-gray-500",children:[t.label,t.dueAt&&e.jsxs("span",{className:"ml-2 text-xs text-gray-400",children:["(échéance: ",new Date(t.dueAt).toLocaleDateString(),")"]})]}),e.jsx("dd",{className:"text-sm sm:text-base font-medium text-gray-900",children:S(t.amount)})]},`${t.label}-${a}`))}),e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-[15px] text-gray-600",children:"Sous-total (hors TVA)"}),e.jsx("span",{className:"text-[15px] font-medium",children:S(c-Q)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-[15px] text-gray-600",children:"TVA (18%)"}),e.jsx("span",{className:"text-[15px] font-medium",children:S(Q)})]}),e.jsxs("div",{className:"flex justify-between border-t pt-2",children:[e.jsx("span",{className:"text-[16px] font-semibold text-gray-800",children:"Total commande (TTC)"}),e.jsx("span",{className:"text-[16px] font-semibold",children:S(c)})]})]}),e.jsx("br",{}),e.jsxs(X,{type:"button",className:"hover:bg-red-500 w-full bg-bleu-logo",onClick:ne,disabled:w||c<=0,children:[w&&e.jsx(Y,{className:"mr-2 h-4 w-4 animate-spin"}),w?"Veuillez patienter...":"Valider le panier (crédit direct)"]})]}),c>0&&d==="finance"&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"mt-6 border-t pt-4 space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Informations personnelles"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Champs requis pour le dossier de financement"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-gray-600 mb-1",children:["Nom ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",className:"w-full border rounded p-2",value:r.nom,onChange:t=>m(a=>({...a,nom:t.target.value}))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-gray-600 mb-1",children:["Prénom ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",className:"w-full border rounded p-2",value:r.prenom,onChange:t=>m(a=>({...a,prenom:t.target.value}))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-gray-600 mb-1",children:["Date de naissance ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"date",className:"w-full border rounded p-2",value:r.dateNaissance,onChange:t=>m(a=>({...a,dateNaissance:t.target.value}))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-gray-600 mb-1",children:["Lieu de naissance ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",className:"w-full border rounded p-2",value:r.lieuNaissance,onChange:t=>m(a=>({...a,lieuNaissance:t.target.value}))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-gray-600 mb-1",children:["Téléphone ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"tel",className:"w-full border rounded p-2",value:r.telephone,onChange:t=>m(a=>({...a,telephone:t.target.value}))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-gray-600 mb-1",children:["Email ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"email",className:"w-full border rounded p-2",value:r.email,onChange:t=>m(a=>({...a,email:t.target.value}))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-gray-600 mb-1",children:["Numéro CNI ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",className:"w-full border rounded p-2",value:r.cniNumber,onChange:t=>m(a=>({...a,cniNumber:t.target.value}))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-gray-600 mb-1",children:["Adresse domicile ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",className:"w-full border rounded p-2",value:r.adresse,onChange:t=>m(a=>({...a,adresse:t.target.value}))})]})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Informations employeur"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-gray-600 mb-1",children:["Profession ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",className:"w-full border rounded p-2",value:r.profession,onChange:t=>m(a=>({...a,profession:t.target.value}))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-gray-600 mb-1",children:["Employeur ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",className:"w-full border rounded p-2",value:r.employeur,onChange:t=>m(a=>({...a,employeur:t.target.value})),placeholder:"Saisissez le nom de votre employeur"})]}),e.jsxs("div",{className:"lg:col-span-2",children:[e.jsxs("label",{className:"block text-sm text-gray-600 mb-1",children:["Adresse employeur ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",className:"w-full border rounded p-2",value:r.adresseEmployeur,onChange:t=>m(a=>({...a,adresseEmployeur:t.target.value}))})]})]})]}),e.jsxs("div",{className:"border-t pt-4 space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Informations bancaires & pièces jointes"}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"block text-sm text-gray-700 mb-1",children:["Institution ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{ref:I,className:"w-full border rounded p-2",value:u,onChange:t=>O(t.target.value),disabled:_,children:[e.jsx("option",{value:"",children:"-- Sélectionnez votre institution --"}),j.map(t=>e.jsx("option",{value:t.id,children:t.name||t.raison_sociale||t.nom},t.id))]}),_&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Chargement des institutions…"}),$&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:$}),j.length===0&&!_&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Aucune institution disponible."})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"rib",className:"block text-sm text-gray-600 mb-1",children:["Numéro de compte bancaire ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{id:"rib",type:"text",minLength:10,maxLength:25,className:"w-full border rounded p-2 uppercase",value:r.rib,onChange:t=>{const a=t.target.value.replace(/[^A-Z0-9]/g,"").toUpperCase();m(n=>({...n,rib:a}))}}),r.rib&&!/^[A-Z0-9]{10,25}$/.test(r.rib)&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:"Le numéro de compte bancaire doit contenir entre 10 et 25 caractères (chiffres et lettres)."})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Bulletins de salaire (PDF) - optionnel"}),e.jsx("input",{type:"file",accept:"application/pdf",multiple:!0,className:"w-full border rounded p-2",onChange:t=>W(t.target.files,"salarySlips")}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"PDF uniquement - max 3 fichiers."}),!!P.salarySlips.length&&e.jsx("ul",{className:"text-xs text-gray-700 list-disc ml-4 mt-1 space-y-1",children:P.salarySlips.map((t,a)=>e.jsx("li",{children:t.name},`${t.name}-${a}`))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Relevés bancaires (PDF) - optionnel"}),e.jsx("input",{type:"file",accept:"application/pdf",multiple:!0,className:"w-full border rounded p-2",onChange:t=>W(t.target.files,"bankStatements")}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"PDF uniquement - max 3 fichiers."}),!!P.bankStatements.length&&e.jsx("ul",{className:"text-xs text-gray-700 list-disc ml-4 mt-1 space-y-1",children:P.bankStatements.map((t,a)=>e.jsx("li",{children:t.name},`${t.name}-${a}`))})]})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Les pièces jointes sont optionnelles. Si vous en ajoutez, elles seront envoyées avec votre demande."})]}),e.jsxs(X,{type:"button",className:"hover:bg-red-500 w-full bg-bleu-logo mt-4",onClick:le,disabled:w||c<=0,children:[w&&e.jsx(Y,{className:"mr-2 h-4 w-4 animate-spin"}),w?"Veuillez patienter...":"Soumettre le dossier (Financement)"]}),e.jsx("p",{className:"text-sm text-gray-600 text-center mt-2",children:"Une fois le dossier envoyé, merci de passer au showroom pour récupérer le formulaire à remplir et signer."})]})}),c<=0&&e.jsx("p",{className:"text-sm text-gray-500",children:"Votre panier est vide. Ajoutez des articles pour configurer votre crédit."})]})})]})})]}),e.jsx(be,{})]})]})}export{De as default};

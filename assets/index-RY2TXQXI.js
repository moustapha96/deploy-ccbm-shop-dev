import{C as Z,j as e,f as E,O as ce,u as de,l as me,m as pe,p as xe,A as ue,t as Y,n as ee,B as p}from"./index-BY5VJ1ij.js";import{b as i,u as he,L as ye}from"./vendor-Bb8_f6lk.js";import{M as fe,P as be}from"./plus-BpJEvOid.js";import{B as je}from"./BannerPub-D8t8lFUk.js";import{c as R}from"./creditCommandeService-CfJ2He0y.js";import{g as ge}from"./entrepriseFunctionService-6HmjWe_5.js";import"./truck-DpTRkMsq.js";function _e({produit:x}){const{updateCreditOrder:j}=i.useContext(Z),C=N=>{N.preventDefault(),j(x,x.quantity+1)},A=N=>{console.log("produit.quantity"),console.log(x.quantity),N.preventDefault(),x.quantity>1&&j(x,x.quantity-1)};return e.jsx("div",{className:"w-[120px] h-[40px] px-[26px] flex items-center border border-qgray-border",children:e.jsxs("div",{className:"flex justify-between items-center w-full",children:[e.jsx("button",{onClick:A,type:"button",className:"text-base text-qgray",children:e.jsx(fe,{})}),e.jsx("span",{className:"text-qblack",children:x.quantity?x.quantity:0}),e.jsx("button",{onClick:C,type:"button",className:"text-base text-qgray",children:e.jsx(be,{})})]})})}function Ne({className:x}){const{creditOrder:j,clearCreditOrder:C,removeFromCreditOrder:A}=i.useContext(Z);console.log(j);const N=(s,_)=>{s.preventDefault(),A(_)};return e.jsxs("div",{className:`w-full ${x||""}`,children:[e.jsx("div",{className:"relative w-full overflow-x-auto border border-[#EDEDED]",children:e.jsx("table",{className:"w-full text-sm text-left text-gray-500 dark:text-gray-400",children:e.jsxs("tbody",{children:[e.jsxs("tr",{className:"text-[13px] font-medium text-black bg-[#F6F6F6] whitespace-nowrap px-2 border-b default-border-bottom uppercase",children:[e.jsx("td",{className:"py-4 pl-10 block whitespace-nowrap min-w-[300px]",children:"product"}),e.jsx("td",{className:"py-4 whitespace-nowrap text-center",children:"Prix"}),e.jsx("td",{className:"py-4 whitespace-nowrap  text-center",children:"Quantité"}),e.jsx("td",{className:"py-4 whitespace-nowrap  text-center",children:"total"}),e.jsx("td",{className:"py-4 whitespace-nowrap text-right w-[114px]"})]}),j&&j.map((s,_)=>e.jsxs("tr",{className:"bg-white border-b hover:bg-gray-50",children:[e.jsx("td",{className:"pl-10  py-4  w-[380px]",children:e.jsxs("div",{className:"flex space-x-6 items-center",children:[e.jsx("div",{className:"w-[80px] h-[80px] overflow-hidden flex justify-center items-center border border-[#EDEDED]",children:e.jsx("img",{src:`${s.image_256?"data:image/png;base64,"+s.image_256:"https://readymadeui.com/images/coffee1.webp"}`,alt:"product",className:"w-full h-full object-contain"})}),e.jsx("div",{className:"flex-1 flex flex-col",children:e.jsx("p",{className:"font-medium text-[15px] text-qblack",children:s.name})})]})}),e.jsx("td",{className:"text-center py-4 px-2",children:e.jsx("div",{className:"flex space-x-1 items-center justify-center",children:e.jsxs("span",{className:"text-[15px] font-normal",children:[" ",E(s.creditorder_price)]})})}),e.jsx("td",{className:" py-4",children:e.jsx("div",{className:"flex justify-center items-center",children:e.jsx(_e,{produit:s})})}),e.jsx("td",{className:"text-right py-4",children:e.jsx("div",{className:"flex space-x-1 items-center justify-center",children:e.jsxs("span",{className:"text-[15px] font-normal",children:[" ",E(s.creditorder_price*s.quantity)]})})}),e.jsx("td",{className:"text-right py-4",children:e.jsx("div",{className:"flex space-x-1 items-center justify-center",children:e.jsx("button",{onClick:u=>N(u,s),className:"duration-200 hover:scale-150",children:e.jsx(ce,{className:"hover:text-red-500"})})})})]},_))]})})}),e.jsx("div",{className:" mt-3 transition-all duration-300 ease-in-out bg-gray-200 text-[15px]  rounded-lg font-medium text-black  text-center py-2",children:"Livraison gratuite sur Dakar"})]})}function Fe({cartt:x=!0}){const j=he(),{creditOrder:C,getCreditOrderTotal:A,clearCreditOrder:N}=i.useContext(Z),{user:s,parent:_}=de();console.log(s),console.log("user");const[u,H]=i.useState("direct"),J=u==="finance",[P,te]=i.useState(50),[z,se]=i.useState(4),ae=[30,40,50,60,70,80,90,100],[q,ne]=i.useState([]),[k,Q]=i.useState(!1),[I,U]=i.useState(""),[$,B]=i.useState(""),[b,V]=i.useState(""),M=i.useMemo(()=>u==="finance"?q.filter(t=>t.type_partner==="banque"):q.filter(t=>t.type_partner!=="banque"),[q,u]),S=i.useMemo(()=>q.filter(t=>t.type_partner==="banque"),[q]),[n,h]=i.useState({nom:s&&s.nom||"",prenom:s&&s.prenom||"",dateNaissance:s&&s.date_naissance||"",lieuNaissance:s&&s.lieu_naissance||"",telephone:s&&(s.telephone||s.partner_phone||s.phone||s.whatsapp_number)||"",email:s&&s.email||"",cniNumber:s&&s.cni_number||"",profession:s&&s.profession||"",rib:s&&s.rib||"",adresse:s&&s.adresse||"",adresseEmployeur:s&&(s.adresse_employeur||s.employer_partner_adresse)||"",employeur:s&&(s.employer_name||s.employer_partner_name)||"",institution_partner_id:s&&s.institution_partner_id||"",institution_id:s&&s.institution_partner_id||"",employer_partner_id:s&&s.employer_partner_id||"",employer_partner_name:s&&s.employer_partner_name||"",employer_partner_email:s&&s.employer_partner_email||"",employer_partner_phone:s&&s.employer_partner_phone||"",employer_partner_adresse:s&&s.employer_partner_adresse||"",salary_monthly:s&&s.salary_monthly||"",kyc_id_number:s&&s.kyc_id_number||"",notes:"",kyc_id_type:"",kyc_id_expiry:"",whatsapp_number:s&&s.whatsapp_number||"",preferred_contact_channel:"",job_title:s&&s.function||""}),[D,re]=i.useState({salarySlips:[],bankStatements:[]}),[F,L]=i.useState(!1),O=i.useRef(null),c=A()||0,W=i.useMemo(()=>{const a=c/1.18;return c-a},[c]),G=i.useMemo(()=>{if(u!=="direct")return[];if(!c)return[];const t=Math.min(100,Math.max(30,P||30)),a=Math.min(5,Math.max(1,z||1));if(t===100||a===1)return[{label:"Paiement unique",amount:c,dueAt:new Date}];const r=c*t/100,y=Math.max(0,c-r),l=a-1,d=y/l,g=Math.round(d*100)/100,v=[];v.push({label:`Acompte (${t}%)`,amount:Math.round(r*100)/100,dueAt:new Date});let o=0;for(let m=1;m<=l;m++){const f=new Date;f.setMonth(f.getMonth()+m);const w=m<l?g:Math.round((y-o)*100)/100;o=Math.round((o+w)*100)/100,v.push({label:`Mensualité ${m}/${l}`,amount:w,dueAt:f})}return v},[u,c,P,z]);i.useEffect(()=>{(async()=>{Q(!0),U("");try{const a=await ge();console.log(a);const r=Array.isArray(a)?a:a&&a.data||[];ne(r)}catch{U("Impossible de charger la liste des entreprises.")}finally{Q(!1)}})()},[]),i.useEffect(()=>{B(""),V("")},[u]),i.useEffect(()=>{s!=null&&s.parent_id&&M&&M.length&&!$&&M.find(a=>String(a.id)===String(s.parent_id))&&B(String(s.parent_id))},[s==null?void 0:s.parent_id,M,$]),i.useEffect(()=>{s!=null&&s.institution_partner_id&&S&&S.length&&!b&&S.find(a=>String(a.id)===String(s.institution_partner_id))&&V(String(s.institution_partner_id))},[s==null?void 0:s.institution_partner_id,S,b]),i.useEffect(()=>{s&&h(t=>({...t,nom:t.nom||s.nom||"",prenom:t.prenom||s.prenom||"",dateNaissance:t.dateNaissance||s.date_naissance||"",lieuNaissance:t.lieuNaissance||s.lieu_naissance||"",telephone:t.telephone||s.telephone||s.partner_phone||s.phone||s.whatsapp_number||"",email:t.email||s.email||"",cniNumber:t.cniNumber||s.cni_number||"",profession:t.profession||s.profession||"",rib:t.rib||s.rib||"",adresse:t.adresse||s.adresse||"",adresseEmployeur:t.adresseEmployeur||s.adresse_employeur||s.employer_partner_adresse||"",employeur:t.employeur||s.employer_name||s.employer_partner_name||"",institution_partner_id:t.institution_partner_id||s.institution_partner_id||"",institution_id:t.institution_id||s.institution_partner_id||"",employer_partner_id:t.employer_partner_id||s.employer_partner_id||"",employer_partner_name:t.employer_partner_name||s.employer_partner_name||"",employer_partner_email:t.employer_partner_email||s.employer_partner_email||"",employer_partner_phone:t.employer_partner_phone||s.employer_partner_phone||"",employer_partner_adresse:t.employer_partner_adresse||s.employer_partner_adresse||"",job_title:t.job_title||s.function||"",whatsapp_number:t.whatsapp_number||s.whatsapp_number||""}))},[s]);const K=(t,a)=>{const r=Array.from(t||[]),y=r.filter(d=>{const g=d.type==="application/pdf",v=d.name.toLowerCase().endsWith(".pdf");return g||v});r.length!==y.length&&p.warning("Seuls les fichiers PDF sont acceptés.",{position:"top-center",autoClose:3e3});const l=y.filter(d=>d.size>10485760?(p.warning(`Le fichier ${d.name} est trop volumineux (max 10MB).`,{position:"top-center",autoClose:3e3}),!1):!0);re(d=>({...d,[a]:l.slice(0,3)}))},X=()=>s?C&&C.length?u==="direct"&&!$?(p.dismiss(),p.error("Veuillez sélectionner votre entreprise.",{position:"top-center",autoClose:5e3}),O.current&&O.current.focus(),!1):!0:(p.dismiss(),p.error("Veuillez ajouter au moins un article dans votre panier",{position:"top-center",autoClose:5e3}),!1):(p.dismiss(),p.warning("Merci de vous connecter",{position:"top-center",autoClose:5e3}),j("/login"),!1),ie=async()=>{if(X()){L(!0);try{const t=Math.min(100,Math.max(30,P)),a=t===100?1:Math.min(5,Math.max(1,z)),r={partner_id:s.id,parent_id:_&&_.id,company_id:parseInt($),type_sale:"creditorder",type_credit:"direct",payment_mode:"online",state:"draft",commitment_date:new Date,acomptePercentage:t,nombreMois:a,order_lines:C.map(l=>({id:l.id,quantity:l.quantity,list_price:l.creditorder_price||l.list_price})),echeancier_prevu:G.map(l=>({label:l.label,amount:l.amount,dueAt:l.dueAt}))};console.log(r);const y=await R(r);p.success("Votre commande à crédit direct a été créée avec succès",{position:"top-center",autoClose:5e3}),setTimeout(()=>{j(`/credit-commandes/${y.id}/détails`,{state:{commande:y}})},600),N()}catch(t){p.error(t&&t.response&&t.response.data&&t.response.data.message||"Commande crédit direct non validée",{position:"top-center",autoClose:5e3})}finally{L(!1)}}},le=async()=>{if(!X())return;if(!n.nom||!n.prenom||!n.dateNaissance||!n.lieuNaissance||!n.telephone||!n.email||!n.cniNumber||!n.profession||!n.rib||!n.adresse||!n.adresseEmployeur||!n.employeur||!b){p.error("Veuillez remplir tous les champs obligatoires.",{position:"top-center"});return}if(!/^[A-Z0-9]{23}$/.test(n.rib)){p.error("Le RIB doit contenir exactement 23 caractères (chiffres et lettres).",{position:"top-center"});return}L(!0);const t=S.find(r=>String(r.id)===String(b)),a={partner_id:s.id,parent_id:_==null?void 0:_.id,company_id:b?parseInt(b):null,type_sale:"creditorder",type_credit:"banque",payment_mode:"online",state:"draft",commitment_date:new Date().toISOString(),order_lines:C.map(r=>({id:r.id,quantity:r.quantity,list_price:r.creditorder_price||r.list_price})),bank_dossier:{nom:n.nom,prenom:n.prenom,dateNaissance:n.dateNaissance,lieuNaissance:n.lieuNaissance,telephone:n.telephone,email:n.email,cniNumber:n.cniNumber,profession:n.profession,rib:n.rib,adresse:n.adresse,adresseDomicile:n.adresse,adresseEmployeur:n.adresseEmployeur,employeur:n.employeur.trim(),institution:(t==null?void 0:t.name)||(t==null?void 0:t.raison_sociale)||(t==null?void 0:t.nom)||"",institution_id:b?parseInt(b):null,institution_partner_id:n.institution_partner_id||(b?parseInt(b):null),employer_partner_id:n.employer_partner_id||null,employer_partner_name:n.employer_partner_name||n.employeur||null,employer_partner_email:n.employer_partner_email||null,employer_partner_phone:n.employer_partner_phone||null,employer_partner_adresse:n.employer_partner_adresse||n.adresseEmployeur||null}};console.log(a),console.log(JSON.stringify(a));try{const{salarySlips:r,bankStatements:y}=D,l=r&&r.length||y&&y.length;console.log(l),console.log(r),console.log(y),console.log(D);let d;if(!l)d=await R(a);else{const g=new FormData;g.append("payload",JSON.stringify(a));const v=(o,m,f)=>{const w=new Date().toISOString().split("T")[0],T=`${n.nom||"client"}_${n.prenom||""}`.trim().replace(/\s+/g,"_").replace(/[^a-zA-Z0-9_]/g,"").toLowerCase(),oe=(s==null?void 0:s.id)||"unknown";return`${o}_${T}_${oe}_${w}_${f+1}.pdf`};(r||[]).forEach((o,m)=>{const f=v("bulletin_salaire",o,m),w=o.type==="application/pdf"?o:new File([o],f,{type:"application/pdf"}),T=new File([w],f,{type:"application/pdf",lastModified:o.lastModified||Date.now()});g.append(`bulletin_salaire_${m+1}`,T,f)}),(y||[]).forEach((o,m)=>{const f=v("releve_bancaire",o,m),w=o.type==="application/pdf"?o:new File([o],f,{type:"application/pdf"}),T=new File([w],f,{type:"application/pdf",lastModified:o.lastModified||Date.now()});g.append(`releve_bancaire_${m+1}`,T,f)});for(const[o,m]of g.entries())console.log(m);d=await R(g)}p.success("Votre demande de financement a été soumise pour validation.",{position:"top-center",autoClose:5e3}),setTimeout(()=>{j(`/credit-commandes/${d.id}/détails`,{state:{commande:d}})},600),N()}catch(r){p.error(r&&r.response&&r.response.data&&r.response.data.message||"Soumission financement non effectuée",{position:"top-center",autoClose:5e3})}finally{L(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(me,{title:"CCBM Shop | Panier crédit",description:"Choisissez le type de crédit (direct ou financement), sélectionnez votre entreprise, configurez votre plan ou remplissez le dossier, puis validez.",keywords:"électroménager, CCBM Shop, crédit, acompte, mensualités, banque, financement"}),e.jsxs(pe,{childrenClasses:x?"pt-0 pb-0":"",children:[x===!1?e.jsx("div",{className:"cart-page-wrapper w-full",children:e.jsx("div",{className:"container-x mx-auto",children:e.jsx(xe,{paths:[{name:"Accueil",path:"/"},{name:"Panier crédit",path:"/credit-cart"}]})})}):e.jsxs("div",{className:"cart-page-wrapper w-full bg-white pb-[60px]",children:[e.jsx("div",{className:"w-full",children:e.jsx(ue,{title:"Panier crédit",breadcrumb:[{name:"Accueil",path:"/"},{name:"Panier crédit",path:"/credit-cart"}]})}),e.jsx("div",{className:"w-full mt-[23px]",children:e.jsxs("div",{className:"container-x mx-auto",children:[e.jsx(Ne,{className:"mb-[30px]"}),e.jsx("div",{className:"w-full sm:flex justify-between",children:e.jsx("div",{className:"flex space-x-2.5 items-center",children:e.jsx(ye,{to:"/boutique",children:e.jsx("div",{className:"w-[220px] h-[50px] bg-[#F6F6F6] flex justify-center items-center",children:e.jsx("span",{className:"text-sm font-semibold",children:"Continuer vos achats"})})})})}),e.jsx("div",{className:`w-full mt-[30px] ${J?"":"flex sm:justify-end"}`,children:e.jsxs("div",{className:`${J?"w-full max-w-none":"sm:w-[420px] w-full"} border border-[#EDEDED] px-[20px] sm:px-[30px] py-[20px] sm:py-[26px] rounded-md`,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm text-gray-700 mb-2",children:"Type de crédit"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsxs("label",{className:"inline-flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"type_credit",value:"direct",checked:u==="direct",onChange:()=>H("direct")}),e.jsx("span",{children:"Crédit direct"})]}),e.jsxs("label",{className:"inline-flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"type_credit",value:"finance",checked:u==="finance",onChange:()=>H("finance")}),e.jsx("span",{children:"Paiement par financement"})]})]})]}),c>0&&u==="direct"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"block text-sm text-gray-700 mb-1",children:["Votre entreprise ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{ref:O,className:"w-full border rounded p-2",value:$,onChange:t=>B(t.target.value),disabled:k,children:[e.jsx("option",{value:"",children:"-- Sélectionnez votre entreprise --"}),M.map(t=>e.jsx("option",{value:t.id,children:t.name||t.raison_sociale||t.nom},t.id))]}),k&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Chargement des entreprises…"}),I&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:I}),M.length===0&&!k&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Aucune entreprise disponible."})]}),e.jsxs("div",{className:"space-y-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Acompte"}),e.jsx("select",{className:"w-full border rounded p-2",value:P,onChange:t=>te(Number(t.target.value)),children:ae.map(t=>e.jsxs("option",{value:t,children:[t,"%"]},t))}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Minimum 30%. 100% = paiement en une fois."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Nombre de paiements (mois)"}),e.jsx("select",{className:"w-full border rounded p-2",value:z,onChange:t=>se(Number(t.target.value)),disabled:P===100,children:[1,2,3,4,5].map(t=>e.jsx("option",{value:t,children:t},t))}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Maximum 5 mensualités."})]})]}),e.jsx("div",{className:"border-t pt-4 space-y-2",children:G.map((t,a)=>e.jsxs("dl",{className:"flex flex-wrap items-center justify-between gap-2",children:[e.jsxs("dt",{className:"text-sm text-gray-500",children:[t.label,t.dueAt&&e.jsxs("span",{className:"ml-2 text-xs text-gray-400",children:["(échéance: ",new Date(t.dueAt).toLocaleDateString(),")"]})]}),e.jsx("dd",{className:"text-sm sm:text-base font-medium text-gray-900",children:E(t.amount)})]},`${t.label}-${a}`))}),e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-[15px] text-gray-600",children:"Sous-total (hors TVA)"}),e.jsx("span",{className:"text-[15px] font-medium",children:E(c-W)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-[15px] text-gray-600",children:"TVA (18%)"}),e.jsx("span",{className:"text-[15px] font-medium",children:E(W)})]}),e.jsxs("div",{className:"flex justify-between border-t pt-2",children:[e.jsx("span",{className:"text-[16px] font-semibold text-gray-800",children:"Total commande (TTC)"}),e.jsx("span",{className:"text-[16px] font-semibold",children:E(c)})]})]}),e.jsx("br",{}),e.jsxs(Y,{type:"button",className:"hover:bg-red-500 w-full bg-bleu-logo",onClick:ie,disabled:F||c<=0,children:[F&&e.jsx(ee,{className:"mr-2 h-4 w-4 animate-spin"}),F?"Veuillez patienter...":"Valider le panier (crédit direct)"]})]}),c>0&&u==="finance"&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"mt-6 border-t pt-4 space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Informations personnelles"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Champs requis pour le dossier de financement"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-gray-600 mb-1",children:["Nom ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",className:"w-full border rounded p-2",value:n.nom,onChange:t=>h(a=>({...a,nom:t.target.value}))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-gray-600 mb-1",children:["Prénom ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",className:"w-full border rounded p-2",value:n.prenom,onChange:t=>h(a=>({...a,prenom:t.target.value}))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-gray-600 mb-1",children:["Date de naissance ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"date",className:"w-full border rounded p-2",value:n.dateNaissance,onChange:t=>h(a=>({...a,dateNaissance:t.target.value}))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-gray-600 mb-1",children:["Lieu de naissance ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",className:"w-full border rounded p-2",value:n.lieuNaissance,onChange:t=>h(a=>({...a,lieuNaissance:t.target.value}))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-gray-600 mb-1",children:["Téléphone ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"tel",className:"w-full border rounded p-2",value:n.telephone,onChange:t=>h(a=>({...a,telephone:t.target.value}))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-gray-600 mb-1",children:["Email ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"email",className:"w-full border rounded p-2",value:n.email,onChange:t=>h(a=>({...a,email:t.target.value}))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-gray-600 mb-1",children:["Numéro CNI ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",className:"w-full border rounded p-2",value:n.cniNumber,onChange:t=>h(a=>({...a,cniNumber:t.target.value}))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-gray-600 mb-1",children:["Adresse domicile ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",className:"w-full border rounded p-2",value:n.adresse,onChange:t=>h(a=>({...a,adresse:t.target.value}))})]})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Informations employeur"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-gray-600 mb-1",children:["Profession ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",className:"w-full border rounded p-2",value:n.profession,onChange:t=>h(a=>({...a,profession:t.target.value}))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm text-gray-600 mb-1",children:["Employeur ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",className:"w-full border rounded p-2",value:n.employeur,onChange:t=>h(a=>({...a,employeur:t.target.value})),placeholder:"Saisissez le nom de votre employeur"})]}),e.jsxs("div",{className:"lg:col-span-2",children:[e.jsxs("label",{className:"block text-sm text-gray-600 mb-1",children:["Adresse employeur ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",className:"w-full border rounded p-2",value:n.adresseEmployeur,onChange:t=>h(a=>({...a,adresseEmployeur:t.target.value}))})]})]})]}),e.jsxs("div",{className:"border-t pt-4 space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Informations bancaires & pièces jointes"}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"block text-sm text-gray-700 mb-1",children:["Institution ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{ref:O,className:"w-full border rounded p-2",value:b,onChange:t=>V(t.target.value),disabled:k,children:[e.jsx("option",{value:"",children:"-- Sélectionnez votre institution --"}),S.map(t=>e.jsx("option",{value:t.id,children:t.name||t.raison_sociale||t.nom},t.id))]}),k&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Chargement des institutions…"}),I&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:I}),S.length===0&&!k&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Aucune institution disponible."})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"rib",className:"block text-sm text-gray-600 mb-1",children:["Numéro de compte bancaire ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{id:"rib",type:"text",minLength:10,maxLength:25,className:"w-full border rounded p-2 uppercase",value:n.rib,onChange:t=>{const a=t.target.value.replace(/[^A-Z0-9]/g,"").toUpperCase();h(r=>({...r,rib:a}))}}),n.rib&&!/^[A-Z0-9]{10,25}$/.test(n.rib)&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:"Le numéro de compte bancaire doit contenir entre 10 et 25 caractères (chiffres et lettres)."})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Bulletins de salaire (PDF) - optionnel"}),e.jsx("input",{type:"file",accept:"application/pdf",multiple:!0,className:"w-full border rounded p-2",onChange:t=>K(t.target.files,"salarySlips")}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"PDF uniquement - max 3 fichiers."}),!!D.salarySlips.length&&e.jsx("ul",{className:"text-xs text-gray-700 list-disc ml-4 mt-1 space-y-1",children:D.salarySlips.map((t,a)=>e.jsx("li",{children:t.name},`${t.name}-${a}`))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Relevés bancaires (PDF) - optionnel"}),e.jsx("input",{type:"file",accept:"application/pdf",multiple:!0,className:"w-full border rounded p-2",onChange:t=>K(t.target.files,"bankStatements")}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"PDF uniquement - max 3 fichiers."}),!!D.bankStatements.length&&e.jsx("ul",{className:"text-xs text-gray-700 list-disc ml-4 mt-1 space-y-1",children:D.bankStatements.map((t,a)=>e.jsx("li",{children:t.name},`${t.name}-${a}`))})]})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Les pièces jointes sont optionnelles. Si vous en ajoutez, elles seront envoyées avec votre demande."})]}),e.jsxs(Y,{type:"button",className:"hover:bg-red-500 w-full bg-bleu-logo mt-4",onClick:le,disabled:F||c<=0,children:[F&&e.jsx(ee,{className:"mr-2 h-4 w-4 animate-spin"}),F?"Veuillez patienter...":"Soumettre le dossier (Financement)"]}),e.jsx("p",{className:"text-sm text-gray-600 text-center mt-2",children:"Une fois le dossier envoyé, merci de passer au showroom pour récupérer le formulaire à remplir et signer."})]})}),c<=0&&e.jsx("p",{className:"text-sm text-gray-500",children:"Votre panier est vide. Ajoutez des articles pour configurer votre crédit."})]})})]})})]}),e.jsx(je,{})]})]})}export{Fe as default};

import{P as y,u as v,j as e,R as N,o as w,l as C,m as T,p as P,L as q,q as F}from"./index-BY5VJ1ij.js";import{b as o,c as S,u as k}from"./vendor-Bb8_f6lk.js";import{P as A}from"./Pagination-Ch1fRHSb.js";function E({className:x,filterToggle:i,updateUrlParams:p,type:u=3}){const{filters:s,updateFilters:n}=o.useContext(y),{user:l}=v(),c=t=>{n({...s,min:t[0],max:t[1],page:1}),p({...s,min:t[0],max:t[1],page:1})},d=t=>{const r=t.target.value;n({...s,productType:r,page:1}),p({...s,productType:r,page:1})},h=t=>{const r=t.target.value;n({...s,tag:r,page:1}),p({...s,tag:r,page:1})},[f,b]=o.useState([]);return o.useEffect(()=>{(async()=>{try{const r=await w.getTags();b(r),console.log(r)}catch(r){console.error("Erreur lors de la récupération des catégories",r)}})()},[]),e.jsxs("div",{className:`filter-widget w-full fixed lg:relative left-0 top-0 h-screen z-10 lg:h-auto overflow-y-scroll lg:overflow-y-auto bg-white px-[30px] pt-[40px] ${x||""} ${i?"block":"hidden lg:block"}`,children:[e.jsxs("div",{className:"filter-subject-item pb-10 border-b border-qgray-border",children:[e.jsx("div",{className:"subject-title mb-[20px]",children:e.jsx("h1",{className:"text-black text-base font-500",children:"Type de produits"})}),e.jsxs("div",{className:"flex flex-col gap-3 text-sm text-qgray",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",value:"All",name:"productType",checked:s.productType==="All",onChange:d}),"Tous les produits"]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",value:"promo",name:"productType",checked:s.productType==="promo",onChange:d}),"Produits en promo"]}),l&&e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",value:"credit",name:"productType",checked:s.productType==="credit",onChange:d}),"Produits à crédit"]})]})]}),e.jsxs("div",{className:"filter-subject-item pb-10 border-b border-qgray-border mt-10",children:[e.jsx("div",{className:"subject-title mb-[20px]",children:e.jsx("h1",{className:"text-black text-base font-500",children:"Filtrer par tags"})}),e.jsx("div",{className:"text-sm text-qgray",children:e.jsxs("select",{className:"w-full border border-qgray-border px-3 py-2 rounded",value:s.tag||"",onChange:h,children:[e.jsx("option",{value:"",children:"Tous les tags"}),f.map(t=>e.jsx("option",{value:t.slug||t.name,children:t.name},t.id))]})})]}),e.jsxs("div",{className:"filter-subject-item pb-10 border-b border-qgray-border mt-10",children:[e.jsx("div",{className:"subject-title mb-[30px]",children:e.jsx("h1",{className:"text-black text-base font-500",children:"Échelle des prix"})}),e.jsx("div",{className:"price-range mb-5",children:e.jsx(N,{value:[s.min,s.max],onInput:c,min:4e3,max:5e6})}),e.jsxs("p",{className:"text-xs text-qblack font-400",children:["Prix (FCFA): ",s.min," - ",s.max]})]})]})}function M(){const{currentProducts:x,totalProducts:i,isLoadingProduct:p,fetchProducts:u,updateFilters:s,resetFilters:n,filters:l}=o.useContext(y),c=S(),d=k();o.useEffect(()=>{n();const a=new URLSearchParams(c.search),m={page:Number.parseInt(a.get("page"))||1,category:a.get("category")||"All",search:a.get("search")||"",min:Number.parseInt(a.get("min"))||1e3,max:Number.parseInt(a.get("max"))||5e6,limit:9,productType:a.get("productType")||"All",tag:a.get("tag")||"All"};s(m),window.scrollTo({top:0,left:100,behavior:"smooth"})},[c.pathname,c.search,n,s]),o.useEffect(()=>{u()},[u]);const h=(l.page-1)*l.limit+1,f=Math.min(l.page*l.limit,i),b=a=>{r({...l,page:a}),window.scrollTo({top:0,left:100,behavior:"smooth"})},t=a=>{r({category:a||"All",page:1}),window.scrollTo({top:0,left:100,behavior:"smooth"})},r=o.useCallback(a=>{const m=new URLSearchParams(c.search);Object.entries(a).forEach(([j,g])=>{g!=null&&g!==""?m.set(j,g.toString()):m.delete(j)}),d({search:m.toString()},{replace:!0})},[c.search,d]);return e.jsxs(e.Fragment,{children:[e.jsx(C,{title:"CCBM Shop | Boutique",description:"Découvrez les meilleures offres sur CCBM Shop, votre destination privilégiée pour l'électroménager de qualité.",keywords:"électroménager, boutique en ligne d'électroménager, CCBM Shop, ccbme, appareils électroménagers à prix réduits"}),e.jsx(T,{children:e.jsx("div",{className:"products-page-wrapper w-full",children:e.jsxs("div",{className:"container-x mx-auto",children:[e.jsx(P,{}),e.jsxs("div",{className:"w-full lg:flex lg:space-x-[30px]",children:[e.jsx("div",{className:"lg:w-[270px]",children:e.jsx(E,{handleCategoryChange:t,updateUrlParams:r})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"products-sorting w-full bg-white flex flex-col md:flex-row justify-between p-[30px] mb-[40px]",children:e.jsxs("p",{className:"font-400 text-[13px]",children:[e.jsx("span",{className:"text-qgray",children:"Affichage"})," ",i>0?`${h}–${f} sur ${i} résultats`:"0 résultat"]})}),p?e.jsxs("div",{className:"flex justify-center items-center",children:[e.jsx(q,{className:"animate-spin"})," Chargement"]}):x.length===0?e.jsx("div",{className:"flex justify-center items-center",children:"Pas de produits disponible pour le moment"}):e.jsx("div",{className:"grid xl:grid-cols-3 grid-cols-2 gap-[30px]",children:x.map(a=>e.jsx(F,{datas:a},a.id))}),e.jsx(A,{currentPage:l.page,totalPages:Math.ceil(i/l.limit),onPageChange:b})]})]})]})})})]})}export{M as default};

import{C as g,j as e,f as p,K as q,u as E,i as S,k as _,q as F,y as B,t as M,l as O,B as x}from"./index.726672a9.js";import{r as a,u as T,L}from"./vendor.af94f9e3.js";import{M as z,P as V}from"./plus.b34a9f53.js";import{B as $}from"./BannerPub.cb79f549.js";import{c as A,a as I}from"./creditCommandeService.4e91a32a.js";import"./truck.9f4567e5.js";function H({produit:r}){const{updateCreditOrder:n}=a.useContext(g),d=c=>{c.preventDefault(),n(r,r.quantity+1)},u=c=>{console.log("produit.quantity"),console.log(r.quantity),c.preventDefault(),r.quantity>1&&n(r,r.quantity-1)};return e.jsx("div",{className:"w-[120px] h-[40px] px-[26px] flex items-center border border-qgray-border",children:e.jsxs("div",{className:"flex justify-between items-center w-full",children:[e.jsx("button",{onClick:u,type:"button",className:"text-base text-qgray",children:e.jsx(z,{})}),e.jsx("span",{className:"text-qblack",children:r.quantity?r.quantity:0}),e.jsx("button",{onClick:d,type:"button",className:"text-base text-qgray",children:e.jsx(V,{})})]})})}function Q({className:r}){const{creditOrder:n,clearCreditOrder:d,removeFromCreditOrder:u}=a.useContext(g);console.log(n);const c=(l,o)=>{l.preventDefault(),u(o)};return e.jsxs("div",{className:`w-full ${r||""}`,children:[e.jsx("div",{className:"relative w-full overflow-x-auto border border-[#EDEDED]",children:e.jsx("table",{className:"w-full text-sm text-left text-gray-500 dark:text-gray-400",children:e.jsxs("tbody",{children:[e.jsxs("tr",{className:"text-[13px] font-medium text-black bg-[#F6F6F6] whitespace-nowrap px-2 border-b default-border-bottom uppercase",children:[e.jsx("td",{className:"py-4 pl-10 block whitespace-nowrap min-w-[300px]",children:"product"}),e.jsx("td",{className:"py-4 whitespace-nowrap text-center",children:"Prix"}),e.jsx("td",{className:"py-4 whitespace-nowrap  text-center",children:"Quantité"}),e.jsx("td",{className:"py-4 whitespace-nowrap  text-center",children:"total"}),e.jsx("td",{className:"py-4 whitespace-nowrap text-right w-[114px]"})]}),n&&n.map((l,o)=>e.jsxs("tr",{className:"bg-white border-b hover:bg-gray-50",children:[e.jsx("td",{className:"pl-10  py-4  w-[380px]",children:e.jsxs("div",{className:"flex space-x-6 items-center",children:[e.jsx("div",{className:"w-[80px] h-[80px] overflow-hidden flex justify-center items-center border border-[#EDEDED]",children:e.jsx("img",{src:`${l.image_256?"data:image/png;base64,"+l.image_256:"https://readymadeui.com/images/coffee1.webp"}`,alt:"product",className:"w-full h-full object-contain"})}),e.jsx("div",{className:"flex-1 flex flex-col",children:e.jsx("p",{className:"font-medium text-[15px] text-qblack",children:l.name})})]})}),e.jsx("td",{className:"text-center py-4 px-2",children:e.jsx("div",{className:"flex space-x-1 items-center justify-center",children:e.jsxs("span",{className:"text-[15px] font-normal",children:[" ",p(l.creditorder_price)]})})}),e.jsx("td",{className:" py-4",children:e.jsx("div",{className:"flex justify-center items-center",children:e.jsx(H,{produit:l})})}),e.jsx("td",{className:"text-right py-4",children:e.jsx("div",{className:"flex space-x-1 items-center justify-center",children:e.jsxs("span",{className:"text-[15px] font-normal",children:[" ",p(l.creditorder_price*l.quantity)]})})}),e.jsx("td",{className:"text-right py-4",children:e.jsx("div",{className:"flex space-x-1 items-center justify-center",children:e.jsx("button",{onClick:h=>c(h,l),className:"duration-200 hover:scale-150",children:e.jsx(q,{className:"hover:text-red-500"})})})})]},o))]})})}),e.jsx("div",{className:" mt-3 transition-all duration-300 ease-in-out bg-gray-200 text-[15px]  rounded-lg font-medium text-black  text-center py-2",children:"Livraison gratuite sur Dakar"})]})}function Y({cartt:r=!0}){const{creditOrder:n,getCreditOrderTotal:d,clearCreditOrder:u}=a.useContext(g),{user:c,parent:l}=E();a.useState("");const[o,h]=a.useState(!1);a.useState(!1),a.useState(null);const[R,y]=a.useState({});a.useState(null),a.useState(!1);const[m,w]=a.useState(50),[i,j]=a.useState(3),v=T();console.log(n),a.useEffect(()=>{(async()=>{const t=await A(c.id);y(t),console.log(t)})()},[]),a.useEffect(()=>{m===100?j(1):i<2&&j(2)},[m,i]);const C=async()=>{if(h(!0),!c)x.dismiss(),x.warning("Merci de vous connecter",{position:"top-center",autoClose:5e3}),v("/login");else if(n.length===0)x.dismiss(),x.error("Veuillez ajouter au moins un article dans votre panier",{position:"top-center",autoClose:5e3});else{const s={partner_id:c.id,parent_id:l.id,type_sale:"creditorder",payment_mode:"online",state:"draft",acomptePercentage:m,nombreMois:i,commitment_date:new Date,order_lines:n.map(t=>({id:t.id,quantity:t.quantity,list_price:t.creditorder_price}))};console.log("modelData creditoder"),console.log(s);try{console.log(s);const t=await I(s);console.log(t),x.success("Votre commande a été créée avec succès",{position:"top-center",autoClose:5e3}),setTimeout(()=>{v(`/credit-commandes/${t.id}/détails`,{state:{commande:t}})},1e3),u()}catch(t){console.log(t.response.data),x.error(t.response.data||"Commande crédit non validé ",{position:"top-center",autoClose:5e3}),console.error("Erreur lors de la récupération des modèles",t)}h(!1)}},k=()=>{const s=d(),t=s*(m/100),D=s-t,f=i-1,P=f>0?D/f:0,N=[{label:"Premier Paiement (Acompte)",value:p(t)}];if(f>0)for(let b=1;b<=f;b++)N.push({label:`Échéance ${b}`,value:p(P)});return N};return e.jsxs(e.Fragment,{children:[e.jsx(S,{title:"CCBM Shop | Panier crédit",description:"Découvrez les meilleures offres sur CCBM Shop, votre destination privilégiée pour l'électroménager de qualité. Explorez nos produits allant des réfrigérateurs aux téléviseurs intelligents, et profitez de promotions exclusives !",keywords:"électroménager, boutique en ligne d'électroménager, CCBM Shop, ccbme, appareils électroménagers à prix réduits, smart TV, réfrigérateurs modernes, climatiseurs efficaces, promotions électroménager"}),e.jsxs(_,{childrenClasses:r?"pt-0 pb-0":"",children:[r===!1?e.jsx("div",{className:"cart-page-wrapper w-full",children:e.jsx("div",{className:"container-x mx-auto",children:e.jsx(F,{paths:[{name:"Accueil",path:"/"},{name:"Panier crédit",path:"/credit-cart"}]})})}):e.jsxs("div",{className:"cart-page-wrapper w-full bg-white pb-[60px]",children:[e.jsx("div",{className:"w-full",children:e.jsx(B,{title:"Panier crédit",breadcrumb:[{name:"Accueil",path:"/"},{name:"Panier crédit",path:"/credit-cart"}]})}),e.jsx("div",{className:"w-full mt-[23px]",children:e.jsxs("div",{className:"container-x mx-auto",children:[e.jsx(Q,{className:"mb-[30px]"}),e.jsx("div",{className:"w-full sm:flex justify-between",children:e.jsx("div",{className:"flex space-x-2.5 items-center",children:e.jsx(L,{to:"/boutique",children:e.jsx("div",{className:"w-[220px] h-[50px] bg-[#F6F6F6] flex justify-center items-center",children:e.jsx("span",{className:"text-sm font-semibold",children:"Continuer vos achats"})})})})}),e.jsx("div",{className:"w-full mt-[30px] flex sm:justify-end",children:e.jsxs("div",{className:"sm:w-[370px] w-full border border-[#EDEDED] px-[30px] py-[26px]",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Pourcentage d'acompte"}),e.jsxs("select",{value:m,onChange:s=>w(Number.parseInt(s.target.value)),className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md",children:[e.jsx("option",{value:30,children:"30%"}),e.jsx("option",{value:40,children:"40%"}),e.jsx("option",{value:50,children:"50%"}),e.jsx("option",{value:60,children:"60%"}),e.jsx("option",{value:70,children:"70%"}),e.jsx("option",{value:80,children:"80%"}),e.jsx("option",{value:90,children:"90%"}),e.jsx("option",{value:100,children:"100%"})]})]}),m!==100&&e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nombre total de paiements (incluant l'acompte)"}),e.jsxs("select",{value:i,onChange:s=>j(Number.parseInt(s.target.value)),className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md",children:[e.jsx("option",{value:1,children:"1 paiement (100% comptant)"}),e.jsx("option",{value:2,children:"2 paiements"}),e.jsx("option",{value:3,children:"3 paiements"}),e.jsx("option",{value:4,children:"4 paiements"}),e.jsx("option",{value:5,children:"5 paiements"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:i===1?"Paiement intégral en une fois":`1 acompte + ${i-1} échéance${i-1>1?"s":""}`})]}),d()!==0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"border-t pt-4 space-y-2",children:[e.jsx("div",{className:"mb-2",children:e.jsx("h4",{className:"text-sm font-semibold text-gray-700",children:"Détail des paiements :"})}),k().map((s,t)=>e.jsxs("dl",{className:"flex flex-wrap items-center justify-between gap-2",children:[e.jsx("dt",{className:"text-sm text-gray-500",children:s.label}),e.jsx("dd",{className:"text-sm sm:text-base font-medium text-gray-900",children:s.value})]},t)),e.jsx("div",{className:"border-t pt-2 mt-3",children:e.jsxs("dl",{className:"flex flex-wrap items-center justify-between gap-2",children:[e.jsx("dt",{className:"text-sm font-semibold text-gray-700",children:"Total :"}),e.jsx("dd",{className:"text-base font-bold text-gray-900",children:p(d())})]})})]}),e.jsx("br",{}),e.jsxs(M,{type:"submit",className:"hover:bg-red-500 w-full bg-bleu-logo",onClick:s=>C(),disabled:o,children:[o&&e.jsx(O,{className:"mr-2 h-4 w-4 animate-spin"}),o?"Veuillez patientez...":"Valider le panier"]})]})]})})]})})]}),e.jsx($,{})]})]})}export{Y as default};
